!function e(i,t,a){function s(o,r){if(!t[o]){if(!i[o]){var l="function"==typeof require&&require;if(!r&&l)return l(o,!0);if(n)return n(o,!0);throw new Error("Cannot find module '"+o+"'")}var c=t[o]={exports:{}};i[o][0].call(c.exports,function(e){var t=i[o][1][e];return s(t?t:e)},c,c.exports,e,i,t,a)}return t[o].exports}for(var n="function"==typeof require&&require,o=0;o<a.length;o++)s(a[o]);return s}({1:[function(e,i,t){var a={preURLLink:document.referrer,decodeUrl:function(e){return"string"==typeof e?decodeURIComponent(e):void 0},getQueryParam:function(e){e=e||document.location.href;var i=e.substring(e.lastIndexOf("?")+1);i.lastIndexOf("#")>=0&&(i=i.substring(0,i.lastIndexOf("#")));for(var t=i.split("&"),s={},n=0;n<t.length;n++){var o=t[n];try{var r=o.substring(0,o.indexOf("=")),l=o.substring(o.indexOf("=")+1);if(0==r.length)continue;/^-?(\d+)(\.\d+)?$/.test(l)?0===l.indexOf("0")?s[r]=""+l:(""+l).length>10?s[r]=""+l:s[r]=Number(l):"true"===l?s[r]=!0:"false"===l?s[r]=!1:s[r]=a.decodeUrl(l)}catch(c){continue}}return s},getUrlRegex:function(e){e=e.replace(/&amp;/g,"&"),e=e.replace(/&amp/g,"&");for(var i="",t=e.split(/\s+/),a=0;a<t.length;a++){var s=function(e){var i=/((https?|ftp|news):\/\/)?([a-zA-Z]([a-z0-9A-Z\-]*[\.])+([a-zA-Z]{2}|(aero|arpa|biz|com|coop|edu|gov|info|int|jobs|mil|museum|name|nato|net|org|pro|travel)(:[0-9]{1,4})?)|(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])(:[0-9]{1,4})?)(\/[a-zA-Z0-9_%=#\-\.~]+)*(\/([a-zA-Z0-9%=#_\-\.]*)(\?[a-zA-Z0-9+_\/\-\.#%=&]*)?)?(#[a-zA-Z][a-zA-Z0-9_]*)?$/;if(e.match(i)){var t=/(https?):\/\/([a-zA-Z]([a-z0-9A-Z\-]*[\.])+([a-zA-Z]{2}|(aero|arpa|biz|com|coop|edu|gov|info|int|jobs|mil|museum|name|nato|net|org|pro|travel)(:[0-9]{1,4})?)|(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])(:[0-9]{1,4})?)(\/[a-zA-Z0-9_%=#\-\.~]+)*(\/([a-zA-Z0-9%=#_\-\.]*)(\?[a-zA-Z0-9+_\/\-\.#%=&]*)?)?(#[a-zA-Z][a-zA-Z0-9_]*)?$/;e=e.match(t)?'<a href="'+e+'" target="_blank">'+e+"</a>":'<a href="http://'+e+'" target="_blank">'+e+"</a>"}return e+" "}(t[a]);i+=s}return i},getNewUrlRegex:function(e){e=e.replace(/&amp;/g,"&"),e=e.replace(/&amp/g,"&");for(var i="",t=e.split(/\s+/),a=0;a<t.length;a++){var s=function(e){var i=/^(((https?):\/\/)|(www))[a-zA-Z0-9_\-]+((\.(com|cn|org))|(:[0-9]{2,4}))?(:[0-9]{2,4})?([:\/\(\)\?\.&\-=a-zA-Z0-9;#%_]+)?$/g;if(e.match(i))e=e.match(i)?'<a href="'+e+'" target="_blank">'+e+"</a>":'<a href="http://'+e+'" target="_blank">'+e+"</a>";else{var t=/((www.)|((https?):\/\/))[a-zA-Z0-9_\-]+((\.(com|cn|org))|(:[0-9]{2,4}))?(:[0-9]{2,4})?([:\/\(\)\?\.&\-=a-zA-Z0-9;#%_]+)?/g,a=e.match(t),s=a;if(a&&a.length>0){var n=e.indexOf(a[0]),o=a[0].indexOf("http");if(s=o>=0?'<a href="'+a[0]+'" target="_blank">'+a[0]+"</a>":'<a href="http://'+a[0]+'" target="_blank">'+a[0]+"</a>",0===n)e=s+e.substring(a[0].length,e.length);else{var r=e.substring(0,n),l=r+a[0],c=e.substring(l.length,e.length);e=r+s+c}}}return e+" "}(t[a]);i+=s}return i},format:function(e,i,t){if(t){var a;if("object"==typeof i)for(var s in i){var n="{"+s+"}";a=e.replace(n,i[s])}else for(var o=0;o<i.length;o++){if(void 0==i[o])return"";var n="{"+o+"}";a=e.replace(n,i[o])}return a}return e},detectEventSupport:function(e){var i,t=document.createElement("div");return e="on"+e,i=e in t,i||(t.setAttribute(e,"xxx"),i="function"==typeof t[e]),t=null,i}};i.exports=a},{}],2:[function(e,i,t){i.exports={errorlogPath:"log.sobot.com/errorlog/"}},{}],3:[function(e,i,t){var a=function(i){var t=e("./comm.js"),a=e("./util/promise.js"),s=e("./initText.js"),n=new a,o=e("./util/listener.js"),r={config_url:"/chat-task/marketingConfig.action",init_url:"/chat-task/init.action",active_url:"/chat/user/productRecommend.action",multi_url:"/chat-web/user/questionRecommend.action",tokenCheck_url:"/chat-visit/page/tokenCheck",task_url:"/chat-task/tasksend.action"},l=window.navigator.userAgent.indexOf("Mobile")>=0,c={};c.cacheInfo={};var d=!1;c.cacheInfo.flags={status:"enabled",isLoaded:!1,pageNow:1,pageSize:20,moreHistroy:!1,isConnected:!1,isEnableManual:!1,isEnableOnInput:!0,isGetCustomConfig:!1,isEnableBigImg:!0,isPeopleModel:!1,isWaitModel:!1,isTimeLine:!1,isUserTalked:!1,isSurveyed:!1,isKeepSessions:!1,isOutOneMinute:!1};var u=!0,p=t.getQueryParam();p.robotid=p.truncate;var f="",m=function(e){var i=!0;if(e.whiteListFlag){if(e.domainWhiteList){i=!1;var t=e.domainWhiteList.split(","),a=(c.cacheInfo.urlParams,document.referrer||"");if(a){for(var s=/http(s)?:\/\/[a-zA-Z0-9|\-]+\.[a-zA-Z0-9\-]+(\.[a-zA-Z0-9]*)*/g,a=a.match(s),n=0;n<t.length;n++)if(t[n].indexOf(a)>=0){i=!0;break}return i}return i}return i}return i},g=function(e){if(e.whiteListFlag){var i=m(e);if(!i)throw alert("未在白名单中设置该域名对聊天组件的访问权限"),"未在白名单中设置该域名对聊天组件的访问权限"}},v={initParams:function(){var e=c.cacheInfo.urlParams={},i=t.getQueryParam();if(i.robotid=i.truncate||i.robotid,i)for(var a in i)e[a]=i[a];try{var s=t.preURLLink;"iframe"==i.from&&(s=document.location.href);var n=t.getQueryParam(s);n&&n.xst?(c.cacheInfo.urlParams.xst=n.xst,window&&window.localStorage&&window.localStorage.setItem(i.sysnum,c.cacheInfo.urlParams.xst)):window&&window.localStorage&&(c.cacheInfo.urlParams.xst=window.localStorage.getItem(i.sysnum)||""),n&&n.clickid?(c.cacheInfo.urlParams.toTiao_clickId=n.clickid,window&&window.localStorage&&window.localStorage.setItem(i.sysnum+"clickid",c.cacheInfo.urlParams.toTiao_clickId)):window&&window.localStorage&&(c.cacheInfo.urlParams.toTiao_clickId=window.localStorage.getItem(i.sysnum+"clickid")||""),n&&n.ucTrackUrl?(c.cacheInfo.urlParams.ucTrackUrl=n.ucTrackUrl,window&&window.localStorage&&window.localStorage.setItem(i.sysnum+"ucTrackUrl",c.cacheInfo.urlParams.ucTrackUrl)):window&&window.localStorage&&(c.cacheInfo.urlParams.ucTrackUrl=window.localStorage.getItem(i.sysnum+"ucTrackUrl")||""),n&&n.sogou_logidUrl?(c.cacheInfo.urlParams.sogou_logidUrl=n.sogou_logidUrl,window&&window.localStorage&&window.localStorage.setItem(i.sysnum+"sogou_logidUrl",c.cacheInfo.urlParams.sogou_logidUrl)):window&&window.localStorage&&(c.cacheInfo.urlParams.sogou_logidUrl=window.localStorage.getItem(i.sysnum+"sogou_logidUrl")||""),n&&n.cburl?(c.cacheInfo.urlParams.zhihu_cb=n.cburl,window&&window.localStorage&&window.localStorage.setItem(window.localStorage.getItem(i.sysnum+"cburl"),c.cacheInfo.urlParams.zhihu_cb)):window&&window.localStorage&&(c.cacheInfo.urlParams.zhihu_cb=window.localStorage.getItem(i.sysnum+"cburl")||""),n&&n.qz_gdt?(c.cacheInfo.urlParams.qz_gdt=n.qz_gdt,f=n.tencent_link,window&&window.localStorage&&window.localStorage.setItem(window.localStorage.getItem(i.sysnum+"qz_gdt"),c.cacheInfo.urlParams.qz_gdt)):window&&window.localStorage&&(c.cacheInfo.urlParams.qz_gdt=window.localStorage.getItem(i.sysnum+"qz_gdt")||"")}catch(o){}},initUA:function(){var e=c.cacheInfo.UAInfo={},i=["mz","xiaomi","android","ipad","iphone"],t=["windows","linux","mac"],a=i.length,s=t.length,n=navigator.userAgent.toLowerCase(),o=$(window).width(),r=$(window).height(),l=0,d="iphone-5",u="";e.uaHeight=r;for(var p=0,f="";p<a&&!u.length;p++){if(f=i[p],l=n.indexOf(f),"iphone"===f&&l>0){switch(o>310&&o<320&&(o=1),o>365&&o<385&&(o=2),o>404&&o<424&&(o=3),o){case 1:d="iphone-5";break;case 2:d="iphone-6";break;case 3:d="iphone-6+"}e.iphoneVersion=d,e.UA=f;break}if(l>0){e.UA=f;break}}if(l<=0)for(var p=0,f="";p<s;p++)if(f=t[p],l=n.indexOf(f),l>0){e.UA="pc";break}},initBrowser:function(){for(var e=c.cacheInfo.browser={},i=["mqqbrowser","qq","micromessenger","MicroMessenger","ucbrowser","miuibrowser","safari","opera mobi","opera mini","firefox"],t=i.length,a=navigator.userAgent.toLowerCase(),s=0,n=0,o="";n<t;n++)if(o=i[n],s=a.indexOf(o),s>0)return void(e.browser=o)},initLanguage:function(){var e=c.cacheInfo.language={};u?e.open=!0:e.open=!1},initEventType:function(){var e=c.cacheInfo.eventType={};if("xiaomi"==c.cacheInfo.UAInfo.UA)e.type="mousedown";else if("pc"!=c.cacheInfo.UAInfo.UA){var i=/hp-tablet/gi.test(navigator.appVersion),t="ontouchstart"in window&&!i;e.type=t?"touchstart":"mousedown"}else e.type="click"},initUserInfo:function(){var e=l?4:0,i=t.getQueryParam();c.cacheInfo.userInfo={source:e,tel:i.tel?i.tel:"",uname:i.uname?i.uname:"",partnerId:i.partnerid?i.partnerid+"":"",email:i.email?i.email:"",visitUrl:i.visitUrl?i.visitUrl:t.preURLLink,visitTitle:i.visitTitle?i.visitTitle:"",face:i.face?i.face:"",back:i.back?i.back:"",realname:i.realname?i.realname:"",weibo:i.weibo?i.weibo:"",weixin:i.weixin?i.weixin:"",qq:i.qq?i.qq:"",sex:i.sex?i.sex:0===i.sex?0:"",birthday:i.birthday?i.birthday:"",remark:i.remark?i.remark:"",color:i.color?i.color:"",modulType:i.type?i.type:"",params:i.params?i.params:"",lastCid:i.cid?i.cid:"",customerFields:i.customerFields?i.customerFields:"",customer_fields:i.customer_fields?i.customer_fields:"",multiParams:i.multiparams?i.multiparams:"",sign:i.sign?i.sign:"",isVip:i.is_vip?i.is_vip:"",vipLevel:i.vip_level?i.vip_level:"",userLabel:i.user_label?i.user_label:""}},initSysNum:function(){c.cacheInfo.sysnum=t.getQueryParam().sysnum}},h=function(){var e=new a;return setTimeout(e.resolve,0),e},y=function(e,i){var t=["leaveMessage.html"],a=0,s={};for(var n in e)s[n]=e[n];s.uname=i.apiInit.uname,s.ticketShowFlag=i.apiConfig.ticketShowFlag,s.uname=i.apiInit.uname,s.userId=i.apiInit.userId,s.pid=i.apiInit.pid;for(var n in s){var o=encodeURIComponent(s[n]);o.length>50||(0==a?t.push("?"):t.push("&"),t.push(n+"="+o),a++)}var r=t.join("");return r},T=function(e){if(void 0===e||null===e||e!==e)return"";try{return decodeURIComponent(e)}catch(i){return""}},j=function(){h().then(function(e,i){var i=i||new a;return v.initUA(),v.initParams(),v.initLanguage(),v.initSysNum(),v.initBrowser(),v.initUserInfo(),v.initEventType(),$.ajax({type:"post",url:r.config_url,dataType:"json",timeout:5e3,data:{sysNum:c.cacheInfo.sysnum,source:c.cacheInfo.userInfo.source,lanFlag:c.cacheInfo.urlParams.lanFlag||0,robotFlag:p.robotid||"",channelFlag:c.cacheInfo.urlParams.channelid||"",faqId:c.cacheInfo.urlParams.faqid||""},success:function(e){if(e&&"210006"===e.err_code){var t="Error: "+e.err_msg+"，请检查sysnum是否正确";throw alert(t),t}if(e.isFreeVersion){var a=/^http(s*):\/\/www.sobot.com/,s=document.referrer||"";if(!s||!a.test(s))throw alert("该功能已关闭，如需开通请联系您的客户经理！"),"该版本仅支持来源页为智齿的页面！"}g(e),e.isNewEncrypted&&(c.cacheInfo.checkToken=!0);var n=c.cacheInfo.userInfo.modulType,o=c.cacheInfo.userInfo.color;"number"==typeof n&&n>=1&&n<=4&&(n=Math.floor(n),e.type=n);var r,l=/^(([a-fA-F0-9]{3})|([a-fA-F0-9]{6}))$/;o&&(r=decodeURIComponent(o),l.test(r)&&(e.color="#"+r)),c.cacheInfo.userInfo.color=e.color,c.cacheInfo.apiConfig=e,c.cacheInfo.apiConfig.robotLogo=c.cacheInfo.apiConfig.cardPhotos,d||c.cacheInfo.urlParams.lanFlag||c.cacheInfo.apiConfig.lan&&(c.cacheInfo.urlParams.lanFlag=c.cacheInfo.apiConfig.lan,c.cacheInfo.urlParams.lan="en");var u={},f=[];"string"==typeof p.manualType?f=p.manualType.split(","):"string"==typeof c.cacheInfo.apiConfig.manualType&&(f=c.cacheInfo.apiConfig.manualType.split(",")),u.direct=f[0],u.under=f[1],u.guide=f[2],u.unknow=f[3],c.cacheInfo.urlParams.manualTypeObj=u,"undefined"!=typeof p.artificial?c.cacheInfo.urlParams.chatConnectButton=p.artificial:c.cacheInfo.urlParams.chatConnectButton=c.cacheInfo.apiConfig.chatConnectButton,"undefined"!=typeof p.show_manual?c.cacheInfo.urlParams.chatConnectButton=p.show_manual:c.cacheInfo.urlParams.chatConnectButton=c.cacheInfo.apiConfig.chatConnectButton,"number"!=typeof p.tranFlag?c.cacheInfo.urlParams.tranFlag=0:c.cacheInfo.urlParams.tranFlag=p.tranFlag,"undefined"!=typeof p.artificialCount?c.cacheInfo.urlParams.manualBtnCount=p.artificialCount:c.cacheInfo.urlParams.manualBtnCount=c.cacheInfo.apiConfig.manualBtnCount;var m=window.location.href.split("?")[1],v="",a=/sysnum=(\w){1,100}(&)?/;if(a.test(m)){var h=a.exec(m);m=m.replace(h[0],"")}"undefined"!=typeof p.leaveCustomUrl?p.leaveCustomUrl.split("?")[1]?(v="?"+p.leaveCustomUrl.split("?")[1]+"&"+m,c.cacheInfo.urlParams.leaveCustomUrl=p.leaveCustomUrl.split("?")[0]+v):(v="?"+m,c.cacheInfo.urlParams.leaveCustomUrl=p.leaveCustomUrl+v):c.cacheInfo.apiConfig.leaveCustomUrl&&c.cacheInfo.apiConfig.leaveCustomUrl.split("?")[1]?(v="?"+c.cacheInfo.apiConfig.leaveCustomUrl.split("?")[1]+"&"+m,c.cacheInfo.urlParams.leaveCustomUrl=c.cacheInfo.apiConfig.leaveCustomUrl.split("?")[0]+v):(v="?"+m,c.cacheInfo.urlParams.leaveCustomUrl=c.cacheInfo.apiConfig.leaveCustomUrl+v),"undefined"!=typeof p.wurlOpenStyle?c.cacheInfo.urlParams.wurlOpenStyle=p.wurlOpenStyle:c.cacheInfo.urlParams.wurlOpenStyle=!0,"undefined"!=typeof p.isCustomSysFlag&&p.wurl?c.cacheInfo.urlParams.isCustomSysFlag=p.isCustomSysFlag:c.cacheInfo.urlParams.isCustomSysFlag=c.cacheInfo.apiConfig.isCustomSysFlag,"undefined"!=typeof p.isLeaveCustomSysFlag?c.cacheInfo.urlParams.isLeaveCustomSysFlag=p.isLeaveCustomSysFlag:c.cacheInfo.urlParams.isLeaveCustomSysFlag=c.cacheInfo.apiConfig.isLeaveCustomSysFlag,"undefined"!=typeof p.msgflag?c.cacheInfo.urlParams.msgflag=p.msgflag:c.cacheInfo.urlParams.msgflag=c.cacheInfo.apiConfig.msgflag,"undefined"!=typeof p.isMessageFlag?c.cacheInfo.urlParams.isMessageFlag=p.isMessageFlag:c.cacheInfo.urlParams.isMessageFlag=c.cacheInfo.apiConfig.isMessageFlag,"undefined"!=typeof p.satDegree_A?c.cacheInfo.urlParams.satDegree_A=p.satDegree_A:c.cacheInfo.urlParams.satDegree_A=!0,"undefined"!=typeof p.isFeedBackFlag?c.cacheInfo.urlParams.isFeedBackFlag=p.isFeedBackFlag:c.cacheInfo.urlParams.isFeedBackFlag=c.cacheInfo.apiConfig.isFeedBackFlag,"undefined"!=typeof p.powered?c.cacheInfo.urlParams.designButton=p.powered:c.cacheInfo.urlParams.designButton=c.cacheInfo.apiConfig.designButton,"undefined"!=typeof p.emailShowFlag&&1!=c.cacheInfo.apiConfig.ticketStartWay?c.cacheInfo.urlParams.emailShowFlag=p.emailShowFlag:c.cacheInfo.urlParams.emailShowFlag=c.cacheInfo.apiConfig.emailShowFlag,"undefined"!=typeof p.emailFlag&&1!=c.cacheInfo.apiConfig.ticketStartWay?c.cacheInfo.urlParams.emailFlag=p.emailFlag:c.cacheInfo.urlParams.emailFlag=c.cacheInfo.apiConfig.emailFlag,"undefined"!=typeof p.telShowFlag&&2!=c.cacheInfo.apiConfig.ticketStartWay?c.cacheInfo.urlParams.telShowFlag=p.telShowFlag:c.cacheInfo.urlParams.telShowFlag=c.cacheInfo.apiConfig.telShowFlag,"undefined"!=typeof p.telFlag&&2!=c.cacheInfo.apiConfig.ticketStartWay?c.cacheInfo.urlParams.telFlag=p.telFlag:c.cacheInfo.urlParams.telFlag=c.cacheInfo.apiConfig.telFlag,c.cacheInfo.urlParams.enclosureShowFlag=c.cacheInfo.apiConfig.enclosureShowFlag,"undefined"!=typeof p.enclosureFlag?c.cacheInfo.urlParams.enclosureFlag=p.enclosureFlag:c.cacheInfo.urlParams.enclosureFlag=c.cacheInfo.apiConfig.enclosureFlag,"undefined"!=typeof p.realuateFlag?c.cacheInfo.urlParams.realuateFlag=p.realuateFlag:c.cacheInfo.urlParams.realuateFlag=c.cacheInfo.apiConfig.realuateFlag,"undefined"!=typeof p.robotHelloWord?c.cacheInfo.urlParams.robotHelloWord=p.robotHelloWord:c.cacheInfo.urlParams.robotHelloWord=c.cacheInfo.apiConfig.robotHelloWord,"undefined"!=typeof p.adminHelloWord?c.cacheInfo.urlParams.adminHelloWord=p.adminHelloWord:c.cacheInfo.urlParams.adminHelloWord=c.cacheInfo.apiConfig.adminHelloWord,c.cacheInfo.urlParams.serviceEndPushMsg=c.cacheInfo.apiConfig.serviceEndPushMsg,"undefined"!=typeof p.adminTipWord?c.cacheInfo.urlParams.adminTipWord=p.adminTipWord:c.cacheInfo.urlParams.adminTipWord=c.cacheInfo.apiConfig.adminTipWord,"undefined"!=typeof p.userTipWord?c.cacheInfo.urlParams.userTipWord=p.userTipWord:c.cacheInfo.urlParams.userTipWord=c.cacheInfo.apiConfig.userTipWord,"undefined"!=typeof p.adminNonelineTitle?c.cacheInfo.urlParams.adminNonelineTitle=p.adminNonelineTitle:c.cacheInfo.urlParams.adminNonelineTitle=c.cacheInfo.apiConfig.adminNonelineTitle,"undefined"!=typeof p.leaveMsgSendGroupIdFlag?c.cacheInfo.urlParams.leaveMsgSendGroupIdFlag=p.leaveMsgSendGroupIdFlag:c.cacheInfo.urlParams.leaveMsgSendGroupIdFlag=c.cacheInfo.apiConfig.leaveMsgSendGroupIdFlag,"undefined"!=typeof p.ticketTypeFlag?c.cacheInfo.urlParams.ticketTypeFlag=p.ticketTypeFlag:c.cacheInfo.urlParams.ticketTypeFlag=c.cacheInfo.apiConfig.ticketTypeFlag,"undefined"!=typeof p.ticketTypeId?c.cacheInfo.urlParams.ticketTypeId=p.ticketTypeId:c.cacheInfo.urlParams.ticketTypeId=c.cacheInfo.apiConfig.ticketTypeId,"undefined"!=typeof p.transferAction&&(c.cacheInfo.urlParams.transferAction=p.transferAction),"undefined"!=typeof p.summaryParams?c.cacheInfo.urlParams.summaryParams=p.summaryParams:c.cacheInfo.urlParams.summaryParams=c.cacheInfo.apiConfig.summaryParams;var y={partnerId:"partner_id",customerFields:"customer_fields",artificial:"show_manual",moduleType:"type",aid:"agentid",groupId:"groupid",robotFlag:"robotid",msgflag:"msg_flag",isMessageFlag:"leave_msg_flag",satDegree_A:"feedback_flag",isFeedBackFlag:"feedback_flag",isCustomSysFlag:"to_customsys_flag",wurl:"to_customsys_url",wurlOpenStyle:"to_customsys_open_style",tranFlag:"agent_mode_flag",back:"top_bar_flag",guideFlag:"guide_flag",transferAction:"transfer_action",summaryParams:"summaryparams",tipTitle:"tip_title",submitBtnTitle:"submit_title",firstTimeout:"first_timeout",overTimeout:"over_timeout",inviteCount:"invite_count",title_info:"card_title",url_info:"card_url",abstract_info:"card_note",label_info:"card_desc",thumbnail_info:"card_picture",robotHelloWord:"robot_hello_word",adminHelloWord:"agent_hello_word",adminTipWord:"agent_tip_word",adminNonelineTitle:"agent_offline_title",userTipWord:"user_tip_word",preAbstract:"pre_abstract",preVisitUrl:"pre_visit_url",preVisitTitle:"pre_visit_title",preThumbnail:"pre_thumbnail",preTags:"pre_tags",curAbstract:"cur_abstract",curVisitUrl:"cur_visit_url",curVisitTitle:"cur_visit_title",pcurThumbnail:"cur_thumbnail",curTags:"cur_tags",channelFlag:"channelid",isVip:"is_vip",vipLevel:"vip_level",userLabel:"user_label",isLink:"is_link"};$.each(y,function(e,i){if(c.cacheInfo.apiConfig[e]&&!c.cacheInfo.urlParams[e]&&(c.cacheInfo.urlParams[e]=c.cacheInfo.apiConfig[e]||""),c.cacheInfo.urlParams[i]){var t=c.cacheInfo.urlParams[i];"1"!=t&&"0"!=t&&"2"!=t||(t=Number(t)),c.cacheInfo.urlParams[e]=t}}),c.cacheInfo.apiConfig.lan="cn",i.resolve()},error:function(e){alert("请求失败，请稍后再试")}}),i}).then(function(e,i){return c.cacheInfo.checkToken?$.ajax({type:"post",url:r.tokenCheck_url,dataType:"json",data:{token:c.cacheInfo.urlParams.token||""},success:function(e){if("000000"===e.retCode){var t=e.item;c.cacheInfo.userItem=t}else"210018"===e.retCode?(c.cacheInfo.checkError=!0,alert("抱歉，您没有通过用户验证，不能接入客服中心。")):(c.cacheInfo.checkError=!0,alert("抱歉，您没有通过用户验证，不能接入客服中心。"));i.resolve()},error:function(e){c.cacheInfo.checkError=!0,alert("抱歉，您没有通过用户验证，不能接入客服中心。"),i.resolve()}}):i.resolve(),i}).then(function(e,i){var i=i||new a,t=c.cacheInfo.urlParams;return 1===t.rput?$.ajax({type:"get",url:r.active_url,dataType:"json",timeout:3e3,data:{sysNum:t.sysnum,partnerId:t.partnerId||"",rpuc:t.rpuc||""},success:function(e){e&&"ok"===e.status?(c.cacheInfo.activeData=e,i.resolve(e.params)):i.resolve()}}):i.resolve(),i}).then(function(e,n){if(!c.cacheInfo.checkError){var n=n||new a,d="";"[object Object]"===Object.prototype.toString.call(e)&&(d=JSON.stringify(e));var u={ack:1,sysNum:T(c.cacheInfo.sysnum),source:T(c.cacheInfo.userInfo.source),chooseAdminId:c.cacheInfo.urlParams.aid||"",tranFlag:c.cacheInfo.urlParams.tranFlag,groupId:T(c.cacheInfo.urlParams.groupId)||"",partnerId:T(""+c.cacheInfo.userInfo.partnerId),tel:T(c.cacheInfo.userInfo.tel),email:T(c.cacheInfo.userInfo.email),uname:T(c.cacheInfo.userInfo.uname),visitTitle:T(c.cacheInfo.userInfo.visitTitle),visitUrl:T(c.cacheInfo.userInfo.visitUrl),realname:T(c.cacheInfo.userInfo.realname),weibo:T(c.cacheInfo.userInfo.weibo),weixin:T(c.cacheInfo.userInfo.weixin),qq:T(c.cacheInfo.userInfo.qq),sex:T(c.cacheInfo.userInfo.sex),birthday:T(c.cacheInfo.userInfo.birthday),isReComment:T(1),customerFields:T(c.cacheInfo.userInfo.customer_fields),visitStartTime:T(c.cacheInfo.urlParams.visitStartTime||""),agid:c.cacheInfo.urlParams.uid,multiParams:T(c.cacheInfo.userInfo.multiParams),summaryParams:T(c.cacheInfo.urlParams.summaryParams),channelFlag:c.cacheInfo.urlParams.channelFlag||"",sign:c.cacheInfo.urlParams.sign,xst:c.cacheInfo.urlParams.xst||"",sogou_logidUrl:c.cacheInfo.urlParams.sogou_logidUrl||"",zhihu_cb:c.cacheInfo.urlParams.zhihu_cb||"",qz_gdt:c.cacheInfo.urlParams.qz_gdt||"",tencent_link:f||"",toTiao_clickId:c.cacheInfo.urlParams.toTiao_clickId||"",ucTrackUrl:c.cacheInfo.urlParams.ucTrackUrl||"",isJs:"__"===c.cacheInfo.urlParams.unit?1:0,joinType:c.cacheInfo.urlParams.type||""};return c.cacheInfo.checkToken&&c.cacheInfo.userItem&&(u.sysNum=T(c.cacheInfo.userItem.sysNum),u.partnerId=T(""+c.cacheInfo.userItem.partnerId),u.uname=T(c.cacheInfo.userItem.uname),u.realname=T(c.cacheInfo.userItem.realname),u.email=T(c.cacheInfo.userItem.email),u.tel=T(c.cacheInfo.userItem.tel),u.qq=T(c.cacheInfo.userItem.qq),u.customerFields=T(c.cacheInfo.userItem.customer_fields)),$.ajax({type:"post",url:r.init_url,dataType:"json",data:u,success:function(e){if(e&&3==e.ustatus)return void alert("当前用户被验证为非法用户，不能接入客服中心");var a=e.data?e.data:e;if(c.cacheInfo.apiInit=a,s(c.cacheInfo),0==c.cacheInfo.urlParams.msgflag||1==c.cacheInfo.urlParams.isMessageFlag){var r=y(c.cacheInfo.urlParams,c.cacheInfo),d=c.cacheInfo.language.lan;l?c.cacheInfo.apiConfig.leaveMsg=d.L10024.replace("{0}",r).replace("{1}",r):c.cacheInfo.apiConfig.leaveMsg=d.L10039,c.cacheInfo.apiConfig.leaveMsgUrl=r}else c.cacheInfo.apiConfig.leaveMsg="";if(0==c.cacheInfo.apiInit.isAgree){var u='<div class="privacy-proto-layer js-shadow-layer"><div class="content-wrap"><h1 class="title">'+c.cacheInfo.language.text.T0156+'</h1><div class="item">您在使用我们的客服功能时，我们可能会收集和使用您的相关信息。我们希望通过本政策向您，在使用我们的服务时，我们如何收集、使用、储存和分享这些信息。</div><div class="item">本政策与您所使用的我们的服务息息相关，希望您仔细阅读，在需要时，按照本政策的指引，作出您认为适当的选择。</div><a class="more" href="/clausetext.html" target="_blank">查看完整《用户隐私协议》</a><div class="foot"><a href="javascript:void(0);" class="js-privacy-cancel">'+c.cacheInfo.language.text.T0155+'</a><a href="javascript:void(0);" class="js-privacy-sure">'+c.cacheInfo.language.text.T0154+"</a></div></div></div>";layer=$(u),$("#zcChat").append(layer),layer.delegate(".js-privacy-sure","click",function(e){e.currentTarget;$.ajax({type:"post",url:"/chat/user/updateIsAgree.action",dataType:"json",data:{uid:T(c.cacheInfo.apiInit.uid)},success:function(e){n.resolve(),layer.remove()}})}),layer.delegate(".js-privacy-cancel","click",function(e){e.currentTarget;n.resolve(),layer.remove()}),layer.delegate(".js-privacy-outer","click",function(e){e.stopPropagation(),e.preventDefault()}),n.resolve()}else n.resolve();var p=t.getQueryParam();p.reload===!0&&window.addEventListener("message",function(e){e&&"close_session"===e.data&&$.ajax({type:"post",url:"/chat-web/user/out.action",dataType:"json",data:{uid:c.cacheInfo.apiInit.uid},success:function(e){o.trigger("core.sessionclose",999)}})}),c.cacheInfo.pageType=i}}),n}}).then(function(e,i){var i=i||new a;if(p=c.cacheInfo.urlParams,c.cacheInfo.apiInit.userId&&"null"!==c.cacheInfo.apiInit.userId){var t=JSON.stringify({companyId:c.cacheInfo.apiInit.pid,customerId:c.cacheInfo.apiInit.userId});$.ajax({type:"post",url:"/chat-web/data/invokeOtherByUser.action",dataType:"json",data:{uid:c.cacheInfo.apiInit.uid,param:t,url:"ws/checkUserTicketInfo/4",method:"get"},success:function(e){e.item&&(c.cacheInfo.existFlag=e.item.existFlag),i.resolve()}})}else i.resolve();return i}).then(function(e,i){var i=i||new a;p=c.cacheInfo.urlParams,1===p.mflag?$.ajax({type:"post",url:r.multi_url,dataType:"json",timeout:3e3,data:{uid:c.cacheInfo.apiInit.uid,margs:c.cacheInfo.urlParams.margs||JSON.stringify({})},success:function(e){c.cacheInfo.multiGuideData=e,n.resolve(c.cacheInfo)}}):n.resolve(c.cacheInfo)})},I=function(){j()};return I(),n};i.exports=a},{"./comm.js":1,"./initText.js":4,"./util/listener.js":33,"./util/promise.js":37}],4:[function(e,i,t){function a(e){var i=s(e);n(i),e.language.lan=i.system,e.language.text=i.text}var s=e("./locale.js"),n=function(e){for(var i=[".js-text-return-btn",".js-text-pulldown",".js-text-transfer-btn",".js-text-sendBtn",".js-text-upload-btn",".js-text-comment-btn",".js-text-satisfition-btn",".js-text-conversation-btn",".js-text-submit-btn",".js-text-success-btn",".js-text-contact",".js-text-ok-btn"],t=0;t<i.length;t++){var a=i[t],s=$(a),n=e.html["HTML_MSG0"+t];s.text(n).attr("placeholder",n)}$(".js-text-tel").html(e.html.HTML_MSG18);for(var o=[".js-pulldown-text",".js-text-chatSwitch",".js-text-send",".js-text-satisfaction",".js-text-newMessage",".js-text-leaveMessage"],t=0;t<o.length;t++){var a=o[t],s=$(a),n=e.html["HTML_MSG01"+(t+12)];s.text(n)}};i.exports=a},{"./locale.js":6}],5:[function(e,i,t){!function(e,a){Array.prototype.map||(Array.prototype.map=function(e,i){var t,a,s;if(null==this)throw new TypeError(" this is null or not defined");var n=Object(this),o=n.length>>>0;if("function"!=typeof e)throw new TypeError(e+" is not a function");for(i&&(t=i),a=new Array(o),s=0;s<o;){var r,l;s in n&&(r=n[s],l=e.call(t,r,s,n),a[s]=l),s++}return a});var s=e.detect=function(){var e=function(){},i={browser_parsers:[{regex:"^(Opera)/(\\d+)\\.(\\d+) \\(Nintendo Wii",family_replacement:"Wii",manufacturer:"Nintendo"},{regex:"(SeaMonkey|Camino)/(\\d+)\\.(\\d+)\\.?([ab]?\\d+[a-z]*)",family_replacement:"Camino",other:!0},{regex:"(Pale[Mm]oon)/(\\d+)\\.(\\d+)\\.?(\\d+)?",family_replacement:"Pale Moon (Firefox Variant)",other:!0},{regex:"(Fennec)/(\\d+)\\.(\\d+)\\.?([ab]?\\d+[a-z]*)",family_replacement:"Firefox Mobile"},{regex:"(Fennec)/(\\d+)\\.(\\d+)(pre)",family_replacment:"Firefox Mobile"},{regex:"(Fennec)/(\\d+)\\.(\\d+)",family_replacement:"Firefox Mobile"},{regex:"Mobile.*(Firefox)/(\\d+)\\.(\\d+)",family_replacement:"Firefox Mobile"},{regex:"(Namoroka|Shiretoko|Minefield)/(\\d+)\\.(\\d+)\\.(\\d+(?:pre)?)",family_replacement:"Firefox ($1)"},{regex:"(Firefox)/(\\d+)\\.(\\d+)(a\\d+[a-z]*)",family_replacement:"Firefox Alpha"},{regex:"(Firefox)/(\\d+)\\.(\\d+)(b\\d+[a-z]*)",family_replacement:"Firefox Beta"},{regex:"(Firefox)-(?:\\d+\\.\\d+)?/(\\d+)\\.(\\d+)(a\\d+[a-z]*)",family_replacement:"Firefox Alpha"},{regex:"(Firefox)-(?:\\d+\\.\\d+)?/(\\d+)\\.(\\d+)(b\\d+[a-z]*)",family_replacement:"Firefox Beta"},{regex:"(Namoroka|Shiretoko|Minefield)/(\\d+)\\.(\\d+)([ab]\\d+[a-z]*)?",family_replacement:"Firefox ($1)"},{regex:"(Firefox).*Tablet browser (\\d+)\\.(\\d+)\\.(\\d+)",family_replacement:"MicroB",tablet:!0},{regex:"(MozillaDeveloperPreview)/(\\d+)\\.(\\d+)([ab]\\d+[a-z]*)?"},{regex:"(Flock)/(\\d+)\\.(\\d+)(b\\d+?)",family_replacement:"Flock",other:!0},{regex:"(RockMelt)/(\\d+)\\.(\\d+)\\.(\\d+)",family_replacement:"Rockmelt",other:!0},{regex:"(Navigator)/(\\d+)\\.(\\d+)\\.(\\d+)",family_replacement:"Netscape"},{regex:"(Navigator)/(\\d+)\\.(\\d+)([ab]\\d+)",family_replacement:"Netscape"},{regex:"(Netscape6)/(\\d+)\\.(\\d+)\\.(\\d+)",family_replacement:"Netscape"},{regex:"(MyIBrow)/(\\d+)\\.(\\d+)",family_replacement:"My Internet Browser",other:!0},{regex:"(Opera Tablet).*Version/(\\d+)\\.(\\d+)(?:\\.(\\d+))?",family_replacement:"Opera Tablet",tablet:!0},{regex:"(Opera)/.+Opera Mobi.+Version/(\\d+)\\.(\\d+)",family_replacement:"Opera Mobile"},{regex:"Opera Mobi",family_replacement:"Opera Mobile"},{regex:"(Opera Mini)/(\\d+)\\.(\\d+)",family_replacement:"Opera Mini"},{regex:"(Opera Mini)/att/(\\d+)\\.(\\d+)",family_replacement:"Opera Mini"},{regex:"(Opera)/9.80.*Version/(\\d+)\\.(\\d+)(?:\\.(\\d+))?",family_replacement:"Opera"},{regex:"(OPR)/(\\d+)\\.(\\d+)(?:\\.(\\d+))?",family_replacement:"Opera"},{regex:"(webOSBrowser)/(\\d+)\\.(\\d+)",family_replacement:"webOS"},{regex:"(webOS)/(\\d+)\\.(\\d+)",family_replacement:"webOS"},{regex:"(wOSBrowser).+TouchPad/(\\d+)\\.(\\d+)",family_replacement:"webOS TouchPad"},{regex:"(luakit)",family_replacement:"LuaKit",other:!0},{regex:"(Lightning)/(\\d+)\\.(\\d+)([ab]?\\d+[a-z]*)",family_replacement:"Lightning",other:!0},{regex:"(Firefox)/(\\d+)\\.(\\d+)\\.(\\d+(?:pre)?) \\(Swiftfox\\)",family_replacement:"Swiftfox",other:!0},{regex:"(Firefox)/(\\d+)\\.(\\d+)([ab]\\d+[a-z]*)? \\(Swiftfox\\)",family_replacement:"Swiftfox",other:!0},{regex:"rekonq",family_replacement:"Rekonq",other:!0},{regex:"(conkeror|Conkeror)/(\\d+)\\.(\\d+)\\.?(\\d+)?",family_replacement:"Conkeror",other:!0},{regex:"(konqueror)/(\\d+)\\.(\\d+)\\.(\\d+)",family_replacement:"Konqueror",other:!0},{regex:"(WeTab)-Browser",family_replacement:"WeTab",other:!0},{regex:"(Comodo_Dragon)/(\\d+)\\.(\\d+)\\.(\\d+)",family_replacement:"Comodo Dragon",other:!0},{regex:"(YottaaMonitor)",family_replacement:"Yottaa Monitor",other:!0},{regex:"(Kindle)/(\\d+)\\.(\\d+)",family_replacement:"Kindle"},{regex:"(Symphony) (\\d+).(\\d+)",family_replacement:"Symphony",other:!0},{regex:"Minimo",family_replacement:"Minimo",other:!0},{regex:"(Edge)/(\\d+)\\.(\\d+)",family_replacement:"Edge"},{regex:"(CrMo)/(\\d+)\\.(\\d+)\\.(\\d+)\\.(\\d+)",family_replacement:"Chrome Mobile"},{regex:"(CriOS)/(\\d+)\\.(\\d+)\\.(\\d+)\\.(\\d+)",family_replacement:"Chrome Mobile iOS"},{regex:"(Chrome)/(\\d+)\\.(\\d+)\\.(\\d+)\\.(\\d+) Mobile",family_replacement:"Chrome Mobile"},{regex:"(chromeframe)/(\\d+)\\.(\\d+)\\.(\\d+)",family_replacement:"Chrome Frame"},{regex:"(UC Browser)(\\d+)\\.(\\d+)\\.(\\d+)",family_replacement:"UC Browser",other:!0},{regex:"(SLP Browser)/(\\d+)\\.(\\d+)",family_replacement:"Tizen Browser",other:!0},{regex:"(Epiphany)/(\\d+)\\.(\\d+).(\\d+)",family_replacement:"Epiphany",other:!0},{regex:"(SE 2\\.X) MetaSr (\\d+)\\.(\\d+)",family_replacement:"Sogou Explorer",other:!0},{regex:"(Pingdom.com_bot_version_)(\\d+)\\.(\\d+)",family_replacement:"PingdomBot",other:!0},{regex:"(facebookexternalhit)/(\\d+)\\.(\\d+)",family_replacement:"FacebookBot"},{regex:"(Twitterbot)/(\\d+)\\.(\\d+)",family_replacement:"TwitterBot"},{regex:"(AdobeAIR|Chromium|FireWeb|Jasmine|ANTGalio|Midori|Fresco|Lobo|PaleMoon|Maxthon|Lynx|OmniWeb|Dillo|Camino|Demeter|Fluid|Fennec|Shiira|Sunrise|Chrome|Flock|Netscape|Lunascape|WebPilot|NetFront|Netfront|Konqueror|SeaMonkey|Kazehakase|Vienna|Iceape|Iceweasel|IceWeasel|Iron|K-Meleon|Sleipnir|Galeon|GranParadiso|Opera Mini|iCab|NetNewsWire|ThunderBrowse|Iron|Iris|UP\\.Browser|Bunjaloo|Google Earth|Raven for Mac)/(\\d+)\\.(\\d+)\\.(\\d+)"},{regex:"(Bolt|Jasmine|IceCat|Skyfire|Midori|Maxthon|Lynx|Arora|IBrowse|Dillo|Camino|Shiira|Fennec|Phoenix|Chrome|Flock|Netscape|Lunascape|Epiphany|WebPilot|Opera Mini|Opera|NetFront|Netfront|Konqueror|Googlebot|SeaMonkey|Kazehakase|Vienna|Iceape|Iceweasel|IceWeasel|Iron|K-Meleon|Sleipnir|Galeon|GranParadiso|iCab|NetNewsWire|Iron|Space Bison|Stainless|Orca|Dolfin|BOLT|Minimo|Tizen Browser|Polaris)/(\\d+)\\.(\\d+)"},{regex:"(iRider|Crazy Browser|SkipStone|iCab|Lunascape|Sleipnir|Maemo Browser) (\\d+)\\.(\\d+)\\.(\\d+)"},{regex:"(iCab|Lunascape|Opera|Android|Jasmine|Polaris|BREW) (\\d+)\\.(\\d+)\\.?(\\d+)?"},{regex:"(Android) Donut",v2_replacement:"2",v1_replacement:"1"},{regex:"(Android) Eclair",v2_replacement:"1",v1_replacement:"2"},{regex:"(Android) Froyo",v2_replacement:"2",v1_replacement:"2"},{regex:"(Android) Gingerbread",v2_replacement:"3",v1_replacement:"2"},{regex:"(Android) Honeycomb",v1_replacement:"3"},{regex:"(IEMobile)[ /](\\d+)\\.(\\d+)",family_replacement:"IE Mobile"},{regex:"(MSIE) (\\d+)\\.(\\d+).*XBLWP7",family_replacement:"IE Large Screen"},{regex:"(Firefox)/(\\d+)\\.(\\d+)\\.(\\d+)"},{regex:"(Firefox)/(\\d+)\\.(\\d+)(pre|[ab]\\d+[a-z]*)?"},{regex:"(Obigo)InternetBrowser",other:!0},{regex:"(Obigo)\\-Browser",other:!0},{regex:"(Obigo|OBIGO)[^\\d]*(\\d+)(?:.(\\d+))?",other:!0},{regex:"(MAXTHON|Maxthon) (\\d+)\\.(\\d+)",family_replacement:"Maxthon",other:!0},{regex:"(Maxthon|MyIE2|Uzbl|Shiira)",v1_replacement:"0",other:!0},{regex:"(PLAYSTATION) (\\d+)",family_replacement:"PlayStation",manufacturer:"Sony"},{regex:"(PlayStation Portable)[^\\d]+(\\d+).(\\d+)",manufacturer:"Sony"},{regex:"(BrowseX) \\((\\d+)\\.(\\d+)\\.(\\d+)",other:!0},{regex:"(POLARIS)/(\\d+)\\.(\\d+)",family_replacement:"Polaris",other:!0},{regex:"(Embider)/(\\d+)\\.(\\d+)",family_replacement:"Polaris",other:!0},{regex:"(BonEcho)/(\\d+)\\.(\\d+)\\.(\\d+)",family_replacement:"Bon Echo",other:!0
},{regex:"(iPod).+Version/(\\d+)\\.(\\d+)\\.(\\d+)",family_replacement:"Mobile Safari",manufacturer:"Apple"},{regex:"(iPod).*Version/(\\d+)\\.(\\d+)",family_replacement:"Mobile Safari",manufacturer:"Apple"},{regex:"(iPod)",family_replacement:"Mobile Safari",manufacturer:"Apple"},{regex:"(iPhone).*Version/(\\d+)\\.(\\d+)\\.(\\d+)",family_replacement:"Mobile Safari",manufacturer:"Apple"},{regex:"(iPhone).*Version/(\\d+)\\.(\\d+)",family_replacement:"Mobile Safari",manufacturer:"Apple"},{regex:"(iPhone)",family_replacement:"Mobile Safari",manufacturer:"Apple"},{regex:"(iPad).*Version/(\\d+)\\.(\\d+)\\.(\\d+)",family_replacement:"Mobile Safari",tablet:!0,manufacturer:"Apple"},{regex:"(iPad).*Version/(\\d+)\\.(\\d+)",family_replacement:"Mobile Safari",tablet:!0,manufacturer:"Apple"},{regex:"(iPad)",family_replacement:"Mobile Safari",tablet:!0,manufacturer:"Apple"},{regex:"(AvantGo) (\\d+).(\\d+)",other:!0},{regex:"(Avant)",v1_replacement:"1",other:!0},{regex:"^(Nokia)",family_replacement:"Nokia Services (WAP) Browser",manufacturer:"Nokia"},{regex:"(NokiaBrowser)/(\\d+)\\.(\\d+).(\\d+)\\.(\\d+)",manufacturer:"Nokia"},{regex:"(NokiaBrowser)/(\\d+)\\.(\\d+).(\\d+)",manufacturer:"Nokia"},{regex:"(NokiaBrowser)/(\\d+)\\.(\\d+)",manufacturer:"Nokia"},{regex:"(BrowserNG)/(\\d+)\\.(\\d+).(\\d+)",family_replacement:"NokiaBrowser",manufacturer:"Nokia"},{regex:"(Series60)/5\\.0",v2_replacement:"0",v1_replacement:"7",family_replacement:"NokiaBrowser",manufacturer:"Nokia"},{regex:"(Series60)/(\\d+)\\.(\\d+)",family_replacement:"Nokia OSS Browser",manufacturer:"Nokia"},{regex:"(S40OviBrowser)/(\\d+)\\.(\\d+)\\.(\\d+)\\.(\\d+)",family_replacement:"Nokia Series 40 Ovi Browser",manufacturer:"Nokia"},{regex:"(Nokia)[EN]?(\\d+)",manufacturer:"Nokia"},{regex:"(PlayBook).+RIM Tablet OS (\\d+)\\.(\\d+)\\.(\\d+)",family_replacement:"Blackberry WebKit",tablet:!0,manufacturer:"Nokia"},{regex:"(Black[bB]erry).+Version/(\\d+)\\.(\\d+)\\.(\\d+)",family_replacement:"Blackberry WebKit",manufacturer:"RIM"},{regex:"(Black[bB]erry)\\s?(\\d+)",family_replacement:"Blackberry",manufacturer:"RIM"},{regex:"(OmniWeb)/v(\\d+)\\.(\\d+)",other:!0},{regex:"(Blazer)/(\\d+)\\.(\\d+)",family_replacement:"Palm Blazer",manufacturer:"Palm"},{regex:"(Pre)/(\\d+)\\.(\\d+)",family_replacement:"Palm Pre",manufacturer:"Palm"},{regex:"(Links) \\((\\d+)\\.(\\d+)",other:!0},{regex:"(QtWeb) Internet Browser/(\\d+)\\.(\\d+)",other:!0},{regex:"(Silk)/(\\d+)\\.(\\d+)(?:\\.([0-9\\-]+))?",other:!0,tablet:!0},{regex:"(AppleWebKit)/(\\d+)\\.?(\\d+)?\\+ .* Version/\\d+\\.\\d+.\\d+ Safari/",family_replacement:"WebKit Nightly"},{regex:"(Version)/(\\d+)\\.(\\d+)(?:\\.(\\d+))?.*Safari/",family_replacement:"Safari"},{regex:"(Safari)/\\d+"},{regex:"(OLPC)/Update(\\d+)\\.(\\d+)",other:!0},{regex:"(OLPC)/Update()\\.(\\d+)",v1_replacement:"0",other:!0},{regex:"(SEMC\\-Browser)/(\\d+)\\.(\\d+)",other:!0},{regex:"(Teleca)",family_replacement:"Teleca Browser",other:!0},{regex:"Trident(.*)rv.(\\d+)\\.(\\d+)",family_replacement:"IE"},{regex:"(MSIE) (\\d+)\\.(\\d+)",family_replacement:"IE"}],os_parsers:[{regex:"(Android) (\\d+)\\.(\\d+)(?:[.\\-]([a-z0-9]+))?"},{regex:"(Android)\\-(\\d+)\\.(\\d+)(?:[.\\-]([a-z0-9]+))?"},{regex:"(Android) Donut",os_v2_replacement:"2",os_v1_replacement:"1"},{regex:"(Android) Eclair",os_v2_replacement:"1",os_v1_replacement:"2"},{regex:"(Android) Froyo",os_v2_replacement:"2",os_v1_replacement:"2"},{regex:"(Android) Gingerbread",os_v2_replacement:"3",os_v1_replacement:"2"},{regex:"(Android) Honeycomb",os_v1_replacement:"3"},{regex:"(Silk-Accelerated=[a-z]{4,5})",os_replacement:"Android"},{regex:"(Windows Phone 6\\.5)"},{regex:"(Windows (?:NT 5\\.2|NT 5\\.1))",os_replacement:"Windows XP"},{regex:"(XBLWP7)",os_replacement:"Windows Phone OS"},{regex:"(Windows NT 6\\.1)",os_replacement:"Windows 7"},{regex:"(Windows NT 6\\.0)",os_replacement:"Windows Vista"},{regex:"(Windows 98|Windows XP|Windows ME|Windows 95|Windows CE|Windows 7|Windows NT 4\\.0|Windows Vista|Windows 2000)"},{regex:"(Windows NT 6\\.4|Windows NT 10\\.0)",os_replacement:"Windows 10"},{regex:"(Windows NT 6\\.2)",os_replacement:"Windows 8"},{regex:"(Windows Phone 8)",os_replacement:"Windows Phone 8"},{regex:"(Windows NT 5\\.0)",os_replacement:"Windows 2000"},{regex:"(Windows Phone OS) (\\d+)\\.(\\d+)"},{regex:"(Windows ?Mobile)",os_replacement:"Windows Mobile"},{regex:"(WinNT4.0)",os_replacement:"Windows NT 4.0"},{regex:"(Win98)",os_replacement:"Windows 98"},{regex:"(Tizen)/(\\d+)\\.(\\d+)",other:!0},{regex:"(Mac OS X) (\\d+)[_.](\\d+)(?:[_.](\\d+))?",manufacturer:"Apple"},{regex:"(?:PPC|Intel) (Mac OS X)",manufacturer:"Apple"},{regex:"(CPU OS|iPhone OS) (\\d+)_(\\d+)(?:_(\\d+))?",os_replacement:"iOS",manufacturer:"Apple"},{regex:"(iPhone|iPad|iPod); Opera",os_replacement:"iOS",manufacturer:"Apple"},{regex:"(iPad); Opera",tablet:!0,manufacturer:"Apple"},{regex:"(iPhone|iPad|iPod).*Mac OS X.*Version/(\\d+)\\.(\\d+)",os_replacement:"iOS",manufacturer:"Apple"},{regex:"(CrOS) [a-z0-9_]+ (\\d+)\\.(\\d+)(?:\\.(\\d+))?",os_replacement:"Chrome OS"},{regex:"(Debian)-(\\d+)\\.(\\d+)\\.(\\d+)(?:\\.(\\d+))?",other:!0},{regex:"(Linux Mint)(?:/(\\d+))?",other:!0},{regex:"(Mandriva)(?: Linux)?/(\\d+)\\.(\\d+)\\.(\\d+)(?:\\.(\\d+))?",other:!0},{regex:"(Symbian[Oo][Ss])/(\\d+)\\.(\\d+)",os_replacement:"Symbian OS"},{regex:"(Symbian/3).+NokiaBrowser/7\\.3",os_replacement:"Symbian^3 Anna"},{regex:"(Symbian/3).+NokiaBrowser/7\\.4",os_replacement:"Symbian^3 Belle"},{regex:"(Symbian/3)",os_replacement:"Symbian^3"},{regex:"(Series 60|SymbOS|S60)",os_replacement:"Symbian OS"},{regex:"(MeeGo)",other:!0},{regex:"Symbian [Oo][Ss]",os_replacement:"Symbian OS"},{regex:"(Black[Bb]erry)[0-9a-z]+/(\\d+)\\.(\\d+)\\.(\\d+)(?:\\.(\\d+))?",os_replacement:"BlackBerry OS",manufacturer:"RIM"},{regex:"(Black[Bb]erry).+Version/(\\d+)\\.(\\d+)\\.(\\d+)(?:\\.(\\d+))?",os_replacement:"BlackBerry OS",manufacturer:"RIM"},{regex:"(RIM Tablet OS) (\\d+)\\.(\\d+)\\.(\\d+)",os_replacement:"BlackBerry Tablet OS",tablet:!0,manufacturer:"RIM"},{regex:"(Play[Bb]ook)",os_replacement:"BlackBerry Tablet OS",tablet:!0,manufacturer:"RIM"},{regex:"(Black[Bb]erry)",os_replacement:"Blackberry OS",manufacturer:"RIM"},{regex:"(webOS|hpwOS)/(\\d+)\\.(\\d+)(?:\\.(\\d+))?",os_replacement:"webOS"},{regex:"(SUSE|Fedora|Red Hat|PCLinuxOS)/(\\d+)\\.(\\d+)\\.(\\d+)\\.(\\d+)",other:!0},{regex:"(SUSE|Fedora|Red Hat|Puppy|PCLinuxOS|CentOS)/(\\d+)\\.(\\d+)\\.(\\d+)",other:!0},{regex:"(Ubuntu|Kindle|Bada|Lubuntu|BackTrack|Red Hat|Slackware)/(\\d+)\\.(\\d+)"},{regex:"(Windows|OpenBSD|FreeBSD|NetBSD|Ubuntu|Kubuntu|Android|Arch Linux|CentOS|WeTab|Slackware)"},{regex:"(Linux|BSD)",other:!0}],mobile_os_families:["Windows Phone 6.5","Windows CE","Symbian OS"],device_parsers:[{regex:"HTC ([A-Z][a-z0-9]+) Build",device_replacement:"HTC $1",manufacturer:"HTC"},{regex:"HTC ([A-Z][a-z0-9 ]+) \\d+\\.\\d+\\.\\d+\\.\\d+",device_replacement:"HTC $1",manufacturer:"HTC"},{regex:"HTC_Touch_([A-Za-z0-9]+)",device_replacement:"HTC Touch ($1)",manufacturer:"HTC"},{regex:"USCCHTC(\\d+)",device_replacement:"HTC $1 (US Cellular)",manufacturer:"HTC"},{regex:"Sprint APA(9292)",device_replacement:"HTC $1 (Sprint)",manufacturer:"HTC"},{regex:"HTC ([A-Za-z0-9]+ [A-Z])",device_replacement:"HTC $1",manufacturer:"HTC"},{regex:"HTC-([A-Za-z0-9]+)",device_replacement:"HTC $1",manufacturer:"HTC"},{regex:"HTC_([A-Za-z0-9]+)",device_replacement:"HTC $1",manufacturer:"HTC"},{regex:"HTC ([A-Za-z0-9]+)",device_replacement:"HTC $1",manufacturer:"HTC"},{regex:"(ADR[A-Za-z0-9]+)",device_replacement:"HTC $1",manufacturer:"HTC"},{regex:"(HTC)",manufacturer:"HTC"},{regex:"SonyEricsson([A-Za-z0-9]+)/",device_replacement:"Ericsson $1",other:!0,manufacturer:"Sony"},{regex:"Android[\\- ][\\d]+\\.[\\d]+\\; [A-Za-z]{2}\\-[A-Za-z]{2}\\; WOWMobile (.+) Build"},{regex:"Android[\\- ][\\d]+\\.[\\d]+\\.[\\d]+; [A-Za-z]{2}\\-[A-Za-z]{2}\\; (.+) Build"},{regex:"Android[\\- ][\\d]+\\.[\\d]+\\-update1\\; [A-Za-z]{2}\\-[A-Za-z]{2}\\; (.+) Build"},{regex:"Android[\\- ][\\d]+\\.[\\d]+\\; [A-Za-z]{2}\\-[A-Za-z]{2}\\; (.+) Build"},{regex:"Android[\\- ][\\d]+\\.[\\d]+\\.[\\d]+; (.+) Build"},{regex:"NokiaN([0-9]+)",device_replacement:"Nokia N$1",manufacturer:"Nokia"},{regex:"Nokia([A-Za-z0-9\\v-]+)",device_replacement:"Nokia $1",manufacturer:"Nokia"},{regex:"NOKIA ([A-Za-z0-9\\-]+)",device_replacement:"Nokia $1",manufacturer:"Nokia"},{regex:"Nokia ([A-Za-z0-9\\-]+)",device_replacement:"Nokia $1",manufacturer:"Nokia"},{regex:"Lumia ([A-Za-z0-9\\-]+)",device_replacement:"Lumia $1",manufacturer:"Nokia"},{regex:"Symbian",device_replacement:"Nokia",manufacturer:"Nokia"},{regex:"(PlayBook).+RIM Tablet OS",device_replacement:"Blackberry Playbook",tablet:!0,manufacturer:"RIM"},{regex:"(Black[Bb]erry [0-9]+);",manufacturer:"RIM"},{regex:"Black[Bb]erry([0-9]+)",device_replacement:"BlackBerry $1",manufacturer:"RIM"},{regex:"(Pre)/(\\d+)\\.(\\d+)",device_replacement:"Palm Pre",manufacturer:"Palm"},{regex:"(Pixi)/(\\d+)\\.(\\d+)",device_replacement:"Palm Pixi",manufacturer:"Palm"},{regex:"(Touchpad)/(\\d+)\\.(\\d+)",device_replacement:"HP Touchpad",manufacturer:"HP"},{regex:"HPiPAQ([A-Za-z0-9]+)/(\\d+).(\\d+)",device_replacement:"HP iPAQ $1",manufacturer:"HP"},{regex:"Palm([A-Za-z0-9]+)",device_replacement:"Palm $1",manufacturer:"Palm"},{regex:"Treo([A-Za-z0-9]+)",device_replacement:"Palm Treo $1",manufacturer:"Palm"},{regex:"webOS.*(P160UNA)/(\\d+).(\\d+)",device_replacement:"HP Veer",manufacturer:"HP"},{regex:"(Kindle Fire)",manufacturer:"Amazon"},{regex:"(Kindle)",manufacturer:"Amazon"},{regex:"(Silk)/(\\d+)\\.(\\d+)(?:\\.([0-9\\-]+))?",device_replacement:"Kindle Fire",tablet:!0,manufacturer:"Amazon"},{regex:"(iPad) Simulator;",manufacturer:"Apple"},{regex:"(iPad);",manufacturer:"Apple"},{regex:"(iPod);",manufacturer:"Apple"},{regex:"(iPhone) Simulator;",manufacturer:"Apple"},{regex:"(iPhone);",manufacturer:"Apple"},{regex:"Nexus\\ ([A-Za-z0-9\\-]+)",device_replacement:"Nexus $1"},{regex:"acer_([A-Za-z0-9]+)_",device_replacement:"Acer $1",manufacturer:"Acer"},{regex:"acer_([A-Za-z0-9]+)_",device_replacement:"Acer $1",manufacturer:"Acer"},{regex:"Amoi\\-([A-Za-z0-9]+)",device_replacement:"Amoi $1",other:!0,manufacturer:"Amoi"},{regex:"AMOI\\-([A-Za-z0-9]+)",device_replacement:"Amoi $1",other:!0,manufacturer:"Amoi"},{regex:"Asus\\-([A-Za-z0-9]+)",device_replacement:"Asus $1",manufacturer:"Asus"},{regex:"ASUS\\-([A-Za-z0-9]+)",device_replacement:"Asus $1",manufacturer:"Asus"},{regex:"BIRD\\-([A-Za-z0-9]+)",device_replacement:"Bird $1",other:!0},{regex:"BIRD\\.([A-Za-z0-9]+)",device_replacement:"Bird $1",other:!0},{regex:"BIRD ([A-Za-z0-9]+)",device_replacement:"Bird $1",other:!0},{regex:"Dell ([A-Za-z0-9]+)",device_replacement:"Dell $1",manufacturer:"Dell"},{regex:"DoCoMo/2\\.0 ([A-Za-z0-9]+)",device_replacement:"DoCoMo $1",other:!0},{regex:"([A-Za-z0-9]+)\\_W\\;FOMA",device_replacement:"DoCoMo $1",other:!0},{regex:"([A-Za-z0-9]+)\\;FOMA",device_replacement:"DoCoMo $1",other:!0},{regex:"vodafone([A-Za-z0-9]+)",device_replacement:"Huawei Vodafone $1",other:!0},{regex:"i\\-mate ([A-Za-z0-9]+)",device_replacement:"i-mate $1",other:!0},{regex:"Kyocera\\-([A-Za-z0-9]+)",device_replacement:"Kyocera $1",other:!0},{regex:"KWC\\-([A-Za-z0-9]+)",device_replacement:"Kyocera $1",other:!0},{regex:"Lenovo\\-([A-Za-z0-9]+)",device_replacement:"Lenovo $1",manufacturer:"Lenovo"},{regex:"Lenovo\\_([A-Za-z0-9]+)",device_replacement:"Lenovo $1",manufacturer:"Levovo"},{regex:"LG/([A-Za-z0-9]+)",device_replacement:"LG $1",manufacturer:"LG"},{regex:"LG-LG([A-Za-z0-9]+)",device_replacement:"LG $1",manufacturer:"LG"},{regex:"LGE-LG([A-Za-z0-9]+)",device_replacement:"LG $1",manufacturer:"LG"},{regex:"LGE VX([A-Za-z0-9]+)",device_replacement:"LG $1",manufacturer:"LG"},{regex:"LG ([A-Za-z0-9]+)",device_replacement:"LG $1",manufacturer:"LG"},{regex:"LGE LG\\-AX([A-Za-z0-9]+)",device_replacement:"LG $1",manufacturer:"LG"},{regex:"LG\\-([A-Za-z0-9]+)",device_replacement:"LG $1",manufacturer:"LG"},{regex:"LGE\\-([A-Za-z0-9]+)",device_replacement:"LG $1",manufacturer:"LG"},{regex:"LG([A-Za-z0-9]+)",device_replacement:"LG $1",manufacturer:"LG"},{regex:"(KIN)\\.One (\\d+)\\.(\\d+)",device_replacement:"Microsoft $1"},{regex:"(KIN)\\.Two (\\d+)\\.(\\d+)",device_replacement:"Microsoft $1"},{regex:"(Motorola)\\-([A-Za-z0-9]+)",manufacturer:"Motorola"},{regex:"MOTO\\-([A-Za-z0-9]+)",device_replacement:"Motorola $1",manufacturer:"Motorola"},{regex:"MOT\\-([A-Za-z0-9]+)",device_replacement:"Motorola $1",manufacturer:"Motorola"},{regex:"Philips([A-Za-z0-9]+)",device_replacement:"Philips $1",manufacturer:"Philips"},{regex:"Philips ([A-Za-z0-9]+)",device_replacement:"Philips $1",manufacturer:"Philips"},{regex:"SAMSUNG-([A-Za-z0-9\\-]+)",device_replacement:"Samsung $1",manufacturer:"Samsung"},{regex:"SAMSUNG\\; ([A-Za-z0-9\\-]+)",device_replacement:"Samsung $1",manufacturer:"Samsung"},{regex:"Softbank/1\\.0/([A-Za-z0-9]+)",device_replacement:"Softbank $1",other:!0},{regex:"Softbank/2\\.0/([A-Za-z0-9]+)",device_replacement:"Softbank $1",other:!0},{regex:"(hiptop|avantgo|plucker|xiino|blazer|elaine|up.browser|up.link|mmp|smartphone|midp|wap|vodafone|o2|pocket|mobile|pda)",device_replacement:"Generic Smartphone"},{regex:"^(1207|3gso|4thp|501i|502i|503i|504i|505i|506i|6310|6590|770s|802s|a wa|acer|acs\\-|airn|alav|asus|attw|au\\-m|aur |aus |abac|acoo|aiko|alco|alca|amoi|anex|anny|anyw|aptu|arch|argo|bell|bird|bw\\-n|bw\\-u|beck|benq|bilb|blac|c55/|cdm\\-|chtm|capi|comp|cond|craw|dall|dbte|dc\\-s|dica|ds\\-d|ds12|dait|devi|dmob|doco|dopo|el49|erk0|esl8|ez40|ez60|ez70|ezos|ezze|elai|emul|eric|ezwa|fake|fly\\-|fly\\_|g\\-mo|g1 u|g560|gf\\-5|grun|gene|go.w|good|grad|hcit|hd\\-m|hd\\-p|hd\\-t|hei\\-|hp i|hpip|hs\\-c|htc |htc\\-|htca|htcg)",device_replacement:"Generic Feature Phone"},{regex:"^(htcp|htcs|htct|htc\\_|haie|hita|huaw|hutc|i\\-20|i\\-go|i\\-ma|i230|iac|iac\\-|iac/|ig01|im1k|inno|iris|jata|java|kddi|kgt|kgt/|kpt |kwc\\-|klon|lexi|lg g|lg\\-a|lg\\-b|lg\\-c|lg\\-d|lg\\-f|lg\\-g|lg\\-k|lg\\-l|lg\\-m|lg\\-o|lg\\-p|lg\\-s|lg\\-t|lg\\-u|lg\\-w|lg/k|lg/l|lg/u|lg50|lg54|lge\\-|lge/|lynx|leno|m1\\-w|m3ga|m50/|maui|mc01|mc21|mcca|medi|meri|mio8|mioa|mo01|mo02|mode|modo|mot |mot\\-|mt50|mtp1|mtv |mate|maxo|merc|mits|mobi|motv|mozz|n100|n101|n102|n202|n203|n300|n302|n500|n502|n505|n700|n701|n710|nec\\-|nem\\-|newg|neon)",device_replacement:"Generic Feature Phone"},{regex:"^(netf|noki|nzph|o2 x|o2\\-x|opwv|owg1|opti|oran|ot\\-s|p800|pand|pg\\-1|pg\\-2|pg\\-3|pg\\-6|pg\\-8|pg\\-c|pg13|phil|pn\\-2|pt\\-g|palm|pana|pire|pock|pose|psio|qa\\-a|qc\\-2|qc\\-3|qc\\-5|qc\\-7|qc07|qc12|qc21|qc32|qc60|qci\\-|qwap|qtek|r380|r600|raks|rim9|rove|s55/|sage|sams|sc01|sch\\-|scp\\-|sdk/|se47|sec\\-|sec0|sec1|semc|sgh\\-|shar|sie\\-|sk\\-0|sl45|slid|smb3|smt5|sp01|sph\\-|spv |spv\\-|sy01|samm|sany|sava|scoo|send|siem|smar|smit|soft|sony|t\\-mo|t218|t250|t600|t610|t618|tcl\\-|tdg\\-|telm|tim\\-|ts70|tsm\\-|tsm3|tsm5|tx\\-9|tagt)",device_replacement:"Generic Feature Phone"},{regex:"^(talk|teli|topl|tosh|up.b|upg1|utst|v400|v750|veri|vk\\-v|vk40|vk50|vk52|vk53|vm40|vx98|virg|vite|voda|vulc|w3c |w3c\\-|wapj|wapp|wapu|wapm|wig |wapi|wapr|wapv|wapy|wapa|waps|wapt|winc|winw|wonu|x700|xda2|xdag|yas\\-|your|zte\\-|zeto|aste|audi|avan|blaz|brew|brvw|bumb|ccwa|cell|cldc|cmd\\-|dang|eml2|fetc|hipt|http|ibro|idea|ikom|ipaq|jbro|jemu|jigs|keji|kyoc|kyok|libw|m\\-cr|midp|mmef|moto|mwbp|mywa|newt|nok6|o2im|pant|pdxg|play|pluc|port|prox|rozo|sama|seri|smal|symb|treo|upsi|vx52|vx53|vx60|vx61|vx70|vx80|vx81|vx83|vx85|wap\\-|webc|whit|wmlb|xda\\-|xda\\_)",device_replacement:"Generic Feature Phone"},{regex:"(bot|borg|google(^tv)|yahoo|slurp|msnbot|msrbot|openbot|archiver|netresearch|lycos|scooter|altavista|teoma|gigabot|baiduspider|blitzbot|oegp|charlotte|furlbot|http%20client|polybot|htdig|ichiro|mogimogi|larbin|pompos|scrubby|searchsight|seekbot|semanticdiscovery|silk|snappy|speedy|spider|voila|vortex|voyager|zao|zeal|fast\\-webcrawler|converacrawler|dataparksearch|findlinks)",device_replacement:"Spider"}],mobile_browser_families:["Firefox Mobile","Opera Mobile","Opera Mini","Mobile Safari","webOS","IE Mobile","Playstation Portable","Nokia","Blackberry","Palm","Silk","Android","Maemo","Obigo","Netfront","AvantGo","Teleca","SEMC-Browser","Bolt","Iris","UP.Browser","Symphony","Minimo","Bunjaloo","Jasmine","Dolfin","Polaris","BREW","Chrome Mobile","Chrome Mobile iOS","UC Browser","Tizen Browser"]};e.parsers=["device_parsers","browser_parsers","os_parsers","mobile_os_families","mobile_browser_families"],e.types=["browser","os","device"],e.regexes=i||function(){var i={};return e.parsers.map(function(e){i[e]=[]}),i}(),e.families=function(){var i={};return e.types.map(function(e){i[e]=[]}),i}();var t=Array.prototype,a=(Object.prototype,Function.prototype,t.forEach),s=(t.indexOf,function(e,i){for(var t={},a=0;a<i.length&&!(t=i[a](e));a++);return t}),n=function(e,i){o(e,function(e){o(i,function(i){delete e[i]})})},o=forEach=function(e,i,t){if(null!=e)if(a&&e.forEach===a)e.forEach(i,t);else if(e.length===+e.length)for(var s=0,n=e.length;s<n;s++)i.call(t,e[s],s,e);else for(var o in e)_.has(e,o)&&i.call(t,e[o],o,e)},r=function(e){return!(!e||"undefined"==typeof e||null==e)},l=function(e){var i="";return e=e||{},r(e)&&r(e.major)&&(i+=e.major,r(e.minor)&&(i+="."+e.minor,r(e.patch)&&(i+="."+e.patch))),i},c=function(e){e=e||{};var i=l(e);return i&&(i=" "+i),e&&r(e.family)?e.family+i:""};return e.parse=function(i){var t=function(i){return e.regexes[i+"_parsers"].map(function(e){function t(i){var t=i.match(a);if(!t)return null;var o={};return o.family=(s?s.replace("$1",t[1]):t[1])||"other",o.major=parseInt(n?n:t[2])||null,o.minor=t[3]?parseInt(t[3]):null,o.patch=t[4]?parseInt(t[4]):null,o.tablet=e.tablet,o.man=e.manufacturer||null,o}var a=new RegExp(e.regex),s=e[("browser"===i?"family":i)+"_replacement"],n=e.major_version_replacement;return t})},a=function(){},o=t("browser"),d=t("os"),u=t("device"),p=new a;p.source=i,p.browser=s(i,o),r(p.browser)?(p.browser.name=c(p.browser),p.browser.version=l(p.browser)):p.browser={},p.os=s(i,d),r(p.os)?(p.os.name=c(p.os),p.os.version=l(p.os)):p.os={},p.device=s(i,u),r(p.device)?(p.device.name=c(p.device),p.device.version=l(p.device)):p.device={tablet:!1,family:"Other"};var f={};e.regexes.mobile_browser_families.map(function(e){f[e]=!0}),e.regexes.mobile_os_families.map(function(e){f[e]=!0});return"Spider"===p.browser.family?p.device.type="Spider":p.browser.tablet||p.os.tablet||p.device.tablet?p.device.type="Tablet":f.hasOwnProperty(p.browser.family)?p.device.type="Mobile":p.device.type="Desktop",p.device.manufacturer=p.browser.man||p.os.man||p.device.man||null,n([p.browser,p.os,p.device],["tablet","man"]),p},e}();"undefined"!=typeof t&&("undefined"!=typeof i&&i.exports&&(t=i.exports=s),t.detect=s)}(window)},{}],6:[function(e,i,t){function a(e){for(var i=e.urlParams.lan||"cn",t=!1,a=0;a<o.length;a++)if(o[a]==i){t=!0;break}switch(t||(i="cn"),i){case"cn":return s;case"en":return n}}var s=e("./locale/zh-cn.json"),n=e("./locale/en.json"),o=["cn","en"];i.exports=a},{"./locale/en.json":7,"./locale/zh-cn.json":8}],7:[function(e,i,t){i.exports={html:{HTML_MSG00:"Back",HTML_MSG01:"Load more record",HTML_MSG02:"Live Chat",HTML_MSG03:"Send",HTML_MSG04:"Photos",HTML_MSG05:"Feedback",HTML_MSG06:"Feedback",HTML_MSG07:"Continue",HTML_MSG08:"Submit",HTML_MSG09:"The email has been sent successfully",HTML_MSG010:"The team will contact you soon",HTML_MSG011:"OK",HTML_MSG0112:"Load more record",HTML_MSG0113:"Live Chat",HTML_MSG0114:"Send",HTML_MSG0115:"Feedback",HTML_MSG0116:"Continue",HTML_MSG0117:"Email",HTML_MSG0118:"Tel"},system:{L10001:"Sorry, the team is not in service right now ",L10002:"{0} is at your service ",L10003:"Conversation has ended temporarily,{0} ",L10004:"Please wait, there are {0} people in need of service before you ",L10005:"You haven't been talking for long time ",L10006:'<a href="javascript: window.location.reload();">Continue</a> ',L10007:"Conversation with {0} has been ended temporarily {1} ",L10008:"Conversation with {0} has been ended temporarily {1} ",L10009:"Conversation with {0} has been ended temporarily ",L10010:"Conversation has been ended temporarily.{0} ",L10011:"{0} You have opened a new window {1}",L10012:"No more record",L10013:"Sorry, the team is not in service right now ",L10014:"Image size can not exceed 5M",L10015:"This file type is not supported",L10016:"Loading...",L10017:"Loading...",L10018:"Load more record",L10019:"{0} is at your service",L10020:"{0} is typing",L10021:"Conversation with {0} has been ended temporarily",L10022:'{0} You can also send us an <a href="javascript: void(0);" id="systemMsgLeaveMessage"> email </a>',L10023:'{0} <span  id="systemMsgLeaveMsg">Please wait...</span>',L10024:'You can also send us an <a class="leave-msg-btn" href="{0}" data-href="{1}"> email </a>',L10025:"Service Unavailable",L10026:"Waiting",L10027:"Sorry, the team is not in service right now",L10028:"Conversation with {0} has been ended temporarily",L10029:"You haven't been talking for long time",L10030:"You've opened a new window",L10031:"Conversation has been ended temporarily",L10032:"Please try to describe your problem in other ways",L10033:"This file type is not supported",L10034:"Image size can not exceed 5M",L10035:"Please try another browser",L10036:"Sending...",L10037:"Thank you",L10038:"Failure, please try again",L10039:'You can also send us an <a class="leave-msg-btn js-leaveMessage" href="javascript:void(0);" > email </a>',L10040:"The customer service {0} withdrew a message",L10041:"Reminder, This information may have a risk",L10042:"problem description up to 5000 code",L10043:"Netork Error,Please reload this page. ",L10044:"minimize",L10045:"maximize",L10046:"close",L10047:"on/off",L10048:"Your session has timed out，please refresh to restart the session.",L10049:"Customer Service {0} launched a remote assistance request",L10050:"Customer service {0} Canceled remote assistance",L10051:"Customer service {0} Remote assistance is over.",L10052:"You have declined a remote assistance request from Customer Service {0}.",L10053:"You have ended a remote assistance session with Customer Service {0}.",L10054:"Hello {0}, remote assistance is over",L10055:"Customer Service",L10056:"The robot may not be able to solve your problem. You'll be forwarded to agent service.",L10058:"You have agreed《{text}》authorize",L10059:"You have agreed to send sensitive personal information, this authorization is valid for 24 hours"},text:{T0000:"Cancel",T0001:"OK",T0002:"Load more record",T0003:"Loading····",T0004:"No more record",T0005:"Yes",T0006:"No",T0010:"What do you need?",T0011:"Today",T0012:"Customer Support_",T0013:"Yesterday",T0020:"Customer Service is typing",T0021:"Are you satisfied with our service?",T0022:"Are you satisfied with our service?",T0023:"Send a massage",T0024:"Please wait...",T0025:"We've received your feedback",T0026:"You need to ask questions before feedback",T0027:"What is the problem?",T0028:"Tell us your suggestion",T0029:"Submit",T0030:"Email",T0031:"Sending···",T0032:"Thank you",T0033:"Failure, please try again",T0034:"Email@domain.com (required)",T0035:"Email doesn't look quite right",T0036:"Email doesn't look quite right",T0037:"The description is needed",T0038:"Continue",T0039:"Submit email",T0040:"Email",T0041:"Yes",T0042:"No",T0043:"Feedback",T0044:"Tel",T0045:"tel is not correct",T0046:" (required)",T0047:"",T0048:"Send a massage",T0049:"qq Face",T0050:"upload",T0051:"Email",T0052:"Feedback",T0053:"Email@domain.com",T0054:"telphone",T0055:"telphone(optional)",T0056:"The email has been sent successfully",T0057:"Powered by Sobot",T0058:" new messages",T0059:"new messages",T0060:"Live Chat",T0061:"Company:",T0062:"Email:",T0063:"serviceNo:",T0064:"Name:",T0065:"Remark:",T0066:"Tel:",T0067:"phone:",T0068:"open",T0069:"close",T0070:"Thank You",T0071:"Sorry",T0072:"Session end",T0073:"Error",T0074:"Already evaluated",T0075:"Upload Error",T0076:"Please Upload Files",T0077:"Maximum upload file size",T0078:"Upload file is not supported",T0079:"Image size can not exceed 5M",T0080:"Please Upload Image",T0081:"This file type is not supported",T0082:"file size can not exceed 50M",T0083:"upload...",T0084:"upload failed",T0085:"upload attachments",T0086:"Maximum upload 5",T0087:"Confirm closing?",T0088:"Ignore upload failed files?",T0089:"Continue",T0090:"Uploading",T0091:"Ignore upload failed Images?",T0092:"Email@domain.com(optional)",T0093:"Feedback",T0094:"Tell us about your problems?",T0095:"Submit",T0096:"Feedback",T0097:"Not evaluate",T0098:"Whether to solve the problem?",T0099:"title",T0100:"abstract",T0101:"label",T0102:"url",T0103:"Please rate the service",T0104:"Please choose tag",T0105:"evaluate can't be blank",T0106:"Has your question been resolved?",T0107:"Your evaluation will make us do better",T0108:"Please Fill ",T0109:"Types",T0110:"Problem Description",T0111:"close",T0112:"Return",T0113:"Choose minutes",T0114:"Choose hours",T0115:"hours",T0116:"minutes",T0117:"Please fill in the description of the problem",T0118:"Select",T0119:"Customer Service is typing",T0120:"Submit",T0121:"province",T0122:"city",T0123:"country",T0124:"is not correct",T0125:"email is not correct",T0126:"please fill in the required",T0127:"fill in by format ",T0128:"All",T0129:"you have a new message",T0130:"Record",T0131:"complete",T0132:"dealing",T0133:"create",T0134:"order",T0135:"no history",T0136:"history",T0137:"look",T0138:"reply",T0139:"Customer service has successfully received your questions. Please be patient",T0140:"choose business",T0141:"Live Chat",T0142:"helpful",T0143:"helpless",T0144:"Email",T0145:"content",T0146:"The description is needed",T0147:"commit",T0148:"No data yet",T0149:"Custom service",T0150:"User",T0151:"Expand all",T0152:"click",T0153:"to view",T0154:"continue",T0155:"disagree",T0156:"User Information Protocol",T0157:"Your message has been submitted successfully, this session will end, if you need to continue consulting, click the 'Re-establish session' button below.",T0158:"You have new messages",T0159:"Cancelled",T0160:"Download",T0161:"Cannot upload ",T0162:" Format file",T0163:"Please enter the correct",T0164:"Perfect",T0165:"Send",T0166:"Cancel",T0167:"Are you sure to send the picture?",T0168:"Customer service {0} is requesting remote assistance.",T0169:"You have the right to end this assistance at any time after you have started the remote assistance.",T0170:"Deny",T0171:"accept",T0172:"Remote assistance being connected",T0173:"Please first download and install the plug-in according to your computer system version, and activate the remote. If you have already downloaded and activated it, please ignore it.",T0174:"Win10 Plugin",T0175:"Win 7 and following plug-ins",T0176:"Activate Remote",T0177:"Only {0} words can be sent at a time, exceeding {1} words",T0178:"In remote assistance",T0179:"You are still in Remote Assistance, closing the session will close Remote Assistance. Confirm closing the session?",T0183:"Please check 'I have read and agree'",T0184:"I have read and agree",T0185:"Start consulting",T0186:"Expand message",T0187:"Continue sending",T0188:"refuse",T0189:"You have declined to send this message",T0190:"The session has ended and cannot be operated"}}},{}],8:[function(e,i,t){i.exports={html:{HTML_MSG00:"返回",HTML_MSG01:"下拉显示更多",HTML_MSG02:"转人工",HTML_MSG03:" 发 送 ",HTML_MSG04:"图片",HTML_MSG05:"评价",HTML_MSG06:"满意度评价",HTML_MSG07:"重新建立会话",HTML_MSG08:"提交",HTML_MSG09:"创建成功",HTML_MSG010:"我们将会以链接的形式在会话中向您反馈工单处理状态",HTML_MSG011:"完成",HTML_MSG0112:"点击加载历史记录",HTML_MSG0113:"转人工服务",HTML_MSG0114:"发送",HTML_MSG0115:"满意度评价",HTML_MSG0116:"重新建立会话",HTML_MSG0117:"留言",HTML_MSG0118:"手机"},system:{L10001:"暂时无法转接人工客服",L10002:"您好,客服{0}接受了您的请求",L10003:"您已经与服务器断开连接,{0}",L10004:"排队中，您在队伍中的第{0}个",L10005:"您在思考人生？有问题请随时提问哦",L10006:'<a href="javascript: window.location.reload();">重新接入</a>',L10007:"{0}有事离开了{1}",L10008:"您与{0}的会话已结束{1}",L10009:"{0}结束了本次会话",L10010:"您长时间没有说话，本次会话已结束。{0}",L10011:"{0}您已打开新聊天窗口{1}",L10012:"没有更多记录",L10013:"抱歉，您无法接入在线客服",L10014:"图片过大",L10015:"格式不支持",L10016:"正在加载...",L10017:"正在加载...",L10018:"下拉显示更多",L10019:"客服{0}发起了会话",L10020:"{0}正在输入",L10021:"本次会话结束{0}",L10022:'{0} 您可以<a href="javascript: void(0);" id="systemMsgLeaveMessage"> 留言 </a>',L10023:'{0} <span  id="systemMsgLeaveMsg">请等待</span>',L10024:'您可以<a class="leave-msg-btn" href="#0"  data-href="{1}"> 留言 </a>',L10025:"暂无客服在线",L10026:"排队中",L10027:"暂无人工客服在线",L10028:"您与{0}的会话已经结束",L10029:"您已经很长时间未说话了哟，有问题尽管咨询",L10030:"您已打开新窗口，刷新可继续会话",L10031:"您已长时间未说话，系统自动关闭本次会话，刷新可继续会话",L10032:"非常对不起哦，不知道怎么回答这个问题呢，我会努力学习的。",L10033:"请上传正确的图片格式",L10034:"图片不能大于5M",L10035:"抱歉，此浏览器不支持上传图片！",L10036:"正在发送，请稍候...",L10037:"谢谢您的反馈",L10038:"提交失败!请重试",L10039:' 您可以<a class="leave-msg-btn js-leaveMessage" href="javascript:void(0);" > 留言 </a>',L10040:"客服 {0} 撤回了一条消息",L10041:"温馨提示：从正规网站按照正常操作进行交易，不要轻易提供验证码、账号等隐私信息，谨防被骗！",L10042:"问题描述上限5000个字符",L10043:"网络问题，请刷新页面重试",L10044:"最小化",L10045:"最大化",L10046:"关闭",L10047:"开/关 声音",L10048:"您长时间未说话，系统已关闭本次对话，请您重新建立会话",L10049:"客服 {0} 发起了远程协助申请",L10050:"客服 {0} 取消了远程协助",L10051:"客服 {0} 结束了远程协助",L10052:"您拒绝了客服 {0} 的远程协助申请",L10053:"您结束了与客服 {0} 的远程协助",L10054:"{0} 您好，远程协助已结束",L10055:"人工客服",L10056:"对不起，未能解决您的问题，正在为您转接人工客服",L10058:"您已同意《{text}》授权",L10059:"您已同意发送个人敏感信息，本次授权有效期为24小时"},text:{T0000:"取消",T0001:"确定",T0002:"下拉加载更多",T0003:"加载中····",T0004:"没有更多",T0005:"是",T0006:"否",T0010:"选择要咨询的内容",T0011:"今天",T0012:"咨询客服—",T0013:"昨天",T0020:"客服正在输入···",T0021:"是否解决了您的问题？",T0022:"客服评价",T0023:"请简要描述您的问题",T0024:"排队中，请稍后····",T0025:"您的评价已成功提交",T0026:"咨询后才能评价服务质量",T0027:"存在以下哪些问题：",T0028:" 欢迎给我们服务提建议~",T0029:"提交评价",T0030:"留言",T0031:"正在发送",T0032:"谢谢您的反馈",T0033:"提交失败!请重试",T0034:"邮箱 （必填）",T0035:"请填写邮箱",T0036:"邮箱格式错误",T0037:"请填写问题描述！",T0038:"开始咨询",T0039:"提交留言",T0040:"请您留言",T0041:"已解决",T0042:"未解决",T0043:"评价",T0044:"手机",T0045:"手机号格式不正确",T0046:"（必填）",T0047:"（选填）",T0048:"请简要描述您的问题...",T0049:"表情",T0050:"上传文件",T0051:"留言",T0052:"满意度",T0053:"邮箱",T0054:"手机",T0055:"手机（选填）",T0056:"您的留言已成功提交",T0057:"Powered by 智齿科技",T0058:" 条新消息",T0059:"以下为未读消息",T0060:"转人工服务",T0061:"公司：",T0062:"邮箱：",T0063:"工号：",T0064:"姓名：",T0065:"备注：",T0066:"手机：",T0067:"电话：",T0068:"展开",T0069:"收起",T0070:"感谢您的支持",T0071:"我会努力学习，希望下次帮到您",T0072:"会话结束，无法反馈",T0073:"提交失败请稍后重试",T0074:"已评价过该词条",T0075:"上传失败！",T0076:"请上传附件!",T0077:"已达到最大上传附件数量",T0078:"不支持上传此格式文件,您可以将文件打包为zip或者rar格式文件上传",T0079:"图片大小不能超过5MB",T0080:"请上传图片",T0081:"请上传正确的图片格式",T0082:"文件大小不能超过50MB",T0083:"上传中...",T0084:"上传失败",T0085:"上传附件",T0086:"最多上传5个附件",T0087:"您的留言尚未提交，确认关闭？",T0088:"提交将自动忽略上传失败的附件",T0089:"仍然提交",T0090:"有文件正在上传，无法提交",T0091:"提交将自动忽略上传失败的图片",T0092:"邮箱（选填）",T0093:"邀请您对本次服务进行评价",T0094:"告诉我们您遇到的问题？",T0095:"提交",T0096:"请您对本次服务进行评价",T0097:"暂不评价",T0098:"是否解决了您的问题？",T0099:"标题",T0100:"摘要",T0101:"标签",T0102:"链接",T0103:"请您对本次服务进行评分",T0104:"请至少选择一个标签",T0105:"请填写评价详情",T0106:"是否解决了您的问题？",T0107:"您的评价会让我们做得更好",T0108:"请填写",T0109:"问题类型",T0110:"问题描述",T0111:"关闭",T0112:"上一级",T0113:"选择分钟",T0114:"选择小时",T0115:"时",T0116:"分",T0117:"请填写问题类型！",T0118:"请选择",T0119:"正在输入···",T0120:"提交并咨询",T0121:"选择省",T0122:"选择市",T0123:"选择县",T0124:"填写不正确",T0125:"邮箱填写不正确",T0126:"请填写必填项",T0127:"按格式填写",T0128:"全部",T0129:"您的留言状态有更新",T0130:"留言记录",T0131:"已完成",T0132:"受理中",T0133:"已创建",T0134:"工单号",T0135:"暂无相关信息",T0136:"留言详情",T0137:"查看详情",T0138:"问题回复",T0139:"客服已经成功收到您的问题，请耐心等待",T0140:"选择要咨询的业务",T0141:"转人工",T0142:"有用",T0143:"没用",T0144:"留言消息",T0145:"留言内容",T0146:"请填写留言内容！",T0147:"提交留言",T0148:"暂时没有数据",T0149:"客服回复",T0150:"用户回复",T0151:"全部展开",T0152:"点击",T0153:"查看",T0154:"同意授权并继续",T0155:"不同意",T0156:"用户隐私协议",T0157:"您的留言已经提交成功，此会话将结束，如需继续咨询可点击下方“重新建立会话”按钮。",T0158:"您有【新消息】",T0159:"已取消",T0160:"下载",T0161:"不能上传 ",T0162:" 格式的文件",T0163:"请输入正确的",T0164:"非常满意",T0165:"发送",T0166:"取消",T0167:"确认发送图片？",T0168:"客服「 {0} 」正在请求远程协助",T0169:"开始远程协助后您有权随时结束本次协助。",T0170:"拒绝",T0171:"接受",T0172:"正在连接远程协助",T0173:"请先根据您的电脑系统版本下载安装插件，并激活远程。如已下载并激活，请忽略。",T0174:"Win10插件",T0175:"Win7及以下插件",T0176:"激活远程",T0177:"每次仅能发送 {0} 个字，已超出 {1} 个字",T0178:"远程协助中",T0179:"您还在远程协助中，关闭会话将关闭远程协助。确认关闭会话吗？",T0183:"请勾选“我已阅读并同意”",T0184:"我已阅读并同意",T0185:"开始咨询",T0186:"展开消息",T0187:"继续发送",T0188:"拒绝",T0189:"您已拒绝发送此消息",T0190:"会话已结束，无法操作"}}},{}],9:[function(e,i,t){
var a=function(i,t,a){var s,n=e("../util/listener.js"),o=e("./template.js"),r=i.language.lan,l=i.language.text,c=function(e){var i={};i={text:e};var t=doT.template(o.showTip)(i),a=$(t),s=$(".js-mainBox");s.append(a);var n=s.height()/2-21,r=s.width()/2-70;a.find(".js-showTip").css({top:n,left:r}),setTimeout(function(){a.find(".js-showTip").remove()},3e3)},d=function(){$(".authorization-footer-checkbox").click(function(){s=$("#authorization-cbx").attr("checked"),$("#authorization-cbx").attr("checked",!s),s?($(".authorization-footer-btn").css({opacity:.5}),$(".authorization-footer-checkbox .checkbox").removeClass("checked")):($(".authorization-footer-btn").css({opacity:1}),$(".authorization-footer-checkbox .checkbox").addClass("checked"))})},u=function(){$(".authorization-footer-btn").click(function(){s=$("#authorization-cbx").attr("checked"),s?p():c(l.T0183)})},p=function(){$.ajax({type:"post",url:"/chat-web/user/authSafety",dataType:"json",timeout:5e3,data:{uid:i.apiInit.uid},success:function(e){1===e.status&&($(".authorization").remove(),n.trigger("core.system",{type:"system",status:"",data:{content:r.L10058.replace("{text}",i.apiConfig.consultName||"---")}}),t.resolve(a||i,t),n.trigger("system.initSession"))},error:function(e){alert("请求失败，请稍后再试")}})},f=function(){var e="iframe"==i.urlParams.from,t=e?300:"80%",a=e?195:338,s=doT.template(o.privacyTemplate)({title:i.apiConfig.consultName,checkboxText:l.T0184,btnText:l.T0185});$(".js-mainBox").append(s),$(".authorization-content").html(i.apiConfig.consultContent),$(".authorization").css({display:"block"}),$(".authorization-container").css({width:t}),$(".authorization-content").css({maxHeight:a}),$("#authorization-cbx").change(function(e){e.target.checked?$(".authorization-footer-btn").css({opacity:1}):$(".authorization-footer-btn").css({opacity:.5})}),d(),u()},m=function(){f()};return m(),t};i.exports=a},{"../util/listener.js":33,"./template.js":22}],10:[function(e,i,t){function a(i,t){var a,s=e("../util/listener.js"),n=e("../util/promise.js"),t=t||new n,o=e("./template.js"),r=(e("../util/load.js")(),i.global||{}),l=(i.groupId||"",i.tranType||""),c=(i.transferType||"",i.transferAction||"",r.language.lan,r.language.text),d=(e("../config/config.json"),e("../util/monitAjax.js")(r)),u=[],p={},f={},m=60,g=60,v=!0,h=function(){$.ajax({type:"get",url:"/chat-web/user/queryFormConfig.action",dataType:"json",data:{uid:r.apiInit.uid},success:function(e){1==e.status&&(r.openFlag=e.openFlag,e.openFlag&&1!=e.ustatus&&r.apiInit.ustatus!=-2&&!r.apiConfig.fillFormFlag?"pc"===r.pageType?y(e):T(e):(s.trigger("chatGroups.hide"),t.resolve(i)))}})},y=function(n){var l=n.fields,h=e("./dropdownMenu.js"),y=!0,T={},j=function(){var e=$(this).attr("data-fieldId"),i=[],t=[];$(this).find(".js-userCheckIco"+e).hasClass("userCheckIcoActive")?($(this).addClass("userCheck"),$(this).find(".js-userCheckIco"+e).removeClass("userCheckIcoActive")):($(this).removeClass("userCheck"),$(this).find(".js-userCheckIco"+e).addClass("userCheckIcoActive")),$(".js-userCheckIco"+e).each(function(){$(this).hasClass("userCheckIcoActive")&&(i.push($(this).parent().attr("dataValue")),t.push($(this).parent().attr("dataName")))}),i=i.join(","),t=t.join(",");var a={fieldId:e,dataValue:i,dataName:t};f[a.fieldId].value=a.dataValue,p[a.fieldId]=a.dataValue},I=function(){var e=$(this).attr("data-fieldId"),i=$(this).attr("dataValue"),t=$(this).attr("dataName");a.find(".js-userOptIco"+e).removeClass("userOptIcoActive"),a.find(".js-userOptIco"+e).parent().addClass("userOpt"),$(this).removeClass("userOpt").find(".js-userOptIco"+e).addClass("userOptIcoActive");var s={fieldId:e,dataValue:i,dataName:t};f[s.fieldId].value=s.dataValue,p[s.fieldId]=s.dataValue},b=function(){var e=$(this).attr("data-fieldId"),i=$(this).val();f[e].value=i,p[e]=i,a.find(".js-errorTip"+e).css("visibility","hidden")},w=function(e,i){f[i].value=e,p[i]=e,a.find(".js-errorTip"+i).css("visibility","hidden")},x=function(){var e=$(this).attr("data-fieldId"),i=$(".js-definedNumInput"+e).val();i.length>300&&(i=i.slice(0,300)),a.find(".js-definedNumInput"+e).val(i)},k=function(e){"province"==e.key||"city"==e.key||"county"==e.key||("definedList"==e.type?(f[e.fieldId].value=e.dataValue,p[e.fieldId]=e.dataValue):"time"==e.type&&(f[e.fieldId].value=e.dataValue,p[e.fieldId]=e.dataValue),a.find(".js-errorTip"+e.fieldId).css("visibility","hidden"))},F=function(){a.find(".js-chatBeforeFormlayer").addClass("show"),a.find("#chatBeforeForm").animate({right:"0"})},C=function(){t.reject(t),a.find(".js-chatBeforeFormlayer").removeClass("show"),a.find(".js-chatBeforeForm").animate({right:"-390px"},function(){setTimeout(function(){a.remove()},300)}),s.off("core.closeAlldropMenu"),s.off("core.fillProvinceInner"),s.off("core.definedFieldResult"),s.off("core.fillCityInner")},S=function(){var e=$(".js-mainBox").height()-m-g;a.find(".chatBeforeFormBody").height(e)},L=function(e){var i;e&&e.this_el&&(i=e.this_el);for(var t in T)i&&t==i||T[t].collapse()},M=function(e){var e=e||{};return f.city.value="填了",e.areaId?(p.areaId=e.areaId,void(p.areaName=e.dataName)):void d({type:"post",url:"/chat-web/user/queryCity.action",dataType:"json",data:e,success:function(i){if(i&&1==i.status)if(e.provinceId){var t={list:i.citys},s=doT.template(o.cityEle)(t);a.find(".js-cityDropListUl").html(s),a.find(".js-cityDropListTitle").html("选择市"),a.find(".js-countryDropListTitle").html("选择县"),p.proviceId=e.provinceId,p.proviceName=e.dataName,p.cityId="",p.cityName="",p.areaId="",p.areaName=""}else if(e.cityId){var t={list:i.areas},s=doT.template(o.countryEle)(t);a.find(".js-countryDropListUl").html(s),a.find(".js-countryDropListTitle").html("选择县"),p.cityId=e.cityId,p.cityName=e.dataName,p.areaId="",p.areaName=""}},error:function(){}})},A=function(){var e={};d({type:"post",url:"/chat-web/user/queryCity.action",dataType:"json",data:e,success:function(e){if(e&&1==e.status){var i={list:e.provinces},t=doT.template(o.provinceEle)(i);a.find(".js-provinceDropListUl").html(t)}},error:function(){}})},P=function(e,i){var t=!1,a=!1,s=!1,n=!1;return i.forEach(function(e){7===e&&(s=!0,n=!1,a=!1,t=!1),8===e&&s===!1&&(n=!0,a=!1,t=!1),5===e&&s===!1&&n===!1&&(a=!0,t=!1),4===e&&s===!1&&n===!1&&a===!1&&(t=!0)}),s?/^([A-Za-z0-9_\-\.])+\@([A-Za-z0-9_\-\.])+\.([A-Za-z]{2,4})$/.test(e):n?/^1[1-9]\d{9}$/.test(e):a?/^[0-9]+$/.test(e):!t||/^[\u4e00-\u9fa5_a-zA-Z0-9]+$/.test(e)},D=function(){for(var e=0,s=0;s<u.length;s++)if(f[u[s].id].fillFlag&&""==f[u[s].id].value?(a.find(".js-errorTip"+f[u[s].id].id).css("visibility","inherit"),v=!1):(u[s].value=f[u[s].id].value,a.find(".js-errorTip"+f[u[s].id].id).css("visibility","hidden"),e++),"email"==f[u[s].id].id&&""!=f[u[s].id].value){var n=/^([a-zA-Z0-9]+([-_\.][a-zA-Z0-9]+)*(?:@(?!-))(?:(?:[-a-zA-Z0-9]*)(?:[a-zA-Z0-9](?!-))(?:\.(?!-)))+[a-zA-Z0-9]{2,})$/;if(!n.test(f[u[s].id].value))return void a.find(".js-errorTip"+f[u[s].id].id).html(f[u[s].id].fieldName+c.T0124).css("visibility","inherit")}for(var o=0;o<u.length;o++){var l=u[o];if(l.value){if(l.limitOptions){var m=P(l.value,JSON.parse(l.limitOptions));if(!m)return void a.find(".js-limitTip"+f[u[o].id].id).show();a.find(".js-limitTip"+f[u[o].id].id).hide()}}else a.find(".js-limitTip"+f[u[o].id].id).hide()}if(0!=u.length&&e!=u.length||(v=!0),v&&y){p=JSON.stringify(p),y=!1;var g={uid:r.apiInit.uid,companyId:r.sysnum,customerFields:p};d({type:"post",url:"/chat-web/user/submitForm.action",dataType:"json",data:g,success:function(e){e&&1==e.status&&(t.resolve(i),r.apiConfig.fillFormFlag=!0,C())},error:function(){}})}},_=function(){$chatBeforeFormlayer=a.find(".js-chatBeforeFormlayer"),$close=a.find(".js-close"),$txtTip=a.find(".js-txt-tip"),$definedFields=a.find(".js-definedFields"),$userCheck=a.find(".js-userCheck"),$userOpt=a.find(".js-userOpt"),$definedNumInput=a.find(".js-definedNumInput"),$chatBeforeFormSubmit=a.find(".js-chatBeforeFormSubmit")},N=function(){$definedNumInput.on("input",x),a.delegate(".js-definedInput","blur",b),s.on("core.definedFieldResult",k),s.on("core.fillCityInner",M),s.on("core.fillProvinceInner",A),$userCheck.on("click",j),$userOpt.on("click",I),$chatBeforeFormSubmit.on("click",D),$(window).on("resize",S),a.delegate(".js-chatBeforeFormlayer","click",function(){C()}),a.delegate(".js-cancel-btn","click",function(){C()}),s.on("core.closeAlldropMenu",L)},R=function(){s.trigger("chatGroups.hide");var e=doT.template(o.chatBeforeFormPc)({global:r,formDoc:n.formDoc,formTitle:n.formTitle,languageText:c,definedField:l});a=$(e),$(".js-mainBox").append(a);for(var i=a.find(".js-dropdownList"),t=0;t<i.length;t++){var d=$(i[t]).attr("id");T[d]=new h(i[t],r,d)}a.find(".submit").css("background-color",r.apiConfig.color);for(var t=0;t<l.length;t++){var p={};p.id=l[t].cusFieldConfig.fieldId,p.fieldName=l[t].cusFieldConfig.fieldName,4==l[t].cusFieldConfig.fieldType?(p.fillFlag=0,p.value="00:00"):(p.fillFlag=l[t].cusFieldConfig.fillFlag,p.value=""),p.limitOptions=l[t].cusFieldConfig.limitOptions,p.fieldType=l[t].cusFieldConfig.fieldType,u.push(p),f[p.id]=p}for(var t=0,m=l.length;t<m;t++)3==l[t].cusFieldConfig.fieldType&&a.find("#dp"+l[t].cusFieldConfig.fieldId).datepicker().on("changeDate",function(e){var i,t,a,s=e.date;i=s.getFullYear(),t=s.getMonth()+1<10?"0"+(Number(s.getMonth())+1):s.getMonth()+1,a=s.getDate()<10?"0"+s.getDate():s.getDate(),_bir=i+"-"+t+"-"+a,$(this).val(_bir);var n=$(this).attr("data-fieldId");w(_bir,n),$(".datepicker.dropdown-menu").hide()});F(),_(),N(),S()};R()},T=function(e){var n,l,m=e.fields,g=!1,h=!0,y="",T=function(){var e=$(this).attr("fieldId"),i=$(this).val();f[e].value=i},j=function(){var e=$(this).attr("fieldId"),i=$(this).val();f[e].value=i},I=function(){var e=0;$(this).parents(".js-definedArea").find(".js-dropListArea").animate({bottom:e+"px",opacity:1},300),a.find(".js-definedLayer").show(),a.find(".js-definedLayer").animate({opacity:1},300)},b=function(){var e=$(this).attr("date-type"),i=0;"hour"==e?$(this).parent().find(".js-dropListHour").animate({bottom:i+"px"},300):"minutes"==e&&$(this).parent().find(".js-dropListMinutes").animate({bottom:i+"px"},300),a.find(".js-definedLayer").show(),a.find(".js-definedLayer").animate({opacity:1},300)},w=function(){var e=$(this).attr("date-type"),i=$(this).attr("dataValue"),t=$(this).attr("fieldId");$(this).addClass("active").siblings().removeClass("active"),"hour"==e?$(this).parents(".js-definedArea").find(".js-definedHour").val(i):"minutes"==e&&$(this).parents(".js-definedArea").find(".js-definedMinutes").val(i),f[t].value=$(this).parents(".js-definedArea").find(".js-definedHour").val()+":"+$(this).parents(".js-definedArea").find(".js-definedMinutes").val()},x=function(){$(this).parents(".js-dropListArea").animate({bottom:"-382px",opacity:0},300),a.find(".js-definedLayer").animate({opacity:0},300,function(){setTimeout(function(){a.find(".js-definedLayer").hide()},100)})},k=function(){var e=$(this).attr("datavalue"),i=$(this).attr("dataName"),t=$(this).attr("fieldId");f[t].value=e,$(this).parent().find("li").removeClass("active"),$(this).addClass("active"),$(this).parents(".definedArea").find(".js-definedDropListText").html(i)},F=function(){$(this).hasClass("checkedActive")?$(this).removeClass("checkedActive"):$(this).addClass("checkedActive")},C=function(){for(var e=$(this).attr("fieldId"),i=$(this).prev().find(".js-definedCheckedLi"),t="",s="",n=0;n<i.length;n++)$(i[n]).hasClass("checkedActive")&&(t+=$(i[n]).attr("dataValue")+",",s+=$(i[n]).attr("dataName")+";");t.length>0&&(t=t.substr(0,t.length-1)),s.length>0?(s=s.substr(0,s.length-1),$(this).parents(".js-definedArea").find(".js-definedDropListText").html(s)):$(this).parents(".js-definedArea").find(".js-definedDropListText").html("--"),f[e].value=t,$(this).parents(".js-dropListArea").animate({bottom:"-382px",opacity:0},300),a.find(".js-definedLayer").animate({opacity:0},300,function(){setTimeout(function(){a.find(".js-definedLayer").hide()},100)})},S=function(){var e=(window.screen.width,50),i=0;"none"!=$(".js-header-back").css("display")&&(i=50,a.find(".js-chatFormLayer").css("top",i+"px")),definedHeight=l.height()-e,a.find(".js-chatBeforeForm-content").css({height:definedHeight-i+"px"})},L=function(){a.find(".js-orderClassifyLayer").show();var e=0;a.find(".js-orderClassifyInner").animate({bottom:e+"px"},300),a.find(".js-orderClassifyLayer").animate({opacity:1},300),h=!0},M=function(){a.find(".js-orderClassifyInner").animate({bottom:"-280px"},300),a.find(".js-orderClassifyLayer").animate({opacity:0},300,function(){setTimeout(function(){a.find(".js-orderClassifyLayer").hide()},100)})},A=function(e){var e=e||{};h&&(h=!1,d({type:"post",url:"/chat-web/user/queryCity.action",dataType:"json",data:e,success:function(i){if(i&&1==i.status){if(e.provinceId){g=!0,m=i.citys,p.proviceId=e.provinceId,p.proviceName=e.provinceName,y=e.provinceName,a.find(".js-cityTitle").html(c.T0122),f.city.value=y,a.find(".js-cityAreaTitle").html(y);var t={items:m,languageText:c},s=doT.template(o.cityListEleH5)(t);a.find(".js-areaListArea").html(s)}else if(e.cityId){g=!0,m=i.areas,p.cityId=e.cityId,p.cityName=e.cityName,y+=e.cityName,a.find(".js-cityTitle").html(c.T0123),f.city.value=y,a.find(".js-cityAreaTitle").html(y);var t={items:m,languageText:c},s=doT.template(o.areaListEleH5)(t);a.find(".js-areaListArea").html(s)}else{g=!0,m=i.provinces;var t={items:m,languageText:c},s=doT.template(o.provinceEleH5)(t);a.find(".js-areaListArea").html(s),L()}setTimeout(function(){h=!0},200)}},error:function(){}}))},P=function(e){A()},D=function(){var e=$(this).attr("provinceId"),i=$(this).attr("cityId"),t=$(this).attr("areaId"),s=$(this).attr("endFlag"),n={};if(f.city.value="填了",e){var o=$(this).attr("provinceName");n={provinceId:e,provinceName:o},"true"==s?($(this).addClass("active"),a.find(".js-cityAreaTitle").html(o),p.proviceId=n.provinceId,p.proviceName=n.provinceName,M()):A(n)}else if(i){var r=$(this).attr("cityName");n={cityId:i,cityName:r},"true"==s?($(this).addClass("active"),a.find(".js-cityAreaTitle").html(y+r),p.cityId=n.cityId,p.cityName=n.cityName,M()):A(n)}else if(t){var l=$(this).attr("areaName");return p.areaId=n.areaId,p.areaName=l,y+=l,a.find(".js-cityAreaTitle").html(y),$(this).addClass("active"),M(),void a.find(".js-cityTitle").html(c.T0121)}},_=function(){for(var e=0,s=0;s<u.length;s++){if(f[u[s].id].fillFlag&&""==f[u[s].id].value)return N(c.T0126),void(v=!1);if(u[s].value=f[u[s].id].value,p[u[s].id]=u[s].value,e++,"email"==f[u[s].id].id&&""!=f[u[s].id].value){var n=/^([a-zA-Z0-9]+([-_\.][a-zA-Z0-9]+)*(?:@(?!-))(?:(?:[-a-zA-Z0-9]*)(?:[a-zA-Z0-9](?!-))(?:\.(?!-)))+[a-zA-Z0-9]{2,})$/;if(!n.test(f[u[s].id].value))return void N(c.T0125)}if(3==f[u[s].id].filedType&&""!==f[u[s].id].value){var o=/^((19[0-9][0-9])|(20[0-9][0-9]))-(((0[13578]|1[02])-(0[1-9]|[12][0-9]|3[01]))|((0[469]|11)-(0[1-9]|[12][0-9]|30))|(02-(0[1-9]|[1][0-9]|2[0-8])))$/,l=o.test(f[u[s].id].value);if(!l)return void N(f[u[s].id].fieldName+c.T0124)}}if(0!=u.length&&e!=u.length||(v=!0),v&&h){p=JSON.stringify(p),h=!1;var m={uid:r.apiInit.uid,companyId:r.sysnum,customerFields:p};d({type:"post",url:"/chat-web/user/submitForm.action",dataType:"json",data:m,success:function(e){e&&1==e.status&&(t.resolve(i),a.remove(),r.apiConfig.fillFormFlag=!0)},error:function(){}})}},N=function(e){var i={};i={text:e};var t=doT.template(o.showTip)(i),a=$(t);l.append(a);var s=l.height()/2-21,n=l.width()/2-70;a.find(".js-showTip").css({top:s,left:n}),setTimeout(function(){a.find(".js-showTip").remove()},3e3)},R=function(){t.reject(t),a.remove()},O=function(){l=$(".js-wrapBox"),n=$(".js-showTip")},B=function(){a.delegate(".js-cityAreaTitle","click",P),a.delegate(".js-provinceList","click",D),a.delegate(".js-orderClassifyClose","click",M),a.delegate(".js-definedInput","blur",T),a.delegate(".js-definedDate","blur",j),a.delegate(".js-chatBeforeFormCommit","click",_),a.delegate(".js-definedDropList","click",I),a.delegate(".js-definedTimeDropList","click",b),a.delegate(".js-definedTimeLi","click",w),a.delegate(".js-dropLIstAreaClose","click",x),a.delegate(".js-definedDropListLi","click",k),a.delegate(".js-definedCheckedLi","click",F),a.delegate(".js-checkedSure","click",C),a.delegate(".js-closeForm","click",R)},z=function(){s.trigger("chatGroups.hide");var i={global:r,formDoc:e.formDoc,formTitle:e.formTitle,languageText:c,items:m},t=doT.template(o.chatBeforeFormH5)(i);a=$(t),l.append(a);for(var n=0;n<m.length;n++){var d={};d.id=m[n].cusFieldConfig.fieldId,d.fieldName=m[n].cusFieldConfig.fieldName,4==m[n].cusFieldConfig.fieldType?(d.fillFlag=0,d.value="00:00"):3==m[n].cusFieldConfig.fieldType?(d.fillFlag=m[n].cusFieldConfig.fillFlag,d.value="",d.filedType=3):(d.fillFlag=m[n].cusFieldConfig.fillFlag,d.value=""),u.push(d),f[d.id]=d}},E=function(){O(),z(),B(),S()};E()},j=function(){"keySwitch"==l?t.resolve(i):h()};return j(),t}i.exports=a},{"../config/config.json":2,"../util/listener.js":33,"../util/load.js":34,"../util/monitAjax.js":35,"../util/promise.js":37,"./dropdownMenu.js":13,"./template.js":22}],11:[function(e,i,t){function a(i,t){var a=e("../util/listener.js"),s=e("../util/promise.js"),t=t||new s,n=i.global,o=i.groupList;i.groupId||"",i.tranType||"";transferType=i.transferType||"",transferAction=i.transferAction||"";var r,l=e("./template.js"),c=(n.language.lan,n.language.text),d=(window.navigator.userAgent.indexOf("Mobile")>=0,e("../util/monitAjax.js")(n),!0),u=function(e){var i=doT.template(l.groupTemplate)({list:e,languageText:c});r=$(i),$(".js-wrapBox").append(r),r.delegate(".js-item","click",function(e){var i=e.currentTarget,a=$(i).attr("data-id"),s={global:n,groupId:a,transferType:transferType,transferAction:transferAction};t.resolve(s),r.remove()}),$(document.body).delegate(".js-shadow-layer","click",function(){t.reject(t),r.remove()}),r.delegate(".js-group-outer","click",function(e){e.stopPropagation(),e.preventDefault()}),r.delegate(".js-cancel-btn","click",function(e){t.reject(t),r.remove()}),$(".js-item").css("background-color",n.apiConfig.color),$(".js-cancel-btn").css("color",n.apiConfig.color)},p=function(e){var i=n.apiConfig.color,a=doT.template(l.groupTemplatePC)({list:e,languageText:c});r=$(a),$(".js-mainBox").append(r),r.find(".js-group-outer").animate({right:"0"}),r.delegate(".js-item","click",function(e){if(d){d=!1;var a=e.currentTarget,s=$(a).attr("data-id");$(a).css({"border-color":i,color:i}).siblings().css({"border-color":"",color:""});var o={global:n,groupId:s,transferType:transferType,transferAction:transferAction};t.resolve(o),e.stopPropagation()}}),r.delegate(".js-cancel-btn","click",function(e){r.find(".js-group-outer").animate({right:"-390px"},function(){r.remove(),t.reject(t)})}),r.delegate(".js-group-layer","click",function(){r.find(".js-group-outer").animate({right:"-390px"},function(){r.remove(),t.reject(t)})})},f=function(){"pc"===n.pageType?r.find(".js-group-outer").animate({right:"-390px"},function(){r.remove()}):r.remove()},m=function(){n.urlParams.groupId||"";"pc"===n.pageType?p(o):u(o),a.on("chatGroups.hide",f)};return o?m():t.resolve(i),t}i.exports=a},{"../util/listener.js":33,"../util/monitAjax.js":35,"../util/promise.js":37,"./template.js":22}],12:[function(e,i,t){var a,s={},n=e("../util/listener.js");s.setCurrentState=function(e){a=e,n.trigger("core.statechange",a)},s.getCurrentState=function(){return a},i.exports=s},{"../util/listener.js":33}],13:[function(e,i,t){var a=function(i,t,a){var s=(e("../util/monitAjax.js")(t),e("../util/listener.js")),n=(e("./template.js"),!1);i=$(i);var o=!1,r=function(e){e.stopPropagation();var t=$(this).parent().attr("id"),a={this_el:t};s.trigger("core.closeAlldropMenu",a),n?(i.find(".js-dropdown-menu").removeClass("openActive"),i.find(".js-dropdown-btn").removeClass("checkActive"),i.find(".dropListTitleIcn").css("background-position","-3279px 13px"),n=!1):(i.find(".js-dropdown-menu").removeClass("openActive"),i.find(".js-dropdown-btn").removeClass("checkActive"),$(this).find(".dropListTitleIcn").css("background-position","-3320px 13px"),$(this).addClass("checkActive"),$(this).next().addClass("openActive"),n=!0),"province"!=t||o||(o=!0,s.trigger("core.fillProvinceInner"))},l=function(e){e.stopPropagation();var t=$(this).attr("data-fieldId")||"",a=$(this).attr("dataValue")||"",o=($(this).attr("fieldType")||"",$(this).attr("dataName")||"");if(i.find(".js-dropdown-title").html($(this).html()),a)var r={fieldId:t,dataValue:a,dataName:o,type:"definedList"};else{var l="00:00";l=$("#hour"+t).find(".js-definedHour").html()+":"+$("#minute"+t).find(".js-definedMinutes").html();var r={fieldId:t,dataValue:l,dataName:l,type:"time"}}s.trigger("core.definedFieldResult",r),i.find(".js-dropdown-menu").removeClass("openActive"),i.find(".js-dropdown-btn").removeClass("checkActive"),i.find(".dropListTitleIcn").css("background-position","-3279px 13px"),n=!1},c=function(e){e.stopPropagation();var t=$(this).attr("provinceId"),a=$(this).attr("cityId"),o=$(this).attr("areaId"),r=$(this).attr("title")||"",l={};i.find(".js-dropdown-title").html($(this).html()),t?l={provinceId:t,dataName:r}:a?l={cityId:a,dataName:r}:o&&(l={areaId:o,dataName:r}),s.trigger("core.fillCityInner",l),i.find(".js-dropdown-menu").removeClass("openActive"),i.find(".js-dropdown-btn").removeClass("checkActive"),i.find(".dropListTitleIcn").css("background-position","-3279px 13px"),n=!1},d=function(){n=!1,i.find(".js-dropdown-menu").removeClass("openActive"),i.find(".js-dropdown-btn").removeClass("checkActive"),i.find(".dropListTitleIcn").css("background-position","-3279px 13px")},u=function(){},p=function(){},f=function(){i.delegate(".js-dropdown-btn","click",r),i.delegate(".js-dropdownLi","click",l),i.delegate(".js-cityLi","click",c),$(document.body).on("click",function(){s.trigger("core.closeAlldropMenu")})},m=function(){},g=function(){m(),p(),f()};g(),this.expand=u,this.collapse=d};i.exports=a},{"../util/listener.js":33,"../util/monitAjax.js":35,"./template.js":22}],14:[function(e,i,t){var a=function(i){var t,a,s=e("../util/listener.js"),n=e("../util/promise.js"),o=e("../util/date.js"),r=e("../socket/robot.js"),l=e("./currentState.js"),c=e("../util/monitAjax.js")(i),d=(e("../socket/websocket.js"),e("../socket/rolling.js"),e("./transfer.js")),u=e("./initsession.js"),p=e("./tdrobot.js"),f=e("../socket/socketfactory.js"),m=(e("../comm"),i.apiConfig.leaveMsg),g=i.language.lan,v=!1,h=function(e,t,a){var n=a?t.aface:i.apiConfig.robotLogo,r=a?t.aname:i.apiConfig.robotName,a=a||i.urlParams.robotHelloWord,c=i.apiInit.ustatus==-2,d=i.apiInit.ustatus==-2?1:0;e||(e=[]);var u=new Date,p={date:o.formatDate(u),content:[{senderType:d?1:a?2:1,t:+u,msg:a,ts:o.formatDate(u,!0),senderFace:n,senderName:r}]};c||l.setCurrentState("human"),i.apiConfig.adminHelloWordFlag&&e.push(p),setTimeout(function(){s.trigger("core.initsession",e)},0)},y=function(e,a){e||(e=[]);var n=new Date,c={date:o.formatDate(n),content:[{senderType:1,t:+n,msg:i.urlParams.robotHelloWord,ts:o.formatDate(n,!0),senderFace:i.apiConfig.robotLogo,senderName:i.apiConfig.robotName}]};!i.apiInit.multiFlag&&i.apiConfig.robotHelloWordFlag&&e.push(c),t&&t.destroy(),t=new r(i),l.setCurrentState("robot"),setTimeout(function(){s.trigger("core.initsession",e)},0)},T=function(e,a){if(e){var n=new Date,r={date:o.formatDate(n),content:[{senderType:1,t:+n,msg:i.urlParams.robotHelloWord,ts:o.formatDate(n,!0),senderFace:i.apiConfig.robotLogo,senderName:i.apiConfig.robotName}]};l.setCurrentState("robot"),t&&t.destroy(),u(i,a,!1).then(function(e){i.apiConfig.robotHelloWordFlag&&e.push(r),s.trigger("core.initsession",e)})}},j=function(e,a,n){var o=e.queueDoc;v=!0,t&&t.destroy(),t=f(e,i),t.start(),a?(s.trigger("core.initsession",n),setTimeout(function(){i.urlParams.msgflag?e.content=o:e.content=o+" "+m,e.aname=g.L10026,i.apiConfig.customerQueueFlag&&s.trigger("core.system",{type:"system",status:"queue",data:e}),s.trigger("core.sessionclose",-2)},1)):(i.urlParams.msgflag?e.content=o:e.content=o+" "+m,e.aname="排队中",s.trigger("core.system",{type:"system",status:"queue",data:e}),s.trigger("core.sessionclose",-2))},I=function(e){for(var n=e.list||[],o=0,r=n.length;o<r;o++){var c=n[o],d=c;if(200===c.type){i.sessionStatus=1,t&&a&&(t.destroy(),t=a,a=null),l.setCurrentState("human"),s.trigger("core.system",{type:"system",status:"transfer",data:{content:g.L10002.replace("{0}",d.aname)}}),d.serviceInfo.adminHelloWord&&(i.urlParams.adminHelloWord=d.serviceInfo.adminHelloWord),d.content=i.urlParams.adminHelloWord,s.trigger("core.system",{type:"human",data:d}),s.trigger("core.buttonchange",{type:"transfer",action:"hide"});break}}},b=function(e,a,n){t&&t.destroy(),e.content=i.urlParams.adminNonelineTitle,s.trigger("core.buttonchange",{type:"transfer",action:"hide",data:e}),a?setTimeout(function(){s.trigger("core.sessionclose",-1)},1):s.trigger("core.sessionclose",-1)},w=function(e,t){e.status==-2?e.content=g.L10048:i.urlParams.msgflag?e.content=g.L10001:e.content=g.L10001+" "+m,l.setCurrentState("robot"),s.trigger("core.system",{type:"system",status:"blacklist",data:e}),t&&y()},x=function(e){var i=new RegExp("(^|&)"+e+"=([^&]*)(&|$)","i"),t=window.location.search.substr(1).match(i);return null!=t?unescape(t[2]):null},k=function(e,n,o){var o=!!o,r=e.groupId||"",d=e.tranType||"",m=e.transferFlag||"",y=e.keyword||"",T=e.keywordId||"",I=e.queueFlag||"",k=e.transferType||"",F=e.transferAction||"";u(i,n,!0).then(function(e,n){var u;u=a&&"websocket"==a.type?8:1;var C=i.urlParams,S="/chat-task/marting/chatconnect",L={sysNum:i.sysnum,uid:i.apiInit.uid,chooseAdminId:i.urlParams.aid||"",tranFlag:i.urlParams.tranFlag,way:u,current:v,groupId:r||"",agentid:i.urlParams.agentid,keyword:y||"",keywordId:T||"",queueFlag:I,transferType:k,transferAction:F,summaryParams:i.urlParams.summaryParams,adminHelloWord:i.urlParams.adminHelloWord,robotFlag:i.urlParams.robotid};if(null!=x("queueFirst")&&(L.queueFirst=x("queueFirst")),C.autoManual&&C.aid&&(S="/chat-web/marting/invite",L.aid=C.aid),1==I){var M={answer:"您的消息涉及重点业务，正在为您转接人工客服",answerType:"5",msgId:"",transferType:0,ustatus:-1};s.trigger("core.onreceive",{list:[M],type:"robot"})}c({url:S,type:"post",dataType:"json",data:L,success:function(a){if(i.urlParams.leaveMsgGroupId=r,i.sessionStatus=a.status,1==a.status||"keySwitch"!=d||1!=m||a.count)return a.status==-1?void s.trigger("core.sessionclose",7):void(2==a.status?b(a,o,e):0==a.status||7==a.status?(j(a,o,e,T),i.apiConfig.invalidSessionFlag&&s.trigger("sendArea.senderMsg",{type:0})):1==a.status?(window.parent&&window.postMessage&&"iframe"==i.urlParams.from&&window.parent.postMessage(JSON.stringify({name:"manual",status:"success"}),"*"),v=!1,a.adminHelloWord&&(i.urlParams.adminHelloWord=a.adminHelloWord),i.urlParams.queueDoc=a.queueDoc||"",a.serviceEndPushMsg&&(i.urlParams.serviceEndPushMsg=a.serviceEndPushMsg||""),a.notClear=1===i.apiConfig.invalidSessionFlag,o?(h(e,a,i.urlParams.adminHelloWord),s.trigger("core.transfersuccess",{data:a})):(s.trigger("core.system",{type:"system",status:"transfer",data:{content:g.L10002.replace("{0}",a.aname)}}),s.trigger("core.transfersuccess",{data:a}),a.content=i.urlParams.adminHelloWord,i.apiConfig.adminHelloWordFlag&&s.trigger("core.system",{type:"human",status:"transfer",data:a})),t&&t.destroy(),t=f(a,i),t.start(),l.setCurrentState("human"),s.trigger("core.buttonchange",{type:"transfer",action:"hide"})):3==a.status?(s.trigger("core.sessionclose",7),w(a,o)):a.status==-2?w(a,o):6==a.status?(delete i.urlParams.aid,i.apiConfig.smartRouteInfoFlag=!1,s.trigger("core.grouplist")):8==a.status&&(l.setCurrentState("robot"),t&&t.destroy(),$(".js-sendEvaluate").remove(),t=new p(i)))},fail:function(){}})})},F=function(e,t,a){var a=!!a,t=new n;return d(i,t,v).then(function(e){k(e,null,a)},function(){0==i.apiConfig.smartRouteInfoFlag&&(a=!0),T(a,t)}),t},C=function(e){var t=new n;return d(i,t,v,e).then(function(e){k(e,null,!1)},function(){T(!1,t)}),t},S=function(){F(null,null,!0)},L=function(){},M=function(){s.on("sendArea.artificial",F),s.on("listMsg.keyWordArtificial",C),s.on("listMsg.transTypeArtificial",C),s.on("core.onreceive",I),s.on("sendArea.transfer",S)},A=function(){var e=i.apiInit.ustatus;0==e||1==e||e==-2?F(null,null,!0):e==-11&&2===i.apiConfig.robotFrom&&(l.setCurrentState("robot"),new p(i))},P=function(){L(),M(),A()};P(),this.getWelcome=function(){}};i.exports=a},{"../comm":1,"../socket/robot.js":25,"../socket/rolling.js":26,"../socket/socketfactory.js":27,"../socket/websocket.js":28,"../util/date.js":29,"../util/listener.js":33,"../util/monitAjax.js":35,"../util/promise.js":37,"./currentState.js":12,"./initsession.js":15,"./tdrobot.js":21,"./transfer.js":23}],15:[function(e,i,t){var a,s,n,o=e("../util/promise.js"),r=e("../util/date.js"),l=e("./offlineMessage.js"),c=function(e,i){var i=i||new o;return 0==e.apiInit.ustatus?setTimeout(function(){i.resolve([])},0):$.ajax({type:"post",url:"/chat/user/getChatDetailByCid.action",dataType:"json",data:{cid:e.apiInit.cid,uid:e.apiInit.uid},success:function(e){i.resolve(e)}}),i},d=function(e,i){var i=i||new o;return $.ajax({url:"/chat/msgOffline/queryOfflineMsg.action",dataType:"jsonp",type:"GET",data:{uid:a.apiInit.uid},success:function(t){var a;if(t.length>0){for(var s=0;s<t.length;s++)for(var n=t[s].content||[],o=0;o<n.length;o++){var c=n[o];0==o&&(a=c),l[c.msgId]=!0,c.msgType_2="offline",null===c.senderType&&(c.senderType=2),c.msg||(c.msg="")}var d=a.t?new Date(a.t):new Date;d=new Date(d.getTime()+1e5);var u=r.formatDate(d,!0);e.push({type:"offline-seperator",date:"",content:[{senderType:-1,msg:"",ts:a?a.ts:u,t:a?a.t:+new Date}]})}var n=e.concat(t);i.resolve(n)}}),i},u=function(e,i){var i=i||new o;if(s)return void setTimeout(function(){i.resolve(e)},0);var t;return void 0!==a.urlParams.moduleType&&(t=a.urlParams.moduleType),void 0===t&&(t=a.apiConfig.type),a.urlParams.guideFlag&&1!=a.apiInit.multiFlag&&1!=a.apiInit.ustatus&&2!=t?$.ajax({type:"post",url:"/chat/user/robotGuide.action",dataType:"json",data:{uid:a.apiInit.uid,robotFlag:a.urlParams.robotFlag||"",faqId:a.urlParams.faqid||""},success:function(t){var s=t.data.ts?new Date(t.data.ts):new Date;s=new Date(s.getTime()+1e5);var n=r.formatDate(s,!0),o=t.data.answer||"";o.indexOf("<a")>=0&&(o=o.replace(/<a/g,'<a target="_blank"')),e.push({type:"robot",answerType:"welcome-sugguestions",date:n,content:[{senderName:a.apiConfig.robotName,senderType:3,msg:o,stripe:"",list:t.data.suggestions,ts:n}]}),i.resolve(e)}}):i.resolve(e),i};i.exports=function(i,t,o){return a=i,n=e("../util/monitAjax.js")(a),s=o,c(a).then(d).then(u)}},{"../util/date.js":29,"../util/monitAjax.js":35,"../util/promise.js":37,"./offlineMessage.js":17}],16:[function(e,i,t){function a(i){var t,a,n=e("./humanfirst.js"),o=e("./tdrobot.js"),r=e("./robotfirst.js"),l=e("../comm.js");return t=l.getQueryParam(),a=t.moduleType>=1&&t.moduleType<=4?t.moduleType:i.apiConfig.type,s?s:s=5==i.apiConfig.type||6==i.apiConfig.type?new r(i):1==i.apiConfig.type?new o(i):new n(i)}var s=null;e("../util/errorlog.js");i.exports=a},{"../comm.js":1,"../util/errorlog.js":30,"./humanfirst.js":14,"./robotfirst.js":19,"./tdrobot.js":21}],17:[function(e,i,t){i.exports={}},{}],18:[function(e,i,t){function a(e){var i=0;for(var t in s)s.hasOwnProperty(t)&&i++;if(0!=i)for(var a=0;a<e.length;a++){for(var n=[],o=0;o<e[a].content.length;o++){var r=e[a].content[o];s[r.msgId]?delete s[r.msgId]:n.push(r)}e[a].content=n}}var s=e("./offlineMessage.js");i.exports=a},{"./offlineMessage.js":17}],19:[function(e,i,t){var a=function(i){var t,a,s=e("../util/listener.js"),n=e("../util/promise.js"),o=e("../util/date.js"),r=e("../socket/robot.js"),l=e("./currentState.js"),c=(e("../socket/websocket.js"),e("../socket/rolling.js"),e("./transfer.js")),d=e("./initsession.js"),u=e("./tdrobot.js"),p=e("../util/monitAjax.js")(i),f=e("../socket/socketfactory.js"),m=i.apiConfig.leaveMsg,g=i.language.lan,v=!1,h=(new n,0),y=function(){$transferBtn=$(".temp_test")},T=function(e,t){var t=t||new n;return d(i,t).then(function(e,t){e||(e=[]);var a=new Date;({date:o.formatDate(a),content:[{senderType:1,t:+a,msg:i.urlParams.robotHelloWord,ts:o.formatDate(a,!0),senderFace:i.apiConfig.robotLogo,senderName:i.apiConfig.robotName}]});return setTimeout(function(){
s.trigger("core.initsession",e)},0),t}),t},j=function(e,t){var a=e?t.aface:i.apiConfig.robotLogo,n=e?t.aname:i.apiConfig.robotName,e=e||i.urlParams.robotHelloWord,r=i.apiInit.ustatus==-2?1:0;d(i).then(function(t,l){t||(t=[]);var c=new Date;({date:o.formatDate(c),content:[{senderType:r?1:e?2:1,t:+c,msg:e,ts:o.formatDate(c,!0),senderFace:5==i.apiConfig.type||6==i.apiConfig.type?i.apiConfig.cardPhotos:a,senderName:5==i.apiConfig.type||6==i.apiConfig.type?i.apiConfig.cardNikeName:n}]});return setTimeout(function(){s.trigger("core.initsession",t)},0),l})},I=function(e,t){t?(j(null,e),setTimeout(function(){i.urlParams.msgflag?e.content=i.urlParams.adminNonelineTitle:e.content=i.urlParams.adminNonelineTitle+m,i.apiConfig.adminNoneLineFlag&&s.trigger("core.system",{type:"system",status:"offline",data:e})},1)):(i.urlParams.msgflag?e.content=i.urlParams.adminNonelineTitle:e.content=i.urlParams.adminNonelineTitle+m,i.apiConfig.adminNoneLineFlag&&s.trigger("core.system",{type:"system",status:"offline",data:e})),l.setCurrentState("robot")},b=function(e,n,o){var c=e.queueDoc;v=!0,a||(a=f(e,i),a.start()),t&&t.destroy(),t=new r(i),n?(j(null,e),setTimeout(function(){i.urlParams.msgflag?e.content=c:e.content=c+" "+m,!o&&i.apiConfig.customerQueueFlag&&s.trigger("core.system",{type:"system",status:"queue",data:e})},1)):(i.urlParams.msgflag?e.content=c:e.content=c+" "+m,(!o&&i.apiConfig.customerQueueFlag||1==e.queueFlag||2==e.queueFlag)&&s.trigger("core.system",{type:"system",status:"queue",data:e,flag:!0})),l.setCurrentState("robot")},w=function(e,a){t&&t.destroy(),window.parent&&window.postMessage&&"iframe"==i.urlParams.from&&window.parent.postMessage(JSON.stringify({name:"manual",status:"success"}),"*"),v=!1,window.parent&&window.postMessage&&window.parent.postMessage(JSON.stringify({type:"manual",status:"success"}),"*"),t=f(e,i),t.start(),l.setCurrentState("human"),i.urlParams.queueDoc=e.queueDoc||"",e.serviceEndPushMsg&&(i.urlParams.serviceEndPushMsg=e.serviceEndPushMsg||""),a?(j(i.urlParams.adminHelloWord,e),s.trigger("core.transfersuccess",{data:e})):(s.trigger("core.system",{type:"system",status:"transfer",flag:!0,data:{content:g.L10002.replace("{0}",e.aname)}}),s.trigger("core.transfersuccess",{data:e})),s.trigger("core.buttonchange",{type:"transfer",action:"hide"})},x=function(e,t){e.status==-2?e.content=g.L10048:i.urlParams.msgflag?e.content=g.L10001:e.content=g.L10001+" "+m,s.trigger("core.system",{type:"system",status:"blacklist",data:e}),t&&C()},k=function(e){var i=new RegExp("(^|&)"+e+"=([^&]*)(&|$)","i"),t=window.location.search.substr(1).match(i);return null!=t?unescape(t[2]):null},F=function(e,n){var o;e&&(o=!!e.clickType),c(i,null,v,e).then(function(e,n){var r,c=e.groupId||"",d=e.tranType||"",u=e.transferFlag||"",f=e.keyword||"",m=e.keywordId||"",g=e.queueFlag,y=e.transferAction;r=a&&"websocket"==a.type?8:1;var T=i.urlParams,j="/chat-task/marting/chatconnect",F={sysNum:i.sysnum,uid:i.apiInit.uid,chooseAdminId:i.urlParams.aid||"",tranFlag:i.urlParams.tranFlag,way:r,current:v,groupId:c||"",agentid:i.urlParams.agentid,keyword:f||"",keywordId:m||"",queueFlag:g,transferAction:decodeURIComponent(y),summaryParams:i.urlParams.summaryParams,adminHelloWord:i.urlParams.adminHelloWord};null!=k("queueFirst")&&(F.queueFirst=k("queueFirst")),T.autoManual&&T.aid&&(j="/chat-web/marting/invite",F.aid=T.aid),p({url:j,type:"post",dataType:"json",data:F,success:function(e){if(1==e.status||"keySwitch"!=d||1!=u||e.count||1==e.queueFlag){if(e.status==-1)return void s.trigger("core.sessionclose",7);h++,h>6||(c?i.urlParams.leaveMsgGroupId=c:e.groupId&&(i.urlParams.leaveMsgGroupId=e.groupId),2==e.status?I(e,o):0==e.status?b(e,o,m):1==e.status?w(e,o):3==e.status?(s.trigger("core.sessionclose",7),x(e,o),$(".js-queueing").remove()):e.status==-2?(s.trigger("core.sessionclose",7),x(e,o),$(".js-queueing").remove()):6==e.status?(delete i.urlParams.aid,i.apiConfig.smartRouteInfoFlag=!1,s.trigger("core.grouplist")):7==e.status?(e.content=e.msg,s.trigger("core.system",{type:"system",status:"queue",data:e})):8==e.status&&(l.setCurrentState("robot"),t&&t.destroy(),$(".js-sendEvaluate").remove(),s.trigger("changeSettime")))}},fail:function(){}})},function(){})},C=function(e,a){e||(e=[]);var n=new Date;({date:o.formatDate(n),content:[{senderType:1,t:+n,msg:i.urlParams.robotHelloWord,ts:o.formatDate(n,!0),senderFace:i.apiConfig.robotLogo,senderName:i.apiConfig.robotName}]});setTimeout(function(){s.trigger("core.initsession",e)},0),t=new r(i),l.setCurrentState("robot")},S=function(e){for(var n=e.list||[],o=0,r=n.length;o<r;o++){var c=n[o],d=c;if(200===c.type){t&&a&&(t.destroy(),t=a,a=null),l.setCurrentState("human"),s.trigger("core.system",{type:"system",status:"transfer",data:{content:g.L10002.replace("{0}",d.aname)}}),d.serviceInfo.adminHelloWord&&(i.urlParams.adminHelloWord=d.serviceInfo.adminHelloWord),d.content=i.urlParams.adminHelloWord,i.apiConfig.adminHelloWordFlag&&s.trigger("core.system",{type:"human",data:d}),s.trigger("core.buttonchange",{type:"transfer",action:"hide"});break}}},L=function(){s.on("sendArea.artl.td",F),s.on("core.onreceive",S)},M=function(){s.trigger("core.buttonchange",{type:"transfer",action:"show"});var e=i.apiInit.ustatus;if(0==e)t=new u(i),T(),l.setCurrentState("robot");else if(1==e||e==-2){var a={clickType:!0};F(a)}else e==-11&&2===i.apiConfig.robotFrom&&(l.setCurrentState("robot"),new u(i))},A=function(){t&&t.destroy()},P=function(){y(),L(),M(),s.on("core.clearSocketFactory",A)};P()};i.exports=a},{"../socket/robot.js":25,"../socket/rolling.js":26,"../socket/socketfactory.js":27,"../socket/websocket.js":28,"../util/date.js":29,"../util/listener.js":33,"../util/monitAjax.js":35,"../util/promise.js":37,"./currentState.js":12,"./initsession.js":15,"./tdrobot.js":21,"./transfer.js":23}],20:[function(e,i,t){var a=function(i){var t,a=e("../util/listener.js"),s=e("./template.js"),n=e("../../pc/js/listMsg/template.js"),o=e("./currentState.js"),r=i.language.lan,l=i.language.text,c=[],d=[],u=function(e){var i={};i={text:e};var t=doT.template(s.showTip)(i),a=$(t),n=$(".js-mainBox");n.append(a);var o=n.height()/2-21,r=n.width()/2-70;a.find(".js-showTip").css({top:o,left:r}),setTimeout(function(){a.find(".js-showTip").remove()},3e3)},p=function(e){$("#"+e.dateuid).remove()},f=function(e){t=e},m=function(){try{var e=document.getElementById("chatPanel"),i=$(".js-chatPanel");i.animate({scrollTop:e.scrollHeight},10)}catch(t){return"滚动至底部失败"}},g=function(e){var i=e.dateuid;$("#"+i).find(".sensitiveMsg-refuse").click(function(){var e=$(this).offsetParent();authSensitive(0,function(){e.find(".sensitiveMsg-des").html('<span style="color: #F96569">'+l.T0189+"</span>"),e.find(".sensitiveMsg-refuse").css({display:"none"})})})},v=function(e){var s=e.dateuid;$("#"+s).find(".sensitiveMsg-send").click(function(){var e=$(this).offsetParent(),s=e.attr("id"),n=c.filter(function(e){return e.dateuid==s}),o=d.filter(function(e){return e.dateuid==s});o.length>0&&(o[0].currentStatus=t),1!==i.apiInit.sensitive?authSensitive(1,function(){p(n[0]),a.trigger("core.system",{type:"system",status:"",data:{content:r.L10059}}),i.apiInit.sensitive=1,n[0].holdSocket||y(n[0]),a.trigger("sendArea.send.TdAction",o),n[0].holdSocket&&(o[0].holdSocket=!1,a.trigger("sendArea.send",o))}):(p(n[0]),y(n[0]),a.trigger("sendArea.send.TdAction",o))})};authSensitive=function(e,t){$.ajax({type:"post",url:"/chat-web/user/authSensitive",dataType:"json",timeout:5e3,data:{uid:i.apiInit.uid,type:e},success:function(e){1===e.status?t():u(l.T0190)},error:function(e){}})};var h=function(e){$(".sensitiveMsg-more").click(function(){$("#"+e.dateuid).find(".sensitiveMsg-more").css({display:"none"}),$("#"+e.dateuid).find(".sensitiveMsg-content").addClass("expand")})},y=function(e){var i=doT.template(n.rightMsg)(e);$(".js-chatPanelList").append(i),$("#msgStatus"+e.dateuid).addClass("msgsending")},T=function(e){var t="iframe"==i.urlParams.from,a=t?300:334;p(e);var n=doT.template(s.sensitiveTemplate)(e);$(".js-chatPanelList").append(n),m(),$(".sensitiveMsg-container").css({width:a}),setTimeout(function(){var i=$("#"+e.dateuid).find(".sensitiveMsg-content").height();i>=72&&$("#"+e.dateuid).find(".sensitiveMsg-more").css({display:"block"})},200),v(e),g(e),h(e)},j=function(e){var t={msg:e.conf.msg,dateuid:e.conf.dateuid,des:i.apiConfig.sensitiveExplain,more:l.T0186,send:l.T0187,refuse:l.T0188,holdSocket:e.msgData.holdSocket};c.push(t),d.push(e.msgData),$.ajax({type:"post",url:"/chat-web/user/checkSensitive",dataType:"json",timeout:5e3,data:{uid:i.apiInit.uid,content:t.msg},success:function(i){1===i.status&&i.check?T(t):(a.trigger("sendArea.send.TdAction",[e.msgData]),"human"===o.getCurrentState()&&(e.msgData.holdSocket=!1,e.msgData.isCheckedSensitive=!0,a.trigger("sendArea.send",[e.msgData])))},error:function(e){}})},I=function(){a.on("sendArea.sensitiveMsg",j),a.on("sensitiveMsg.currentStatus",f)};I()};i.exports=a},{"../../pc/js/listMsg/template.js":46,"../util/listener.js":33,"./currentState.js":12,"./template.js":22}],21:[function(e,i,t){var a=function(i){var t,a=e("../../pc/js/listMsg/template.js"),s=e("../util/listener.js"),n=e("./initsession.js"),o=(e("../util/date.js"),i.language.text),r={chat_url:"/chat-msg/task/msg.action",task_url:"/chat-task/marketingSend.action"},l=$(".js-footerOn"),c=$(".js-footerOff");$chatPanelList=$(".js-chatPanelList"),$.ajax({type:"post",url:r.task_url,dataType:"json",data:{uid:i.apiInit.uid,question:i.apiConfig.taskId,robotFlag:i.urlParams.robotFlag,refresh:0},success:function(e){if(i.TaoDian={},i.TaoDian.termList=e.termList,i.TaoDian.nodeId=e.nodeId,e&&e.firstMsg){var d={msg:e.firstMsg,aname:i.apiConfig.cardNikeName,t:new Date,pushInformation:e.pushInformation?JSON.parse(e.pushInformation):{}},u=doT.template(a.leftMsg)(d);$chatPanelList.append(u),setTimeout(function(){f()},100)}var p=function(e,i){e||(e=[]),setTimeout(function(){s.trigger("core.initsession",e)},0)},f=function(){try{var e=document.getElementById("chatPanel");e.scrollTop=e.scrollHeight}catch(i){return"滚动至底部失败"}},m=function(){$.ajax({type:"post",url:r.chat_url,dataType:"json",data:{uid:i.apiInit.uid,puid:i.apiInit.puid},success:function(e){if(e.strategyTransferFlag&(5==i.apiConfig.type||6==i.apiConfig.type))return s.trigger("sendArea.artl.td"),void clearInterval(t);if(2==e.type)if(e.answer)clearInterval(t),$("#js-inputIng").removeClass("inputIngActive"),setTimeout(function(){t=setInterval(m,1e3)},1e3);else{var n=o.T0119;$("#js-inputIng").html(n).addClass("inputIngActive")}else 3==e.type||e.type==-1?(clearInterval(t),l.remove(),c.css("display","block")):$("#js-inputIng").removeClass("inputIngActive");if(""!==e.answer&&null!==e.answer){if(e.pushInformation){var r=JSON.parse(e.pushInformation).message;e.answer=e.answer.replace(r,'<span style="color:#1890FF">'+r+"<span>")}var d={msg:e.answer,aname:i.apiConfig.cardNikeName,pushInformation:e.pushInformation?JSON.parse(e.pushInformation):{},t:new Date,optionList:e.optionList,template:e.template,nodeId:e.nodeId},u=doT.template(a.leftMsg)(d);$chatPanelList.append(u),setTimeout(function(){f()},100)}}})};n(i).then(p),t=setInterval(m,1e3),s.on("changeSettime",function(){t=setInterval(m,1e3)})}}),s.on("sendArea.send.TdAction",function(e){var t=e[0];$.ajax({type:"post",url:"/chat-task/tasksend.action",dataType:"json",data:{uid:i.apiInit.uid,question:t.answer||i.apiConfig.taskId,robotFlag:i.urlParams.robotFlag,nodeId:i.TaoDian.nodeId,refresh:1,clickNodeId:t.nodeId},success:function(e){if(e.answer){var n={msg:e.answer,aname:i.apiConfig.cardNikeName,t:new Date,pushInformation:e.pushInformation?JSON.parse(e.pushInformation):{}},o=doT.template(a.leftMsg)(n);$chatPanelList.append(o),setTimeout(function(){scrollToBottom()},100)}i.TaoDian.nodeId=e.nodeId,s.trigger("core.msgresult",{msgId:t.dateuid,result:"success"})}})});var d=function(){};this.destroy=d};i.exports=a},{"../../pc/js/listMsg/template.js":46,"../util/date.js":29,"../util/listener.js":33,"./initsession.js":15}],22:[function(e,i,t){var a={},s='<div class="shadow-layer js-shadow-layer"><div class="group-outer js-group-outer"><div class="group-title">{{= it.languageText.T0010}}</div><div class="group-main"><ul class="clearfix">{{  for(var i=0;i<it.list.length;i++){ }}{{ var item = it.list[i];}}<li class="js-item" data-id="{{=item.groupId}}">{{=item.recGroupName}}</li>{{  } }}</ul></div><div class="group-footer"><span class="js-cancel-btn cancel">{{=it.languageText.T0000}}</span></div></div></div>',n='<div><div class="group-layer js-group-layer"></div><div class="group-outer js-group-outer"><p class="group-title">{{= it.languageText.T0010}}<span class="close_button js-cancel-btn js-group-cancel"></span></p><div class="group-main"><ul class="clearfix">{{  for(var i=0;i<it.list.length;i++){ }}{{ var item = it.list[i];}}<li class="js-item" data-id="{{=item.groupId}}">{{=item.recGroupName}}</li>{{  } }}</ul></div></div></div>',o='<div class=""><div class="chatBeforeFormlayer js-chatBeforeFormlayer"></div><div id="chatBeforeForm" class="chatBeforeForm js-chatBeforeForm"> <div class="js-chatBeforeFormHeader chatBeforeFormHeader"><p class="title">{{=it.formTitle}}</p><span class="close js-cancel-btn"></span></div><div class="chatBeforeFormBody js-chatBeforeFormBody"><div class="guide">{{=it.formDoc}}</div><div class="definedFields js-definedFields">{{for(var i=0;i<it.definedField.length;i++){}} {{if(it.definedField[i].cusFieldConfig.fieldType==1){}} <div class="definedArea js-definedArea"><p class="title">{{if(it.definedField[i].cusFieldConfig.fillFlag==1){}}<span class="icon">*</span> {{}}}{{=it.definedField[i].cusFieldConfig.fieldName}}</p><input type="text" class="definedInput js-definedInput" data-fieldId="{{=it.definedField[i].cusFieldConfig.fieldId}}"><p class="errorTip js-limitTip{{=it.definedField[i].cusFieldConfig.fieldId}}" style="visibility: inherit;display: none">{{=it.languageText.T0163}}{{=it.definedField[i].cusFieldConfig.fieldName}}</p><p class="errorTip js-errorTip{{=it.definedField[i].cusFieldConfig.fieldId}}">{{=it.languageText.T0108}}{{=it.definedField[i].cusFieldConfig.fieldName}}</p><div style="clear:both"></div></div>{{}else if(it.definedField[i].cusFieldConfig.fieldType==2){}}<div class="definedArea js-definedArea"> <p class="title">{{if(it.definedField[i].cusFieldConfig.fillFlag==1){}}<span class="icon">*</span> {{}}} {{=it.definedField[i].cusFieldConfig.fieldName}}</p><textarea class="definedTextarea js-definedInput" data-fieldId="{{=it.definedField[i].cusFieldConfig.fieldId}}"></textarea><p class="errorTip js-errorTip{{=it.definedField[i].cusFieldConfig.fieldId}}">{{=it.languageText.T0108}}{{=it.definedField[i].cusFieldConfig.fieldName}}</p><div style="clear:both"></div></div>{{}else if(it.definedField[i].cusFieldConfig.fieldType==3){}}<div class="definedArea definedDateArea js-definedArea"><p class="title">{{if(it.definedField[i].cusFieldConfig.fillFlag==1){}}<span class="icon">*</span>{{}}}{{=it.definedField[i].cusFieldConfig.fieldName}}</p><input type="text" class="definedInput js-definedDate" data-fieldId="{{=it.definedField[i].cusFieldConfig.fieldId}}" id="dp{{=it.definedField[i].cusFieldConfig.fieldId}}" readonly="readonly" ><div style="clear:both"></div></div><p class="errorTip js-errorTip{{=it.definedField[i].cusFieldConfig.fieldId}}" style="margin:3px 3%">{{=it.languageText.T0108}}{{=it.definedField[i].cusFieldConfig.fieldName}}</p>{{}else if(it.definedField[i].cusFieldConfig.fieldType==4){}}<div class="definedArea js-definedArea"><p class="title">{{if(it.definedField[i].cusFieldConfig.fillFlag==1){}}<span class="icon">*</span>{{}}}{{=it.definedField[i].cusFieldConfig.fieldName}}</p><div class="definedTimeDropList js-dropdownList" id="hour{{=it.definedField[i].cusFieldConfig.fieldId?it.definedField[i].cusFieldConfig.fieldId:""}}"><div class="js-dropdown-btn"><p class="definedTimeInput js-dropdown-title js-definedHour">00</p><span class="dropListTitleIcn"></span></div><ul class="dropdown-menus js-dropdown-menu zc-scroll">{{for(var j=0;j < 24;j++){}}{{if(j<10){}}<li class="js-dropdownLi dropdownLi" data-fieldId="{{=it.definedField[i].cusFieldConfig.fieldId?it.definedField[i].cusFieldConfig.fieldId:""}}" style="width:60px;">{{="0"+j}}</li>{{}else{}}<li class="js-dropdownLi dropdownLi" data-fieldId="{{=it.definedField[i].cusFieldConfig.fieldId?it.definedField[i].cusFieldConfig.fieldId:""}}" style="width:60px;">{{=j}}</li>{{}}}{{}}}</ul></div><span class="definedTimeText">:</span><div class="definedTimeDropList js-dropdownList" id="minute{{=it.definedField[i].cusFieldConfig.fieldId?it.definedField[i].cusFieldConfig.fieldId:""}}"><div class="js-dropdown-btn"><p class="definedTimeInput js-dropdown-title js-definedMinutes">00</p> <span class="dropListTitleIcn"></span></div><ul class="dropdown-menus js-dropdown-menu zc-scroll">{{for(var j=0;j < 60;j++){}}{{if(j<10){}}<li class="js-dropdownLi dropdownLi" data-fieldId="{{=it.definedField[i].cusFieldConfig.fieldId?it.definedField[i].cusFieldConfig.fieldId:""}}" style="width:60px;">{{="0"+j}}</li>{{}else{}}<li class="js-dropdownLi dropdownLi" data-fieldId="{{=it.definedField[i].cusFieldConfig.fieldId?it.definedField[i].cusFieldConfig.fieldId:""}}" style="width:60px;">{{=j}}</li>{{}}}{{}}} </ul></div><p class="errorTip js-errorTip{{=it.definedField[i].cusFieldConfig.fieldId}}">{{=it.languageText.T0108}}{{=it.definedField[i].cusFieldConfig.fieldName}}</p> <div style="clear:both"></div></div>{{}else if(it.definedField[i].cusFieldConfig.fieldType==5){}}<div class="definedArea js-definedArea"><p class="title">{{=it.definedField[i].cusFieldConfig.fieldName}}{{if(it.definedField[i].cusFieldConfig.fillFlag==1){}}<span class="icon">*</span> {{}}}</p><input class="definedInput js-definedInput js-definedNumInput js-definedNumInput{{=it.definedField[i].cusFieldConfig.fieldId?it.definedField[i].cusFieldConfig.fieldId:""}}" type="number" data-fieldId="{{=it.definedField[i].cusFieldConfig.fieldId?it.definedField[i].cusFieldConfig.fieldId:""}}"><p class="errorTip js-errorTip{{=it.definedField[i].cusFieldConfig.fieldId}}">{{=it.languageText.T0108}}{{=it.definedField[i].cusFieldConfig.fieldName}}</p><div style="clear:both"></div></div>{{}else if(it.definedField[i].cusFieldConfig.fieldType==6){}}<div class="definedArea js-definedArea"><p class="title">{{if(it.definedField[i].cusFieldConfig.fillFlag==1){}}<span class="icon">*</span>{{}}} {{=it.definedField[i].cusFieldConfig.fieldName}}</p><div class="js-dropdownList dropdownList" id="{{=it.definedField[i].cusFieldConfig.fieldId?it.definedField[i].cusFieldConfig.fieldId:""}}"><div class="definedDropList js-dropdown-btn"><p class="definedDropListTitle js-dropdown-title">{{=it.languageText.T0118}}</p><span class="dropListTitleIcn"></span></div><ul class="definedDropListUl js-dropdown-menu zc-scroll">{{for(var j=0;j<it.definedField[i].cusFieldDataInfoList.length;j++){}}<li class="js-dropdownLi" data-fieldId="{{=it.definedField[i].cusFieldConfig.fieldId?it.definedField[i].cusFieldConfig.fieldId:""}}" dataValue="{{=it.definedField[i].cusFieldDataInfoList[j].dataValue}}" fieldType="{{=it.definedField[i].cusFieldDataInfoList[j].fieldType}}" dataName="{{=it.definedField[i].cusFieldDataInfoList[j].dataName}}" title="{{=it.definedField[i].cusFieldDataInfoList[j].dataName}}">{{=it.definedField[i].cusFieldDataInfoList[j].dataName}}<span></span></li>{{}}}</ul><div style="clear:both"></div></div><p class="errorTip js-errorTip{{=it.definedField[i].cusFieldConfig.fieldId}}">{{=it.languageText.T0108}}{{=it.definedField[i].cusFieldConfig.fieldName}}</p><div style="clear:both"></div></div>{{}else if(it.definedField[i].cusFieldConfig.fieldType==7){}}<div class="definedArea js-definedArea"><p class="title">{{if(it.definedField[i].cusFieldConfig.fillFlag==1){}}<span class="icon">*</span>{{}}} {{=it.definedField[i].cusFieldConfig.fieldName}}</p><ul class="definedCheckedUl">{{for(var j=0;j<it.definedField[i].cusFieldDataInfoList.length;j++){}} <li class="definedCheckedLi  js-userCheck {{=it.definedField[i].cusFieldDataInfoList[j].userCheckIcoActive=="userCheckIcoActive"?"":"userCheck"}}" data-fieldId="{{=it.definedField[i].cusFieldConfig.fieldId?it.definedField[i].cusFieldConfig.fieldId:""}}" dataValue="{{=it.definedField[i].cusFieldDataInfoList[j].dataValue?it.definedField[i].cusFieldDataInfoList[j].dataValue:""}}" dataName="{{=it.definedField[i].cusFieldDataInfoList[j].dataName}}"><span class="definedCheckedLiIcn js-userCheckIco{{=it.definedField[i].cusFieldConfig.fieldId?it.definedField[i].cusFieldConfig.fieldId:""}} {{=it.definedField[i].cusFieldDataInfoList[j].userCheckIcoActive=="userCheckIcoActive"?"userCheckIcoActive":""}}"></span><span class="definedCheckedLiText">{{=it.definedField[i].cusFieldDataInfoList[j].dataName}}</span></li>{{}}}</ul><p class="errorTip js-errorTip{{=it.definedField[i].cusFieldConfig.fieldId}}">{{=it.languageText.T0108}}{{=it.definedField[i].cusFieldConfig.fieldName}}</p><div style="clear:both"></div></div>{{}else if(it.definedField[i].cusFieldConfig.fieldType==8){}}<div class="definedArea js-definedArea"><p class="title">{{if(it.definedField[i].cusFieldConfig.fillFlag==1){}}<span class="icon">*</span> {{}}} {{=it.definedField[i].cusFieldConfig.fieldName}}</p><div class="definedOptionUl js-optionArea">{{for(var j=0;j<it.definedField[i].cusFieldDataInfoList.length;j++){}} <div class="js-userOpt definedOptionLi {{=it.definedField[i].cusFieldDataInfoList[j].userOptIcoActive=="userOptIcoActive"?"":"userOpt"}}" data-fieldId="{{=it.definedField[i].cusFieldDataInfoList[j].fieldId?it.definedField[i].cusFieldDataInfoList[j].fieldId:""}}" dataValue="{{=it.definedField[i].cusFieldDataInfoList[j].dataValue?it.definedField[i].cusFieldDataInfoList[j].dataValue:""}}" dataName="{{=it.definedField[i].cusFieldDataInfoList[j].dataName}}"><span class="userOptIco js-userOptIco{{=it.definedField[i].cusFieldDataInfoList[j].fieldId}} {{=it.definedField[i].cusFieldDataInfoList[j].userOptIcoActive=="userOptIcoActive"?it.definedField[i].cusFieldDataInfoList[j].userOptIcoActive:""}}"></span><p class="definedOptionLiText">{{=it.definedField[i].cusFieldDataInfoList[j].dataName}}</p></div>{{}}}</div><p class="errorTip js-errorTip{{=it.definedField[i].cusFieldConfig.fieldId}}">{{=it.languageText.T0108}}{{=it.definedField[i].cusFieldConfig.fieldName}}</p><div style="clear:both"></div></div>{{}else if(it.definedField[i].cusFieldConfig.fieldType==9){}} <div class="definedArea js-definedArea"><p class="title">{{if(it.definedField[i].cusFieldConfig.fillFlag==1){}}<span class="icon">*</span>{{}}}{{=it.definedField[i].cusFieldConfig.fieldName}}</p><div class="js-dropdownList dropdownList" id="province"><div class="cityDropList js-dropdown-btn"><p class="cityDropListTitle js-dropdown-title">{{=it.languageText.T0121}}</p><span class="dropListTitleIcn"></span></div><ul class="cityDropListUl js-provinceDropListUl js-dropdown-menu zc-scroll"></ul><div style="clear:both"></div></div><div class="js-dropdownList dropdownList" id="city"><div class="cityDropList js-dropdown-btn"><p class="cityDropListTitle js-dropdown-title js-cityDropListTitle">{{=it.languageText.T0122}}</p><span class="dropListTitleIcn"></span></div><ul class="cityDropListUl js-cityDropListUl js-dropdown-menu zc-scroll"></ul><div style="clear:both;"></div></div><div class="js-dropdownList dropdownList" id="county"><div class="cityDropList js-dropdown-btn"><p class="cityDropListTitle js-dropdown-title js-countryDropListTitle">{{=it.languageText.T0123}}</p><span class="dropListTitleIcn"></span></div><ul class="cityDropListUl js-countryDropListUl js-dropdown-menu zc-scroll"></ul><div style="clear:both"></div></div><p class="errorTip js-errorTip{{=it.definedField[i].cusFieldConfig.fieldId}}">{{=it.languageText.T0108}}{{=it.definedField[i].cusFieldConfig.fieldName}}</p><div style="clear:both"></div></div>{{}}}{{}}}</div></div><div class="submitArea"><span class="submit js-chatBeforeFormSubmit">{{=it.languageText.T0120}}</span></div></div></div>',r='<div><div class="chatFormLayer js-chatFormLayer"><div class="chatBeforeForm"><div class="header"><p class="title">{{=it.formTitle}}</p><span class="closeForm js-closeForm">×</span></div><div class="chatBeforeForm-content js-chatBeforeForm-content"><div class="wrap-helper js-wrap-helper"><div class="js-helper helper"><div><p><span>{{=it.formDoc}}</span></p></div></div></div><div class="definedAreas">{{for(var i=0;i<it.items.length;i++){}}{{if(it.items[i].cusFieldConfig.fieldType==1){}} <div class="definedArea js-definedArea"><p class="title">{{=it.items[i].cusFieldConfig.fieldName}}{{if(it.items[i].cusFieldConfig.fillFlag==1){}}<span class="icon">*</span>{{}}}</p><input type="text" class="definedInput js-definedInput" fieldId="{{=it.items[i].cusFieldConfig.fieldId}}"></div>{{}else if(it.items[i].cusFieldConfig.fieldType==2){}} <div class="definedArea js-definedArea"><p class="title" style="height:80px">{{=it.items[i].cusFieldConfig.fieldName}}{{if(it.items[i].cusFieldConfig.fillFlag==1){}}<span class="icon">*</span>{{}}}</p><textarea class="definedTextarea js-definedInput" fieldId="{{=it.items[i].cusFieldConfig.fieldId}}"></textarea></div>{{}else if(it.items[i].cusFieldConfig.fieldType==3){}} <div class="definedArea js-definedArea"><p class="title">{{=it.items[i].cusFieldConfig.fieldName}}{{if(it.items[i].cusFieldConfig.fillFlag==1){}}<span class="icon">*</span>{{}}}</p><div class="definedDateArea js-definedDateArea"><input type="text" class="definedDate js-definedDate" placeholder="{{=it.languageText.T0127}}xxxx-xx-xx" fieldId="{{=it.items[i].cusFieldConfig.fieldId}}"></div></div>{{}else if(it.items[i].cusFieldConfig.fieldType==4){}} <div class="definedArea js-definedArea"><p class="title" style="width:18%">{{=it.items[i].cusFieldConfig.fieldName}}{{if(it.items[i].cusFieldConfig.fillFlag==1){}}<span class="icon">*</span>{{}}}</p><div class="definedTimeArea"><input type="text" readonly="readonly" value="00" date-type="hour" class="definedTimeDropList js-definedTimeDropList js-definedHour"><span  class="definedTimeText">{{=it.languageText.T0115}} <span class="definedTimeIcn"></span> |</span><input type="text" readonly="readonly" value="00" date-type="minutes" class="definedTimeDropList js-definedTimeDropList js-definedMinutes"><span  class="definedTimeText">{{=it.languageText.T0116}} <span class="definedTimeIcn"></span></span><div class="dropListArea js-dropListArea js-dropListHour"><p class="dropListAreaTitle"><span class="titleText">{{=it.languageText.T0114}}</span><span class="close js-dropLIstAreaClose">{{=it.languageText.T0111}}</span></p><ul class="definedTimeDropListUl">{{for(var j=0;j<24;j++){}} {{if(j<10){}}<li class="js-definedTimeLi js-dropLIstAreaClose" date-type="hour" dataValue="{{="0"+j}}" fieldId="{{=it.items[i].cusFieldConfig.fieldId}}">{{="0"+j}}<span></span></li>{{}else{}}<li class="js-definedTimeLi js-dropLIstAreaClose" date-type="hour" dataValue="{{=j}}" fieldId="{{=it.items[i].cusFieldConfig.fieldId}}">{{=j}}<span></span></li>{{}}}{{}}}</ul></div><div class="dropListArea js-dropListArea js-dropListMinutes"><p class="dropListAreaTitle"><span class="titleText">{{=it.languageText.T0113}}</span><span class="close js-dropLIstAreaClose">{{=it.languageText.T0111}}</span></p><ul class="definedTimeDropListUl">{{for(var j=0;j<60;j++){}} {{if(j<10){}}<li class="js-definedTimeLi js-dropLIstAreaClose" date-type="minutes" dataValue="{{="0"+j}}" fieldId="{{=it.items[i].cusFieldConfig.fieldId}}">{{="0"+j}}<span></span></li>{{}else{}}<li class="js-definedTimeLi js-dropLIstAreaClose" date-type="minutes" dataValue="{{=j}}" fieldId="{{=it.items[i].cusFieldConfig.fieldId}}">{{=j}}<span></span></li>{{}}}{{}}}</ul></div></div></div>{{}else if(it.items[i].cusFieldConfig.fieldType==5){}} <div class="definedArea js-definedArea"><p class="title">{{=it.items[i].cusFieldConfig.fieldName}}{{if(it.items[i].cusFieldConfig.fillFlag==1){}}<span class="icon">*</span>{{}}}</p><input class="definedInput js-definedInput" type="number" oninput="if(value.length>300)value=value.slice(0,300)"  fieldId="{{=it.items[i].cusFieldConfig.fieldId}}"></div>{{}else if(it.items[i].cusFieldConfig.fieldType==6){}} <div class="definedArea js-definedArea"><p class="title">{{=it.items[i].cusFieldConfig.fieldName}}{{if(it.items[i].cusFieldConfig.fillFlag==1){}}<span class="icon">*</span>{{}}}</p><div class="definedDropList js-definedDropList"><p class="definedDropListText js-definedDropListText"></p><span class="definedDropListTextIcn"></span></div><div class="dropListArea js-dropListArea"><p class="dropListAreaTitle"><span class="titleText">{{=it.items[i].cusFieldConfig.fieldName}}</span><span class="close js-dropLIstAreaClose">{{=it.languageText.T0111}}</span></p><div class="definedDropListUlWidely"><ul class="definedDropListUl">{{for(var j=0;j<it.items[i].cusFieldDataInfoList.length;j++){}}<li class="js-definedDropListLi js-dropLIstAreaClose" fieldId="{{=it.items[i].cusFieldConfig.fieldId}}" dataValue="{{=it.items[i].cusFieldDataInfoList[j].dataValue}}" dataName="{{=it.items[i].cusFieldDataInfoList[j].dataName}}"><span class="definedDropListLiText">{{=it.items[i].cusFieldDataInfoList[j].dataName}}</span><span class="icn"></span></li>{{}}}</ul></div></div></div>{{}else if(it.items[i].cusFieldConfig.fieldType==7){}} <div class="definedArea js-definedArea"><p class="title">{{=it.items[i].cusFieldConfig.fieldName}}{{if(it.items[i].cusFieldConfig.fillFlag==1){}}<span class="icon">*</span>{{}}}</p><div class="definedDropList js-definedDropList"><p class="definedDropListText js-definedDropListText"></p><span class="definedDropListTextIcn"></span></div><div class="dropListArea js-dropListArea"><p class="dropListAreaTitle"><span class="titleText">{{=it.items[i].cusFieldConfig.fieldName}}</span><span class="close js-dropLIstAreaClose">{{=it.languageText.T0111}}</span></p><div class="definedCheckedUlWidely zc-scroll"><ul class="definedCheckedUl">{{for(var j=0;j<it.items[i].cusFieldDataInfoList.length;j++){}}<li class="definedCheckedLi js-definedCheckedLi" fieldId="{{=it.items[i].cusFieldConfig.fieldId}}" dataValue="{{=it.items[i].cusFieldDataInfoList[j].dataValue}}" dataName="{{=it.items[i].cusFieldDataInfoList[j].dataName}}"><span class="definedCheckedLiText">{{=it.items[i].cusFieldDataInfoList[j].dataName}}</span><span class="icn"></span></li>{{}}}</ul></div><p class="checkedSure js-checkedSure" fieldId="{{=it.items[i].cusFieldConfig.fieldId}}">{{=it.languageText.T0001}}</p></div></div>{{}else if(it.items[i].cusFieldConfig.fieldType==8){}} <div class="definedArea js-definedArea"><p class="title">{{=it.items[i].cusFieldConfig.fieldName}}{{if(it.items[i].cusFieldConfig.fillFlag==1){}}<span class="icon">*</span>{{}}}</p><div class="definedDropList js-definedDropList"><p class="definedDropListText js-definedDropListText"></p><span class="definedDropListTextIcn"></span></div><div class="dropListArea js-dropListArea"><p class="dropListAreaTitle"><span class="titleText">{{=it.items[i].cusFieldConfig.fieldName}}</span><span class="close js-dropLIstAreaClose">{{=it.languageText.T0111}}</span></p><div class="definedDropListUlWidely"><ul class="definedDropListUl">{{for(var j=0;j<it.items[i].cusFieldDataInfoList.length;j++){}}<li class="js-definedDropListLi js-dropLIstAreaClose" fieldId="{{=it.items[i].cusFieldConfig.fieldId}}" dataValue="{{=it.items[i].cusFieldDataInfoList[j].dataValue}}" dataName="{{=it.items[i].cusFieldDataInfoList[j].dataName}}"><span class="definedDropListLiText">{{=it.items[i].cusFieldDataInfoList[j].dataName}}</span><span class="icn"></span></li>{{}}}</ul></div></div></div>{{}else if(it.items[i].cusFieldConfig.fieldType==9){}}<div class="cityArea "><p class="text">{{=it.items[i].cusFieldConfig.fieldName}}{{if(it.items[i].cusFieldConfig.fillFlag==1){}}<span class="icon">*</span>{{}}}</p><p class="cityAreaTitle js-cityAreaTitle"></p><span class="classIfyIcn"></span><div class="cityAreaLayer js-orderClassifyLayer"><div class="cityAreaInner js-orderClassifyInner"><div class="titleArea"><span class="title js-cityTitle">{{=it.languageText.T0121}}</span><span class="close js-orderClassifyClose">{{=it.languageText.T0111}}</span></div><div class="areaListArea js-areaListArea"></div></div></div></div>{{}}}{{}}}</div><div class="chatBeforeFormCommitWidely"><p class="chatBeforeFormCommit js-chatBeforeFormCommit">{{=it.languageText.T0120}}</p></div></div><div class="definedLayer js-definedLayer"></div></div></div>',l='<div class="cityList"><div class="questionList js-firstQuestionList">{{ for(var i=0;i<it.items.length;i++){ }}{{if(it.items[i].provinceId){}}<p class="js-provinceList" provinceId="{{=it.items[i].provinceId}}" provinceName="{{=it.items[i].provinceName}}" endFlag="{{=it.items[i].endFlag}}">{{=it.items[i].provinceName}}{{if(!it.items[i].endFlag){}}<span class="firstIcon"></span>{{}}}<span class="sureActive"></span></p>{{}}}{{ } }}</div></div>',c='<div class="cityList"><div class="questionList js-firstQuestionList">{{ for(var i=0;i<it.items.length;i++){ }}{{if(it.items[i].cityId){}}<p class="js-provinceList" cityId="{{=it.items[i].cityId}}" cityName="{{=it.items[i].cityName}}" endFlag="{{=it.items[i].endFlag}}">{{=it.items[i].cityName}}{{if(!it.items[i].endFlag){}}<span class="firstIcon"></span>{{}}}<span class="sureActive"></span></p>{{}}}{{ } }}</div></div>',d='<div class="cityList"><div class="questionList js-firstQuestionList">{{ for(var i=0;i<it.items.length;i++){ }}{{if(it.items[i].areaId){}}<p class="js-provinceList" areaId="{{=it.items[i].areaId}}" areaName="{{=it.items[i].areaName}}">{{=it.items[i].areaName}}<span class="sureActive"></span></p>{{}}}{{ } }}</div></div>',u='{{for(var i=0;i<it.list.length;i++){}}<li class="js-cityLi" provinceId="{{=it.list[i].provinceId}}" title="{{=it.list[i].provinceName}}">{{=it.list[i].provinceName}}</li>{{}}}',p='{{for(var i=0;i<it.list.length;i++){}}<li class="js-cityLi" cityId="{{=it.list[i].cityId}}" title="{{=it.list[i].cityName}}">{{=it.list[i].cityName}}</li>{{}}}',f='{{for(var i=0;i<it.list.length;i++){}}<li class="js-cityLi" areaId="{{=it.list[i].areaId}}" title="{{=it.list[i].areaName}}">{{=it.list[i].areaName}}</li>{{}}}',m='<div><div class="js-showTip showTip"><p class="showTipText">{{=it.text}}</p></div></div>',g='<div class="authorization"><div class="authorization-container"><div class="authorization-title">{{=it.title}}</div><div class="authorization-content"></div><div class="authorization-footer"><div class="authorization-footer-checkbox"> <input type="checkbox" id="authorization-cbx"/><span class="checkbox"></span><span class="checkbox-text">{{=it.checkboxText}}</span></div><div class="authorization-footer-btn">{{=it.btnText}}</div></div></div></div>',v='<li class="clearfix magBox rightMsg" id="{{=it.dateuid||""}}" creattime="{{=it.t||""}}"><div class="sensitiveMsg-container"><div class="sensitiveMsg"><div class="sensitiveMsg-content">{{=it.msg||""}}<div class="sensitiveMsg-more">{{=it.more||""}}</div></div><div class="sensitiveMsg-des">{{=it.des||""}}</div><div class="sensitiveMsg-footer"><div class="sensitiveMsg-btn sensitiveMsg-send" title="{{=it.send||""}}" dateuid="{{=it.dateuid||""}}">{{=it.send||""}}</div><div class="sensitiveMsg-btn sensitiveMsg-refuse" dateuid="{{=it.dateuid||""}}">{{=it.refuse||""}}</div></div></div></div></li>';
a.groupTemplate=s,a.groupTemplatePC=n,a.provinceEle=u,a.cityEle=p,a.countryEle=f,a.chatBeforeFormPc=o,a.chatBeforeFormH5=r,a.provinceEleH5=l,a.cityListEleH5=c,a.areaListEleH5=d,a.showTip=m,a.privacyTemplate=g,a.sensitiveTemplate=v,i.exports=a},{}],23:[function(e,i,t){function a(i,t,a,s){var n=(e("../util/listener.js"),e("../util/promise.js"));t=t||new n;var o=(e("./template.js"),i.language.lan,i.language.text,e("./chatGroups.js"),e("./chatBeforeForm.js"),e("../util/monitAjax.js")(i)),r=function(e,i,t,a){var s;s=a&&"keySwitch"===a.switchType?"":e.urlParams.groupId||"";var n=e.urlParams.transferAction||"",r=e.urlParams,l={global:e,groupId:s,transferType:a&&a.transferType?a.transferType:"",queueFlag:a&&a.queueFlag?a.queueFlag:"",transferFlag:a&&a.transferFlag?a.transferFlag:"",transferAction:n},c=a?a.switchType:"",d=a?a.groupId:"",u=a?a.transferFlag:"",p=a?a.keyword:"",f=a?a.keywordId:"";if(queueFlag=a?a.queueFlag:"","transferType"==c&&(l.tranType="transferType",l.transferFlag=u),"keySwitch"==c)if(s){if(1==queueFlag){var m={global:e,groupId:"",tranType:c,transferFlag:u,keyword:p,keywordId:f,queueFlag:queueFlag,transferAction:n};setTimeout(function(){i.resolve(m)},0)}}else{var m={global:e,groupId:d,tranType:c,transferFlag:u,keyword:p,keywordId:f,queueFlag:queueFlag,switchTypeStyle:a.switchTypeStyle,transferAction:n};setTimeout(function(){i.resolve(m)},0)}else r.aid&&"number"==typeof r.tranFlag?setTimeout(function(){i.resolve(l)},0):r.autoManual&&r.aid?setTimeout(function(){i.resolve(l)},0):0!==e.apiInit.ustatus&&e.apiInit.ustatus!==-1?setTimeout(function(){i.resolve(l)},0):t?setTimeout(function(){i.resolve(l)},0):0===e.apiConfig.groupflag?setTimeout(function(){i.resolve(l)},0):"keySwitch"!=c&&e.urlParams.groupId&&e.urlParams.groupId.length?setTimeout(function(){i.resolve(l)},0):e.apiConfig.smartRouteInfoFlag?setTimeout(function(){i.resolve(l)},0):o({url:"/chat/user/getGroupList.action",dataType:"json",type:"get",data:{companyId:e.apiInit.pid,source:e.userInfo.source,channelFlag:e.urlParams.channelFlag||""},success:function(e){if(1==e.length){var t=e[0];l.global.urlParams.groupId=t.groupId,l.groupId=t.groupId,i.resolve(l)}else 0==e.length?i.resolve(l):(l.groupList=e,i.resolve(l))},fail:function(){}});return i};return r(i,t,a,s).then(function(e){t.resolve(e)},function(e){e.reject(e)}),t}i.exports=a},{"../util/listener.js":33,"../util/monitAjax.js":35,"../util/promise.js":37,"./chatBeforeForm.js":10,"./chatGroups.js":11,"./template.js":22}],24:[function(e,i,t){function a(i){var t,t,a=2e4,r=3e3,l=e("../util/monitAjax.js")(i);s.on("core.sessionclose",function(e){e!==-2&&e!==-3&&clearInterval(t)});var c=function(){l({url:"/chat/user/msgt.action",type:"post",dataType:"json",data:{uid:i.apiInit.uid,pid:i.apiInit.pid},success:function(e){e&&0==e.ustatus&&"human"==n.getCurrentState()&&s.trigger("core.sessionclose",4);var i=o.isReady();if(i){var t="rolling"===o().getType()?1:8;t!==e.way&&(s.trigger("core.sessionclose",4),window.localStorage.setItem("websocketerror",+new Date),window.location.reload(!0))}},error:function(e){var i=new Image;i.src="images/static/errorlog.png?t="+ +new Date+"&response="+encodeURIComponent(e.response)+"&status="+e.status+"&statusText="+encodeURIComponent(e.statusText)+"&timeout="+e.timeout+"&from=heartbeat_user"}})};setTimeout(function(){c(),t=setInterval(c,a)},r)}var s=e("../util/listener.js"),n=e("../mode/currentState.js"),o=e("./socketfactory.js");i.exports=a},{"../mode/currentState.js":12,"../util/listener.js":33,"../util/monitAjax.js":35,"./socketfactory.js":27}],25:[function(e,i,t){function a(i){var t=e("../util/listener.js"),a="robot",s=!1,n=e("../util/monitAjax.js")(i),o=e("../util/errorlog.js"),r=i.language.lan,l=function(){},c=function(e){return e.uid+""+e.date},d=function(e){var l=e[0];if(!l.leaveMsg&&"robot"===l.currentStatus){var d=(c(l),l.answer.replace(/(^\s+|\s+$)/g,""));/^\d+$/.test(d)||(s=!1),"question"==l.requestType&&(s=!0),l.answer||o.specialError("question_blank","common_robot",l,i),n({url:"/chat/user/robotsend.action",data:"type",data:{requestText:("string"==typeof l.requestText?l.requestText:JSON.stringify(l.requestText))||l.answer||"",question:("object"==typeof l.multiDiaQuestion?JSON.stringify(l.multiDiaQuestion):l.multiDiaQuestion)||l.answer,sysNum:i.sysNum,uid:i.apiInit.uid,cid:i.apiInit.cid,source:i.userInfo.source,questionFlag:2===l.questionFlag?l.questionFlag:s?1:0,lanFlag:i.urlParams.lanFlag||0,robotFlag:i.urlParams.robotFlag||""},type:"post",success:function(e){var i="object"==typeof e?e:JSON.parse(e);if(4==i.answerType&&(s=!0),t.trigger("core.onreceive",{list:[i],type:a}),t.trigger("core.msgresult",{msgId:l.dateuid,result:"success"}),i.keyword)t.trigger("core.keySwitchAdmin",i);else if(1==i.transferType||2==i.transferType||5==i.transferType){var n={answer:r.L10056,answerType:"5",msgId:"",transferType:0,ustatus:-1};t.trigger("core.onreceive",{list:[n],type:a}),t.trigger("core.transTypeSwitchAdmin",i)}0===i.ustatus&&t.trigger("core.sessionclose",8)},error:function(e){t.trigger("core.msgresult",{msgId:l.dateuid,result:"fail"})}}),s=!1}},u=function(){t.off("sendArea.send",d),t.off("sendArea.sendSugguestions",d),t.off("multiConv.send",d)},p=function(){t.on("sendArea.send",d),t.on("sendArea.sendSugguestions",d),t.on("multiConv.send",d)},f=function(){l(),p()};this.destroy=u,f()}i.exports=a},{"../util/errorlog.js":30,"../util/listener.js":33,"../util/monitAjax.js":35}],26:[function(e,i,t){function a(i,t,a){this.puid=i;var n,o=e("../util/listener.js"),r=e("../util/monitAjax.js")(a),l=e("../util/errorlog.js"),c="human",d=0,u={},p=(a.language.lan,this),f=function(e,t){var t=t||0,a=e[0];if("human"===a.currentStatus){a.date?a.ts=a.date:a.ts=+new Date;var s={};s=24==a.msgType?{puid:i,cid:a.cid,uid:a.uid,msgType:a.msgType,content:a.miniPage,clickNodeId:a.nodeId}:{puid:i,cid:a.cid,uid:a.uid,content:a.answer,clickNodeId:a.nodeIds},r({url:"/chat/user/chatsend.action",data:s,dataType:"json",type:"POST",success:function(e){o.trigger("core.msgresult",{msgId:a.dateuid,result:"success"})},error:function(e){t>=3?o.trigger("core.msgresult",{msgId:a.dateuid,result:"fail"}):setTimeout(function(){f([a],t+1)},1e3)}})}},m=function(){clearInterval(n)},g=function(e){for(var i=[],t=0,a=e.length;t<a;t++){var s=e[t],n={type:300,utype:d,cid:s.cid,uid:s.uid,msgId:s.msgId};i.push(n)}i.length<=0||!JSON.stringify||r({url:"/chat/user/msg/ack.action",dataType:"json",data:{content:JSON.stringify(i),tnk:+new Date},type:"POST"})},v=function(){r({url:"/chat/user/msg.action",dataType:"json",data:{puid:i,uid:a.apiInit.uid,token:+new Date},type:"get",success:function(e){if(e&&e.length)try{for(var i=[],t=[],s=0;s<e.length;s++){var n=JSON.parse(e[s]);if(n.msgId||(n.msgId=+new Date+Math.random().toString(36).substr(2)+n.type),!u[n.msgId])if(u[n.msgId]=!0,i.push(n),202===n.type&&t.push(n),204===n.type){var r=a.urlParams.serviceEndPushMsg.replace("#客服#",n.aname);if(o.trigger("core.sessionclose",n.status),2==n.status||4==n.status)a.apiConfig.serviceEndPushFlag&&o.trigger("core.system",{type:"system",status:"kickout",data:{content:r}});else if(5==n.status){var d="温馨提示：请提高警惕，谨防被骗！不要轻信转账、付款二维码等信息！";o.trigger("core.system",{type:"system",status:"kickout",data:{content:d}})}}else 212==n.type?o.trigger("core.system",{type:"system",status:"",data:{content:n.content}}):215==n.type&&o.trigger("core.system",{type:"overTimeTips",status:"",data:{content:n.content,sysType:n.sysType}})}window.parent&&"iframe"===a.urlParams.from&&t.length>0&&window.postMessage&&window.parent.postMessage(JSON.stringify({name:"zhichiReceive",data:t}),"*"),g(i),o.trigger("core.onreceive",{type:c,list:i})}catch(p){l.runtimeError(p,"onreceive.rolling",{type:c,list:i},a)}},error:function(e,i){var t=new Image;t.src="images/static/errorlog.png?t="+ +new Date+"&e="+encodeURIComponent(i)+"&reponse="+e.responseText+"&uid="+a.apiInit.uid}})},h=function(){o.on("sendArea.send",f),o.on("multiConv.send",f),o.on("sendArea.sendSugguestions",f)},y=function(){setInterval(v,1500),s(a)},T=function(){h(),y()};T(),this.getType=function(){return p.type},this.type="rolling",this.destroy=m,this.start=v}var s=e("./heartbeat.js");i.exports=a},{"../util/errorlog.js":30,"../util/listener.js":33,"../util/monitAjax.js":35,"./heartbeat.js":24}],27:[function(e,i,t){var a=null,s=3e5,n=!1,o=function(i,t){if(a)return a;var o=+new Date;try{var r=e("../socket/websocket.js"),l=e("../socket/rolling.js");window.localStorage&&(o=+window.localStorage.getItem("websocketerror"));var c=!0;o&&(c=+new Date-o>s);var d=i["wslink.bak"];d.push(i["wslink.default"]);var u=i["wslink.default"];a=window.WebSocket&&c&&(u.indexOf("ws:")>=0||u.indexOf("wss:")>=0)?new r(i.puid,d,u,t):new l(i.puid,i["wslink.default"],t)}catch(p){a=new l(i.puid,i["wslink.default"],t)}return n=!0,a};o.isReady=function(){return n},i.exports=o},{"../socket/rolling.js":26,"../socket/websocket.js":28}],28:[function(e,i,t){function a(i,t,a,n){this.puid=i;var o,r,l,c=(Math.floor(Math.random()*t.length),"human"),d={},u=e("../util/listener.js"),p=e("../util/errorlog.js"),f=e("../util/date.js"),m=15e3,g=n.language.lan,v=this;this.channelId=Math.random().toString(32).substr(2);var h=!1,y=0,T=0,j=0,I=(new Date,5e3),b=0,w={},x=function(){var e=+new Date;for(var i in w){var t=w[i];e-t.sendTime>=I&&(delete w[i],u.trigger("core.msgresult",{msgId:t.dateuid,result:"fail"}))}},k=function(e){var i=e;if(Object.prototype.toString.call(e).indexOf("Array")>=0&&(i=e[0]),"human"===i.currentStatus&&(0!=n.apiInit.sensitive||!i.holdSocket)){var t=i.date?new Date(i.date):new Date;i.t=+t,i.ts=f.formatDate(t,!0),i.type=103,i.msgId=i.dateuid,i.sendTime=i.date,i.channelId=v.channelId,i.content=i.answer,i.clickNodeId=i.nodeId,i.uname=n.apiInit.uname;var a=$("<div></div>");a.text(i.uname),i.uname=a.html(),i.face=n.userInfo.face,w[i.msgId]=i,T++;try{o.send(JSON.stringify(i))}catch(s){if(window.location.reload(!0),window.localStorage)try{window.localStorage.setItem("websocketerror",+new Date)}catch(s){}A(),alert(g.L10043)}}},F=function(e){u.trigger("core.msgresult",{msgId:e.msgId,result:"success"}),delete w[e.msgId]},C=function(e){u.trigger("core.onreceive",{type:c,list:[e]})},S=function(e){var i=n.urlParams.serviceEndPushMsg.replace("#客服#",e.aname);if(204==e.type){if(u.trigger("core.sessionclose",e.status),h=e.status%2==0,o.close(),2==e.status||4==e.status)u.trigger("core.system",{type:"system",status:"kickout",data:{content:i}});else if(5==e.status){var t="温馨提示：请提高警惕，谨防被骗！不要轻信转账、付款二维码等信息！";u.trigger("core.system",{type:"system",status:"kickout",data:{content:t}})}}else 212==e.type?u.trigger("core.system",{type:"system",status:"",data:{content:e.content}}):215==e.type&&u.trigger("core.system",{type:"overTimeTips",status:"",data:{content:e.content,sysType:e.sysType}});u.trigger("core.onreceive",{type:c,list:[e]})},L=function(e){if(301!=e.type){var i={type:300,msgId:e.msgId,utype:b,data:[e],channelId:v.channelId};try{o.send(JSON.stringify(i))}catch(t){}}},M=function(e){if("pong"===e.data)return clearTimeout(l),void(l=setTimeout(function(){o.close()},m));j++;var i=JSON.parse(e.data);if(!d[i.msgId+"_"+i.type]){var t=[];202===i.type&&t.push(i),window.top&&"iframe"===n.urlParams.from&&t.length>0&&window.top.postMessage(JSON.stringify({name:"zhichiReceive",data:t}),"*"),L(i),i.msgId||(i.msgId=+new Date+Math.random().toString(36).substr(2)+i.type),d[i.msgId+"_"+i.type]=i;try{301==i.type?F(i):202==i.type?C(i):S(i)}catch(a){p.runtimeError(a,"receive.websocket",i,n)}}},A=function(){if(y++>=3){var e=g.L10003.replace("{0}","");return u.trigger("core.system",{type:"system",status:"kickout",data:{content:e}}),void u.trigger("core.sessionclose",-4)}setTimeout(function(){Math.floor(Math.random()*t.length);o=new WebSocket(a),o.onerror=N,o.onopen=D,o.onclose=_,o.onmessage=M},5e3)},P=function(e){if(window.localStorage&&!h)try{window.localStorage.setItem("websocketerror",+new Date)}catch(e){p.runtimeError(e,"localStorage error",data,n)}h||A()},D=function(){r=setInterval(function(){o.send("ping")},5e3),window.localStorage&&window.localStorage.removeItem("websocketerror");var e={t:b,u:n.apiInit.uid,puid:i,s:n.sysnum,ts:+new Date},t=0;for(var a in w)t++;y=0,o.send(JSON.stringify(e));for(var a in w){var s=w[a];o.send(JSON.stringify(s))}setInterval(x,1e3)},_=function(e){P(e),clearTimeout(r)},N=function(e){},R=function(){o.onerror=N,o.onopen=D,o.onclose=_,o.onmessage=M,u.on("sendArea.send",k),u.on("sendArea.sendSugguestions",k)},O=function(){R()},B=function(){o&&(o.close(),clearTimeout(r))},z=function(){o=new WebSocket(a),O(),s(n)},E=function(){};this.getType=function(){return v.type},this.type="websocket",this.destroy=B,this.start=z,this.stop=E}var s=e("./heartbeat.js");i.exports=a},{"../util/date.js":29,"../util/errorlog.js":30,"../util/listener.js":33,"./heartbeat.js":24}],29:[function(e,i,t){var a={},s=function(e){return e>=10?e+"":"0"+e},n=function(e){var i=s,t=e.getHours(),a=e.getMinutes(),n=e.getSeconds(),o=[i(t),i(a),i(n)];return o.join(":")},o=function(e,i){var t=s,a=e.getFullYear(),o=e.getMonth()+1,r=e.getDate(),l=[t(a),t(o),t(r)],c=e.getHours(),d=e.getMinutes(),u=e.getSeconds();[t(c),t(d),t(u)];return l.join("-")+(i?" "+n(e):"")};a.formatTime=n,a.formatDate=o,i.exports=a},{}],30:[function(e,i,t){var a,s={},n=e("../config/config.json"),o=e("../lib/detect.js"),r=encodeURIComponent,l=/Mobile/.test(window.navigator.userAgent)?"wap":"pc",c=function(e,i,t,s){var o=new Image,c="error="+r(e.toString());c+="&stack="+r(e.stack),c+="&from="+i,c+="&os="+a.os.family,c+="&osVersion="+a.os.version,c+="&browser="+a.browser.family,c+="&browserVersion="+a.browser.version,c+="&type="+l,c+="&uid="+s.apiInit.uid,c+="&data="+r(JSON.stringify(t)),c+="&pid="+s.apiInit.pid,o.src="//"+n.errorlogPath+"runtime?"+c},d=function(e,i,t,a){return},u=function(e,i,t,a,s,n){return},p=function(e,i,t,a,s){return};!function(){var e=window.navigator.userAgent;a=o.parse(e)}(),s.networkError=p,s.runtimeError=c,s.overTimeError=u,s.specialError=d,s.init=function(){},s.getFlag=function(){return!1},i.exports=s},{"../config/config.json":2,"../lib/detect.js":5}],31:[function(e,i,t){function a(e,i){var i=i||0;if("object"!=typeof e)throw"not a json";var t=Object.prototype.toString.call(e),s="";if(/Array/.test(t)){s="[";for(var n=[],o=0;o<e.length;o++){var r=e[o];if("object"==typeof r)try{n.push(a(r,i))}catch(l){continue}else n.push(r.toString())}return s+n.join(", ")+"]"}if(/Object/.test(t)){var c,d="",u="",n=[];s="{";var p=0;for(var f in e)if(e.hasOwnProperty(f)){if("number"==typeof e[f])c="",p>0&&(c+=","),c+='"'+f+'":'+e[f],n.push(c);else if("boolean"==typeof e[f])c="",p>0&&(c+=","),c+='"'+f+'":'+e[f],n.push(c);else if("string"==typeof e[f])c="",p>0&&(c+=","),c+='"'+f+'":"'+e[f]+'"',n.push(c);else if("object"==typeof e[f]){c="";try{p>0&&(c+=","),c+='"'+f+'":'+a(e[f],i+1),n.push(c)}catch(l){continue}}p++}return s+=n.join(""+d)+""+u+"}"}throw"not a json"}i.exports=a},{}],32:[function(require,module,exports){function init(){var parse=function(str){var obj;try{obj=eval("("+str+")")}catch(e){}return obj},stringify=function(e){if(e){var i=formatJSON(e,0);return i}return""};window.JSON||(window.JSON={parse:parse,stringify:stringify})}var formatJSON=require("./formatJSON.js");module.exports=init},{"./formatJSON.js":31}],33:[function(e,i,t){var a={},s={},n=function(e,i){if(s[e])for(var t=0,a=s[e].length;t<a;t++){var n=s[e][t];n(i)}},o=function(e,i){s[e]||(s[e]=[]);for(var t=!1,a=s[e],n=0,o=a.length;n<o;n++)if(a[n]==i){t=!0;break}t||s[e].push(i)},r=function(e,i){if(i&&"function"==typeof i){var t=s[e];if(t&&t.length)for(var a=t.length,n=a-1;n>=0;n--){var o=t[n];if(o==i){t.splice(n,1);break}}}else delete s[e]};a.on=o,a.off=r,a.trigger=n,i.exports=a},{}],34:[function(e,i,t){var a=e("./promise.js"),s={},n={},o=function(e,i){var i=i||new a;if(n[e])return a.when(function(){var i=n[e],t=new a;return setTimeout(function(){t.resolve(i)},0),t});var i=a.when(function(){return $.ajax({url:e,dataType:"text",type:"get"}).success(function(t){i.resolve(t),n[e]=t}).fail(function(e){i.reject(e)}),i});return i};s.load=o;var r=function(){return s};i.exports=r},{"./promise.js":37}],35:[function(e,i,t){i.exports=function(i){if(!i)throw"global is not defined";return function(t){var a=5e3,s=e("./errorlog.js"),n={},o=$.extend({url:"",data:{}},t),r=new Date;o.success&&(n.successCallback=o.success,delete o.success),o.fail&&(n.failCallback=o.fail,delete o.fail),o.error&&(n.failCallback=o.error,delete o.error);var l=o.url,c=o.data;return o.success=function(e){var t=(new Date,new Date-r);t>=a&&s.overTimeError(e,l,c,t,o.type,i),n.successCallback&&n.successCallback(e)},o.error=function(e){s.networkError(e,l,c,o.type,i),n.failCallback&&n.failCallback(e)},$.ajax(o),n.success=function(e){return n.successCallback=e,n},n.fail=function(e){return n.failCallback=e,n},n}}},{"./errorlog.js":30}],36:[function(e,i,t){var a={doc:document,timer:null,oldTitle:"",flashFlag:!1,count:0,flash:function(e){this.flashFlag?this.clear():this.oldTitle=this.doc.title,this.flashFlag=!0;var i=this;this.timer=setInterval(function(){i.count++,i.count>=30&&(i.count=0,i.clear()),i._flash(e)},500)},_flash:function(e){this.index=this.index?0:1,this.doc.title=this.index?e:this.oldTitle},clear:function(){clearInterval(this.timer),this.flashFlag&&(this.doc.title=this.oldTitle),this.flashFlag=!1}};i.exports=a},{}],37:[function(e,i,t){function a(){var e=[],i=this;this.resolve=function(t){var a=e.shift();a&&a.success&&"function"==typeof a.success&&a.success(t,i)},this.reject=function(t){var a=e.shift();a&&a.fail&&"function"==typeof a.fail&&a.fail(t,i)},this.then=function(t,a){return e.push({success:t,fail:a}),i}}a.when=function(e){return e()},i.exports=a},{}],38:[function(e,i,t){i.exports={basePath:"/chat/pc/v2",imgPath:"http://img.sobot.com/chat/common"}},{}],39:[function(e,i,t){var a=function(i){var t,a=e("../../../common/initConfig.js")("pc"),s=e("../../../common/mode/mode.js"),n=e("../../../common/comm.js"),o=(e("../../../common/socket/heartbeat.js"),e("../../../common/mode/authorization.js")),r=e("../../../common/mode/sensitiveAuthor.js");e("../../../common/util/initJSON.js")();var l,c,d=e("../../../common/util/listener.js"),u=function(){},p=function(){d.on("system.send",function(e){}),d.on("system.initSession",function(e){f()})},f=function(){t=s(l)},m=function(e){u(),p(),e||f()};a.then(function(e){c=n.getQueryParam(),$(".white-layer").remove(),$(document.body).trigger("core.onload",[{data:e}]),l=e,r(l);var t=l.apiConfig.consultAuthFlag,s=l.apiConfig.consultEffectiveScope||"",u=l.apiInit.safety,p=s.indexOf("0")!=-1;return t&&!u&&p?(o(l,a),m(!0)):(a.resolve(),m()),i.parent&&i.parent!==i&&i.parent.postMessage(JSON.stringify({name:"init"}),"*"),d.trigger("core.onload",[l]),a})};i.exports=a},{"../../../common/comm.js":1,"../../../common/initConfig.js":3,"../../../common/mode/authorization.js":9,"../../../common/mode/mode.js":16,"../../../common/mode/sensitiveAuthor.js":20,"../../../common/socket/heartbeat.js":24,"../../../common/util/initJSON.js":32,"../../../common/util/listener.js":33}],40:[function(e,i,t){!function(i){var t=e("./core/core.js")(window,"pc"),a=e("./nesting/nesting.js"),s=e("./listMsg/index.js"),n=e("./sendArea/index.js");e("./util/json.js");var o=function(){},r=function(){window.console||(window.console={log:function(){}}),s(),n($("#footer"),t,window),a()},l=function(){o(),r()};l()}(document.body)},{"./core/core.js":39,"./listMsg/index.js":41,"./nesting/nesting.js":48,"./sendArea/index.js":53,"./util/json.js":64}],41:[function(e,i,t){var a=function(){function i(e){var i,t,a;$(document.body).on("mousedown",e,function(e){i=!0,t=e.clientX,a=$(this).scrollLeft()}),$(e).on("mousemove",function(e){if(i){var s=e.clientX,n=s-t;n<0&&a>0?$(this).scrollLeft(a-n):$(this).scrollLeft(a-n)}}),$(e).on("mouseup",function(e){e.preventDefault(),i=!1}),$(e).on("mouseout",function(e){(e.pageX<0||e.pageX>document.body.offsetWidth)&&(i=!1)})}function t(e){var i="";for(var t in e)if("partnerid"===t||"multiparams"===t||"params"===t){var a=void 0!==e[t]?e[t]:"";i+="&"+t+"="+a}return i?i.substring(1):""}var a,s,n,o,r,l,c,d,u,p,f,m,g=e("../../../common/util/listener.js"),v=e("../../../common/util/load.js")(),h=e("../util/qqFace.js"),y=e("../../../common/mode/currentState.js"),T=e("../../../common/mode/offlineMessageFilter.js"),j=e("../config/config.json"),I=(e("../util/modal/dialog.js"),e("./template.js")),b=e("./theme.js"),w=e("./msgHandler.js"),x=e("../util/datetime.js"),k=e("../../../common/comm.js"),F={},C=60,S=107,L=0,M=0,A=[],P=0,D=0,_="",N=!0,R=function(){0===P&&N?(N=!1,a({type:"post",url:"/chat/user/queryUserCids.action",dataType:"json",data:{uid:s.apiInit.uid,time:s.urlParams.time||0},success:function(e){A=e.cids.reverse(),_=A[P],D=A.length-1,B(_)}})):P>0&&N&&(N=!1,_=A[P],B(_))},O=function(e){e.remindQuestion&&(e.remindQuestion=e.remindQuestion.split("\n")),e.answerStrip&&(e.answerStrip=e.answerStrip.split("\n"))},B=function(e){if(P<=D){$pulldownLoading.css("display","block"),$pulldownText.css("display","none");var i=l.find(".magBox").eq(0).attr("creattime");Number(L)||i,$(this);m=l.children().eq(0),a({type:"post",url:"/chat/user/getChatDetailByCid.action",dataType:"json",data:{uid:s.apiInit.uid,cid:e},success:function(i){i.length>0?(T(i),L=i[0].content.length>0?i[0].content[0].t:+new Date,v.load(j.basePath+"/views/listMsg/historyMsg.html").then(function(e){for(var t="",a=["<a","<img","<frame","<audio","<video","<iframe","<IFRAME","<EMBED","<embed"],c=!1,d=["<script"],u=["","待付款","待发货","运输中","派送中","已完成","待评价","已取消"],p=0;p<i.length;p++){var f=i[p].date;if(f)try{if(i[p].content[0]){var g=i[p].content[0].ts;f=x.formatTime(g,o),t+=doT.template(I.msgDate)(f)}}catch(v){}24==i[p].msgType?i[p].miniPage="string"==typeof i[p].miniPage?JSON.parse(i[p].miniPage):i[p].miniPage:25==i[p].msgType&&(i[p].miniPage="string"==typeof i[p].miniPage?JSON.parse(i[p].miniPage):i[p].miniPage);for(var h=0;h<i[p].content.length;h++){if(c=!1,9==i[p].content[h].msgType||10==i[p].content[h].msgType){"string"==typeof i[p].content[h].msg&&(i[p].content[h].msg=JSON.parse(i[p].content[h].msg));var y=i[p].content[h].msg;if(y.retCode&&"000000"!=y.retCode)"000002"==y.retCode?i[p].content[h].msg=y.retErrorMsg:"000001"==y.retCode&&(i[p].content[h].msg=doT.template(I.cyclicSessionError)(y));else if("string"==typeof y.inputContentList){var T=y.inputContentList.split(","),j={multiDiaRespInfo:y,contentAry:T,msgId:""};i[p].content[h].msg=doT.template(I.inputContentTMP)(j)}else if("object"==typeof y.inputContentList){for(var T=[],b=[],w=0;w<y.inputContentList.length;w++)for(var C in y.inputContentList[w])b.push(C),T.push(y.inputContentList[w][C]);var j={multiDiaRespInfo:y,titleAry:b,contentAry:T,msgId:""};i[p].content[h].msg=doT.template(I.inputContentTMP_1511)(j)}else switch(y.template){case 0:O(y);var j={multiDiaRespInfo:y,msgId:y.msgId,from:"history",clickFlag:!0};i[p].content[h].msg=doT.template(I.cyclicSessionTMP0)(j);break;case 1:O(y);var j={multiDiaRespInfo:y,from:"history",clickFlag:!0};i[p].content[h].msg=doT.template(I.cyclicSessionTMP1)(j);break;case 2:O(y);var j={multiDiaRespInfo:y,from:"history",clickFlag:!0};i[p].content[h].msg=doT.template(I.cyclicSessionTMP2)(j);break;case 3:O(y);var j={multiDiaRespInfo:y};i[p].content[h].msg=doT.template(I.cyclicSessionTMP3)(j);break;case 4:O(y);var j={multiDiaRespInfo:y};i[p].content[h].msg=doT.template(I.cyclicSessionTMP4)(j);break;case 99:O(y);var j={multiDiaRespInfo:y};i[p].content[h].msg=doT.template(I.cyclicSessionTMP99)(j);break;default:i[p].content[h].msg=y.remindQuestion}}for(var w=0;w<a.length;w++)"string"==typeof i[p].content[h].msg&&i[p].content[h].msg.indexOf(a[w])>=0&&(c=!0);if("string"==typeof i[p].content[h].msg&&i[p].content[h].msg.indexOf(d[0])>=0){var S=$("<div></div>").text(i[p].content[h].msg);i[p].content[h].msg=S.html()}if("object"!=typeof i[p].content[h].msg){var L=s.urlParams.isLink;i[p].content[h].msg=c?i[p].content[h].msg:0==L?i[p].content[h].msg:k.getNewUrlRegex(i[p].content[h].msg)}var M=i[p].content[h].action;32==M?i[p].content[h].msg=n.L10049.replace("{0}",i[p].content[h].senderName):34==M?i[p].content[h].msg=n.L10050.replace("{0}",i[p].content[h].senderName):35==M?i[p].content[h].msg=n.L10051.replace("{0}",i[p].content[h].senderName):37==M?i[p].content[h].msg=n.L10052.replace("{0}",i[p].content[h].senderName):38==M&&(i[p].content[h].msg=n.L10053.replace("{0}",i[p].content[h].senderName)),i[p].content[h].recallMsg=n.L10040.replace("{0}",i[p].content[h].senderName)}t+=doT.template(e)({data:i[p].content,orderStatusNameList:u})}t=F.analysis(t),l.find("li:first")&&l.find("li:first").length>0?l.find("li:first").before(t):l.html(t);var A=0;m.offset()&&(A=m.offset().top),r.scrollTop(A-r.offset().top-100),$("#cutoff").css("display","none")}),P++):(P++,e=A[P],B(e)),N=!0,$pulldownLoading.css("display","none"),$pulldownText.css("display","block")}})}else $pulldownText.html(o.T0004)},z=function(e){var e=e.data;g.trigger("listMsg.artificial",e),p.attr("src",5==s.apiConfig.type||6==s.apiConfig.type?s.apiConfig.cardPhotos:e.aface),f.html(5==s.apiConfig.type||6==s.apiConfig.type?s.apiConfig.cardNikeName:e.aname),f.attr("title",5==s.apiConfig.type||6==s.apiConfig.type?s.apiConfig.cardNikeName:e.aname),M=1},E=function(){$(this).hasClass("removeVoice")?(d.css("background-position","-581px 0px"),$(this).removeClass("removeVoice"),g.trigger("listMsg.openVoice",!0)):(d.css("background-position","-501px 0px"),$(this).addClass("removeVoice"),g.trigger("listMsg.openVoice",!1))},q=function(){2===s.apiConfig.pageCloseFlag&&(g.trigger("core.sessionclose",999),a({type:"post",url:"/chat-web/user/out.action",dataType:"json",data:{uid:s.apiInit.uid},success:function(e){e.status}}))},H=function(){a({type:"post",url:"/chat-web/user/out.action",dataType:"json",data:{uid:s.apiInit.uid},success:function(e){g.trigger("core.sessionclose",999)}})},W=function(){var e=y.getCurrentState();try{if("human"==e){var i=!1;window&&window.localStorage&&(i=window.localStorage.getItem("remoteStatus"),i?U():Z())}else window.parent!==window?(window.parent.postMessage(JSON.stringify({name:"chat_collapseWindow",data:""}),"*"),window.parent.postMessage(JSON.stringify({name:"zc_post_message",data:{action:"chat_collapse_window",status:"close"}}),"*"),q()):a({type:"post",url:"/chat-web/user/out.action",dataType:"json",data:{uid:s.apiInit.uid},success:function(e){e.status&&g.trigger("core.sessionclose",999)}})}catch(t){}},U=function(){$(".remote-close-confirm").remove();var e={title:o.T0178,desc:o.T0179,btn1:o.T0001,btn2:o.T0000},i=doT.template(I.closeConfirmDialog)(e);$(".js-mainBox").append(i)},G=function(){$(".remote-close-confirm").remove()},V=function(){Z(),G()},Z=function(){if(s.urlParams.satDegree_A){var e={from:"close",resultFlag:!0,sourceType:1};g.trigger("listMsg.toEvaluate",e)}else window.parent!==window?(window.parent.postMessage(JSON.stringify({name:"chat_collapseWindow",data:""}),"*"),window.parent.postMessage(JSON.stringify({name:"zc_post_message",data:{action:"chat_collapse_window",status:"close"}}),"*"),q()):H()},J=function(e){var i=0,t=0,a=($(window).height(),$(window).width(),$(".js-mainBox").width()),s=$(".js-mainBox").height();e&&(i=e.noticeMsgHeight||0);var n=s-C-S-i-t;r.css("height",n+"px"),$(".js-remote").removeClass("small"),$(".js-remote").removeClass("middle"),$(".js-remote").removeClass("max"),a<482?$(".js-remote").addClass("small"):a<600?$(".js-remote").addClass("middle"):$(".js-remote").addClass("max")},Q=function(e){"human"===e?M=1:"robot"===e&&(M=0)},K=function(i){s=i[0],a=e("../../../common/util/monitAjax.js")(s),n=s.language.lan,o=s.language.text,document.title=s.apiConfig.companyName,X()},X=function(){var e="";if(b(s),F=h(window,s),J(),w(s,window),s.apiConfig.labelFlag){var i=(s.apiConfig.labelList||[]).map(function(e){if(e.paramFlag){var i=t(s.urlParams);e.labelLink+=(e.labelLink.indexOf("?")<0?"?":i?"&":"")+t(s.urlParams),e.labelLink=e.labelLink.toString()}return e});e+=doT.template(I.link)({data:i}),$("#footer1").html(e)}else $("#footer1").css("display","none");p.attr("src",s.apiConfig.robotLogo),f.html(s.apiConfig.robotName),u.html(s.apiConfig.companyName),f.attr("title",s.apiConfig.robotName),u.attr("title",s.apiConfig.companyName)},Y=function(){r=$(".js-chatPanel"),l=$(".js-chatPanelList"),c=$(".js-historyTrigger"),$pulldownLoading=$(".js-pulldown-loading"),d=$(".js-zhichiVoice"),u=$(".js-infoBarCompany"),$pulldownText=$(".js-pulldown-text"),p=$(".js-infoBarLogo"),f=$(".js-titleName"),$closeForm=$(".js-closeForm")},ee=function(){g.on("core.onload",K),c.on("click",R),g.on("core.transfersuccess",z),d.on("click",E),$closeForm.on("click",W),$(window).resize(function(){J()}),g.on("listMsg.noticeInit",J),i(".warrper-link-add"),$(document.body).on("click",".openEdit",function(){$(this).hasClass("active")?($(this).closest(".leftMsg").find(".editContent").scrollTop(0),$(this).closest(".leftMsg").find(".editContent").removeClass("active"),$(this).removeClass("active"),$(this).find(".texts").text("查看全部")):($(this).closest(".leftMsg").find(".editContent").addClass("active"),$(this).addClass("active"),$(this).find(".texts").text("收起全部"))}),$(document.body).delegate(".js-cancel-remotemodel","click",G),$(document.body).delegate(".js-close-remote","click",V)},ie=function(){Y(),ee(),g.on("core.statechange",Q)};ie()};i.exports=a},{"../../../common/comm.js":1,"../../../common/mode/currentState.js":12,"../../../common/mode/offlineMessageFilter.js":18,"../../../common/util/listener.js":33,"../../../common/util/load.js":34,"../../../common/util/monitAjax.js":35,"../config/config.json":38,"../util/datetime.js":59,"../util/modal/dialog.js":67,"../util/qqFace.js":70,"./msgHandler.js":42,"./template.js":46,"./theme.js":47}],42:[function(e,i,t){var a=function(i,t){function a(e){var i=document.createElement("div");i.appendChild(e);var t=i.innerHTML;return i=e=null,t}var s,i,n,o,r,l,c,d,u,p,f,m,g,v,h,y,T=e("../../../common/util/listener.js"),j=e("../../../common/comm.js"),I=e("../util/qqFace.js"),b=(e("../../../common/util/promise.js"),!0),w=e("../../../common/util/errorlog.js"),x=e("../../../common/util/monitAjax.js")(i),k=0,F=e("./template.js"),C=e("../util/datetime.js"),S=e("./noticeMessage.js"),L=e("./pushEvaHandler.js"),M=e("../util/showTip.js"),A=e("../../../common/util/msgReminder.js"),P=e("../sendArea/leaveMessage.js"),D="",_={},N=0,R=!0,O=0,B=!0,z="",E=0,q=!1,H="",W=[],U={},G=0,V=!1,Z="",J=!1,Q=!1,K=!0,X="",Y=[],ee=[],ie=i.language.lan,te=i.language.text,ae=i.apiConfig.userOutFlag,se=i.apiConfig.adminOutFlag,ne=i.urlParams.adminTipWord,oe=60*i.apiConfig.adminTipTime,re=i.apiConfig.accountStatus,le=!1,ce=!1,de=function(e){"human"==e&&(N=1)},ue=function(e){if(!e.originalEvent.data){var i=JSON.parse(e.originalEvent.data);"offlineMessage"==i.name?(0==$(".cutoff").length&&T.trigger("core.onreceive",{type:"human",list:[{type:-110}]}),i.data.type=202,i.data.msg=i.data.content,T.trigger("core.onreceive",{type:"human",list:[i.data]})):"collapse"==i.name?(s=i.name,k=0,$(".cutoff").length>0&&$(".cutoff").remove(),T.trigger("core.onreceive",{type:"human",list:[{type:-110}]})):"expand"==i.name&&(s=i.name,si(),0==k?($(".cutoff").remove(),$(".js-unread").hide()):$(".js-unread").show().text(k+te.T0058))}},pe=function(e){e.remindQuestion&&(e.remindQuestion=e.remindQuestion.split("\n")),e.answerStrip&&(e.answerStrip=e.answerStrip.split("\n"))},fe=function(e){var i=new Date,t=i.getHours()>=10?i.getHours():"0"+i.getHours(),a=i.getMinutes()>=10?i.getMinutes():"0"+i.getMinutes(),s=te.T0011+t+":"+a,n=u.children().last().prev();if(u&&u.children().length&&n.hasClass("sysData")&&n.find(".msgData").html(s),1===e){var o=doT.template(F.msgDate)(s);u.append(o)}},me=function(e,a){if("humanOnly"!=e.moduleType||"blacklist"!=e.status){if("system"===e.type){var s=(+new Date,""),n="";if("queue"==e.status)return $(".js-queueing").remove(),n=doT.template(F.systemMsg)(e.data),n=ii(n),D=$(n),u.append(D),7==e.data.status&&setTimeout(function(){i.urlParams.isLeaveCustomSysFlag?t.open(i.urlParams.leaveCustomUrl,"_self"):T.trigger("listMsg.openleaveMsgPage")},5e3),si(),ge(),ve(e.data.id),$(".js-moduleSwitch").remove(),u.find(".js-fengefu1").remove(),
V=!0,void(z&&$("#"+z).remove());if("kickout"==e.status)return;e.data.id="systemMsg"+ +new Date,2===e.data.status&&(z&&$("#"+z).remove(),z=e.data.id),3==e.data.status||e.data.status==-2?(s=doT.template(F.systemMsg2)(e.data),s=ii(s)):(s="line"==a?doT.template(F.msgDate)(e.data.content):doT.template(F.systemMsg)(e.data),s=ii(s));$(s);u.append($(s)),"evaluate"==e.status&&setTimeout(function(){ve(e.data.id)},5e3),"leaveMsgComplete"==e.status&&setTimeout(function(){ve(e.data.id)},3e4),"transfer"==e.status&&fe(1),si()}else if("human"==e.type){var e=e.data;f.attr("src",5==i.apiConfig.type||6==i.apiConfig.type?i.apiConfig.cardPhotos:e.aface),p.html(5==i.apiConfig.type||6==i.apiConfig.type?i.apiConfig.cardNikeName:e.aname),p.attr("title",5==i.apiConfig.type||6==i.apiConfig.type?i.apiConfig.cardNikeName:e.aname),T.trigger("listMsg.artificial",e),e.global=i;var s=doT.template(F.transferSayHello)(e);s=ii(s),i.apiConfig.adminHelloWordFlag&&u.append(s),u.find(".js-SwitchAdminsMsg").remove()}else if("overTimeTips"==e.type)if(1==e.data.sysType){var o=[{type:206,content:e.data.content}];_e(o,0,function(){}),si()}else if(2==e.data.sysType){var o=[{type:206,content:e.data.content}];_e(o,0,function(){}),si()}else if(3==e.data.sysType||4==e.data.sysType){var r={type:"system",status:"offline",data:{content:e.data.content}};me(r,"line"),si()}si()}},ge=function(){var e=40;$(".js-queueing").css("width",$(".js-chatPanelBody").width()-e+"px")},ve=function(e){$("#"+e).remove()},he=function(e){i.urlParams.templateId=e,x({url:"/chat/data/invokeOtherByUser.action",dataType:"json",type:"get",data:{uid:i.apiInit.uid,url:"basic-set/getCusMsgTemplateConfig/4",method:"get",param:JSON.stringify({templateId:e})}}).success(function(e){i.urlParams.msgTxt=e.item.msgTxt,i.urlParams.msgTmp=e.item.msgTmp,i.urlParams.emailFlag=e.item.emailFlag,i.urlParams.emailShowFlag=e.item.emailShowFlag,i.urlParams.enclosureFlag=e.item.enclosureFlag,i.urlParams.enclosureShowFlag=e.item.enclosureShowFlag,i.urlParams.telFlag=e.item.telFlag,i.urlParams.telShowFlag=e.item.telShowFlag,i.urlParams.ticketShowFlag=e.item.ticketShowFlag,i.urlParams.ticketTypeFlag=e.item.ticketTypeFlag,i.urlParams.ticketTypeId=e.item.ticketTypeId,i.urlParams.ticketTitleShowFlag=e.item.ticketTitleShowFlag,P(i,1)})},ye=function(e){if(e&&e.length)for(var a=0;a<e.length;a++){var s=e[a].date||"",n="";if(s&&"welcome-sugguestions"!==e[a].answerType){var o=e[a].content[0].ts,r=0;try{r=e[1].content[0].t}catch(l){}s=C.formatTime(o,te),n+=doT.template(F.msgDate)(s),u.append(n)}"welcome-sugguestions"===e[a].answerType&&(U=e[a],e[a].content[0].answer=e[a].content[0].msg,Ie(e[a],!1));var c=e[a].content||[];Te(c,0,function(){if($(".webchat_img_upload")&&$(".webchat_img_upload").parent().parent().parent().addClass("imgMagBox"),$(".js-msgFileIco")&&$(".js-msgFileIco").parent().parent().parent().addClass("fileMagBox"),1==i.apiInit.isAgree){var e=doT.template(F.agreeAuthor)();u.append(e)}}),O>10&&$(".js-unread").css("display","block").html(O+te.T0058)}if(0==$(".js-chatPanelList").find(".js-noticeMsg").length){var d=doT.template(F.noticeHtml)({languageText:te,style:i.apiConfig.announceTopFlag});i.apiConfig.announceTopFlag?(m.append(d),i.apiConfig.announceClickUrl&&i.apiConfig.announceClickFlag&&(m.find(".js-noticeMsg").attr("href",i.apiConfig.announceClickUrl),m.find(".js-noticeMsg").addClass("openLink"))):setTimeout(function(){$(".js-chatPanelList  > li:first-child").before(d)},10),!i.apiConfig.announceMsgFlag||i.apiInit.multiFlag&&!i.apiConfig.announceTopFlag||setTimeout(function(){S(i,t)},50)}if(u.append(H),$(".js-changeGroup").click(function(){G++,G>=W.length&&(G=0);var e={list:W[G],isHistory:!1},i=doT.template(F.sugguestionsListMsg)(e);$(".sugguestions-change").html(i)}),i.multiGuideData){var p=doT.template(F.multiGuideHtml)({languageText:te,robotData:i.apiConfig,multiGuideData:i.multiGuideData});u.append(p)}if(u.append(D),"1"==i.existFlag&&i.apiConfig.ticketShowFlag){var f='<div style="width: 190px;height: 28px;background:rgba(240,244,245,1);border-radius:4px;text-align: center;margin: 0px auto"><p class="sysData js-jumpLeaveMsg" style="color:#8C989B;margin-top:0;text-align: center;line-height: 28px;">'+te.T0129+"，"+te.T0152+'<span class="js-jump" style="color:#4D9DFE;cursor: pointer ">'+te.T0153+"</span></p></div>";u.append(f),$(".js-jump").on("click",function(){x({type:"post",url:"/chat-web/user/getWsTemplate.action",dataType:"json",data:{uid:i.apiInit.uid,source:0,channelFlag:i.urlParams.channelFlag||""},success:function(e){var i=e||[];if(i.length>1){var t=doT.template(F.groupTemplate)({list:i});layer=$(t),$(".js-mainBox").append(layer),layer.delegate(".js-item","click",function(){layer.remove();var e=$(this).data("id");he(e)}),layer.find(".js-group-outer").animate({right:"0"}),layer.delegate(".js-cancel-btn,.js-group-layer","click",function(){layer.find(".js-group-outer").animate({right:"-390px"},function(){layer.remove()})})}else he(i[0].templateId)}}),$(this).parent().parent().remove()})}fe(),si()},Te=function(e,t,a){e.forEach(function(e){29==e.action&&(e.senderType=4),32==e.action?(e.senderType=4,e.msg=ie.L10049.replace("{0}",e.senderName)):34==e.action?(e.senderType=4,e.msg=ie.L10050.replace("{0}",e.senderName)):35==e.action?(e.senderType=4,e.msg=ie.L10051.replace("{0}",e.senderName)):37==e.action?(e.senderType=4,e.msg=ie.L10052.replace("{0}",e.senderName)):38==e.action&&(e.senderType=4,e.msg=ie.L10053.replace("{0}",e.senderName))});try{if(t>=e.length)return void(a&&a(t));var s=e[t],n=function(){Te(e,t+1,a)};switch(s.senderType){case-1:var o={content:te.T0059},r=doT.template(F.cutoffMsg)(o);u.append(r),n();break;case 0:var l="";9==s.msgType||10==s.msgType?(s.msg=JSON.parse(s.msg),l=je(s.msg,s.senderType)):"string"==typeof s.msg&&(l=We(s.msg));var c={msg:l,t:s.t,dateuid:s.msgId,senderType:s.senderType,from:"initHistory"},r=doT.template(F.rightMsg)(c);u.append(r),n();break;case 1:try{9==s.msgType||10==s.msgType?(s.msg=JSON.parse(s.msg),s.msg=je(s.msg,s.senderType)):"string"==typeof s.msg&&(s.msg=We(s.msg));var c={msg:s.msg,aname:s.senderName,t:s.t,languageText:te,revokeFlag:s.revokeFlag,from:"initHistory",pushInformation:s.pushInformation?JSON.parse(s.pushInformation):{},optionList:s.optionList,template:s.template,nodeId:s.nodeId},r=doT.template(F.leftMsg)(c);r=ii(r),u.append(r),n()}catch(d){}break;case 2:try{if(9==s.msgType||10==s.msgType)s.msg=JSON.parse(s.msg),s.msg=je(s.msg,s.senderType);else if(24==s.msgType)s.miniPage="string"==typeof s.miniPage?JSON.parse(s.miniPage):s.miniPage;else if(25==s.msgType){var p=["","待付款","待发货","运输中","派送中","已完成","待评价","已取消"];s.miniPage="string"==typeof s.miniPage?JSON.parse(s.miniPage):s.miniPage,s.miniPage.orderStatusNameList=p}else"string"==typeof s.msg&&(s.msg=We(s.msg));var c={msg:s.msg,aname:s.senderName,t:s.t,languageText:te,revokeFlag:s.revokeFlag,from:"initHistory",ticketMsgFlag:s.ticketMsgFlag,msgType:s.msgType,miniPage:s.miniPage,pushInformation:s.pushInformation?JSON.parse(s.pushInformation):{},optionList:s.optionList,template:s.template,nodeId:s.nodeId};1==s.actualSenderType&&(c.aname=s.realName||s.senderName);var r=doT.template(F.leftMsg)(c);r=ii(r),1==i.apiConfig.adminHelloWordCountRule&&1==i.apiInit.ustatus&&(ce=!0),c.msgType>=0?u.append(r):ce||u.append(r),"offline"===s.msgType_2&&O++,n()}catch(d){}break;case 3:n();break;case 4:var f={type:"system",status:"offline",data:{content:s.msg}};me(f,"line"),n();break;default:n()}}catch(d){w.runtimeError(d,"initmessage",s,i)}},je=function(e,i){var t=e;if(1==i||2==i)if("000000"==t.retCode)if("string"==typeof t.inputContentList){var a=t.inputContentList.split(",");pe(t);var s={multiDiaRespInfo:t,contentAry:a,msgId:e.msgId,from:"initHistory"};t.template?e.msg=doT.template(F.inputContentTMP_2)(s):e.msg=doT.template(F.inputContentTMP)(s)}else if("object"==typeof t.inputContentList){for(var a=[],n=[],o=0;o<t.inputContentList.length;o++)for(var r in t.inputContentList[o])n.push(r),a.push(t.inputContentList[o][r]);pe(t);var s={multiDiaRespInfo:t,titleAry:n,contentAry:a,msgId:e.msgId};e.msg=doT.template(F.inputContentTMP_1511)(s)}else if(t.interfaceRetList)switch(t.template){case 0:pe(t);var s={multiDiaRespInfo:t,clickFlag:!0};e.msg=doT.template(F.cyclicSessionTMP0)(s);break;case 1:pe(t);var s={multiDiaRespInfo:t,clickFlag:!0};e.msg=doT.template(F.cyclicSessionTMP1)(s);break;case 2:pe(t);var s={multiDiaRespInfo:t,clickFlag:!0};e.msg=doT.template(F.cyclicSessionTMP2)(s);break;case 3:pe(t);var s={multiDiaRespInfo:t};e.msg=doT.template(F.cyclicSessionTMP3)(s);break;case 4:pe(t);var s={multiDiaRespInfo:t};e.msg=doT.template(F.cyclicSessionTMP4)(s);break;case 99:pe(t);var s={multiDiaRespInfo:t};e.msg=doT.template(F.cyclicSessionTMP99)(s);break;default:e.msg=t.remindQuestion}else e.msg=t.remindQuestion||t.answer;else if("000002"==t.retCode)e.msg=t.retErrorMsg;else{var s={multiDiaRespInfo:t};e.msg=doT.template(F.cyclicSessionError)(s)}else switch(t.template){case 0:pe(t);var s={multiDiaRespInfo:t};e.msg=doT.template(F.cyclicSessionTMP0)(s);break;case 1:pe(t);var s={multiDiaRespInfo:t};e.msg=doT.template(F.cyclicSessionTMP1)(s);break;case 2:pe(t);var s={multiDiaRespInfo:t};e.msg=doT.template(F.cyclicSessionTMP2)(s);break;case 3:pe(t);var s={multiDiaRespInfo:t};e.msg=doT.template(F.cyclicSessionTMP3)(s);break;default:e.msg=t.remindQuestion}return e.msg},Ie=function(e,t){if("robot"==e.type||t===!0){if(v&&v.play&&B)try{v.play()}catch(a){}if(t===!0)var s=e,n=e.answerType;else{if(e.list)var s=e.list[0],n=e.list[0].answerType;if(e.content)var s=e.content[0],n=e.content[0].answerType}if(contentInner=ke(s),contentInner&&0!=contentInner){var o={aname:i.apiConfig.robotName,msg:contentInner,languageText:te,showArtificial:q,showEvaluate:showEvaluate,wurl:Z,wurlOpenStyle:Q,robotFlag:s.robotFlag,docId:s.docId,question:s.question,msgId:s.msgId,pushInformation:e.pushInformation?JSON.parse(e.pushInformation):{},optionList:e.optionList,template:e.template,nodeId:e.nodeId},r=doT.template(F.leftMsg)(o),l=$(r);if(1==i.urlParams.realuateFlag&&s.docId&&l.find(".msgDiv").css("display","block"),s.multiDiaRespInfo&&s.multiDiaRespInfo.inputContentList&&s.multiDiaRespInfo.template&&l.find(".msgDiv").css("display","inline-block"),n&&l.find(".msgText").find("a").attr("target","_blank"),"welcome-sugguestions"===e.answerType)return void(H=l);u.append(l),$(".sugguestions").find("a").attr("target","_self")}$(".sugguestions").find("a").attr("target","_self"),se&&clearInterval(c)}else"human"==e.type?(_e(e.list,0,function(){}),A.flash(te.T0158)):w.specialError("ignore message","msgHandler",{data:e,searchFlag:t},i);setTimeout(function(){si()},100)},be=function(e){var i={switchType:"transferType",queueFlag:e.queueFlag,transferType:e.transferType};T.trigger("listMsg.transTypeArtificial",i)},we=function(e){if(1==e.transferFlag||3==e.transferFlag){var t={switchType:1==e.transferFlag?"keySwitch":"defaultKey",groupId:e.groupId,transferFlag:e.transferFlag,keyword:e.keyword,keywordId:e.keywordId,queueFlag:e.queueFlag};T.trigger("listMsg.keyWordArtificial",t)}else if(2==e.transferFlag&&!i.urlParams.groupId){var t={aname:i.apiConfig.robotName,list:e.groupList,tipsMessage:e.tipsMessage,transferFlag:e.transferFlag,keyword:encodeURIComponent(e.keyword),keywordId:e.keywordId},a=doT.template(F.keySwitchAdmins)(t),s=$(a);u.append(s)}},xe=function(){var e=$(this).attr("data-id"),i=$(this).attr("keyword"),t=$(this).attr("keywordId"),a={switchType:"keySwitch",groupId:e,keyword:decodeURIComponent(i),keywordId:t,switchTypeStyle:"click",queueFlag:2};T.trigger("listMsg.keyWordArtificial",a)},ke=function(e){var t=e.answer,a=e.answerType,s=["1511","1522","1523","15239","1524"],n=!1;if((e.sugguestions||[]).length>0||3==e.senderType){for(var o=0;o<s.length;o++)s[o]==a&&(n=!0);n||(t=Pe(e,!1))}else t=We(t);if(0===e.ustatus)return!1;switch(q=!1,showEvaluate=!1,a){case"1":"1"!==i.urlParams.manualTypeObj.direct||V||1==i.apiConfig.type||(q=!0),1==i.urlParams.realuateFlag&&(showEvaluate=!0);break;case"2":"1"!==i.urlParams.manualTypeObj.under||V||1==i.apiConfig.type||(q=!0);break;case"3":1===i.urlParams.chatConnectButton&&(E++,E==i.urlParams.manualBtnCount&&T.trigger("listMsg.showChatSwitch")),"1"!==i.urlParams.manualTypeObj.unknow||V||1==i.apiConfig.type||(q=!0);break;case"4":"1"!==i.urlParams.manualTypeObj.guide||V||1==i.apiConfig.type||(q=!0);break;case 5:break;case 6:break;case 7:break;case 8:break;case"9":"1"!==i.urlParams.manualTypeObj.direct||V||1==i.apiConfig.type||(q=!0),1==i.urlParams.realuateFlag&&(showEvaluate=!0);break;case 10:break;case"11":"1"!==i.urlParams.manualTypeObj.direct||V||1==i.apiConfig.type||(q=!0),1==i.urlParams.realuateFlag&&(showEvaluate=!0);break;case"12":"1"!==i.urlParams.manualTypeObj.direct||V||1==i.apiConfig.type||(q=!0),1==i.urlParams.realuateFlag&&(showEvaluate=!0);break;case"14":1==i.urlParams.realuateFlag&&(showEvaluate=!0);break;case"15":case"151":case"1521":case"1531":case"1532":case"1533":case"1534":case"1535":case"1536":case"1537":case"153":if("000000"==e.multiDiaRespInfo.retCode){ee.push(e.multiDiaRespInfo);var r=e.multiDiaRespInfo;if(4==e.transferType&&(q=!0),Y[r.level]=r,X=r.conversationId,r.endFlag&&(X=""),r.inputContentList){var l=r.inputContentList.split(",");pe(r);var c={multiDiaRespInfo:r,contentAry:l,msgId:e.msgId};t=r.template?doT.template(F.inputContentTMP_2)(c):doT.template(F.inputContentTMP)(c)}else if(r.interfaceRetList){if(0==r.template){pe(r);var c={multiDiaRespInfo:r,msgId:e.msgId};t=doT.template(F.cyclicSessionTMP0)(c)}else if(1==r.template){pe(r);var c={multiDiaRespInfo:r,msgId:e.msgId};t=doT.template(F.cyclicSessionTMP1)(c)}else if(2==r.template){pe(r);var c={multiDiaRespInfo:r,msgId:e.msgId};t=doT.template(F.cyclicSessionTMP2)(c)}else if(3==r.template){pe(r);var c={multiDiaRespInfo:r,msgId:e.msgId};t=doT.template(F.cyclicSessionTMP3)(c)}else if(4==r.template){pe(r);var c={multiDiaRespInfo:r,msgId:e.msgId};t=doT.template(F.cyclicSessionTMP4)(c)}else if(99==r.template){pe(r);var c={multiDiaRespInfo:r,msgId:e.msgId};t=doT.template(F.cyclicSessionTMP99)(c)}}else t=e.multiDiaRespInfo.remindQuestion;if(1==i.urlParams.realuateFlag)for(var d=["1521","1522","1523","15239","1524","153","1531","1532","1533","1534","1535","1536","1537"],o=0;o<d.length;o++)e.answerType==d[o]&&(showEvaluate=!0)}else if("000002"==e.multiDiaRespInfo.retCode){ee.push(e.multiDiaRespInfo);var r=e.multiDiaRespInfo;Y[r.level]=r,X=r.conversationId,r.endFlag&&(X=""),t=e.multiDiaRespInfo.retErrorMsg}else{var r=e.multiDiaRespInfo;Y[r.level]=r,X=r.conversationId,r.endFlag&&(X=""),t=doT.template(F.cyclicSessionError)(e)}break;case"1511":var r=e.multiDiaRespInfo;ee.push(e.multiDiaRespInfo),X=r.conversationId,Y[r.level]=r,4==e.transferType&&(q=!0),r.endFlag&&(X="");var l=[],u=[],p={};if("000000"==r.retCode){for(var o=0;o<r.inputContentList.length;o++)for(var f in r.inputContentList[o])u.push(f),l.push(r.inputContentList[o][f]);pe(r),p={multiDiaRespInfo:r,titleAry:u,contentAry:l,msgId:e.msgId}}else p={multiDiaRespInfo:r};t=doT.template(F.inputContentTMP_1511)(p);break;case"1522":case"1523":case"15239":case"1524":if(1==i.urlParams.realuateFlag)for(var d=["1521","1522","1523","15239","1524"],o=0;o<d.length;o++)e.answerType==d[o]&&(showEvaluate=!0);var r=e.multiDiaRespInfo;ee.push(e.multiDiaRespInfo),4==e.transferType&&(q=!0),X=r.conversationId,Y[r.level]=r,e.multiDiaRespInfo.endFlag&&(X=""),t=Fe(e)}return t},Fe=function(e){var i=e.sugguestions||e.list,t="",a=e.multiDiaRespInfo;pe(a),t=e.answer||e.multiDiaRespInfo.answer||"";var s={list:i,answerStrip:e.multiDiaRespInfo.answerStrip||e.answerStrip||"",stripe:e.stripe||"",answer:t},n=doT.template(F.multiListSugguestionsMsg)(s);return n},Ce=function(){var e=$(this).attr("conversationId"),i=parseInt($(this).attr("page")),t=91,a=$(this).parent().find(".js-interfaceRetList"+e),s=a.find("li").length,n=0;if(i<=Math.floor(s/3)-1)n=i*(3*t),i++;else{var o=t*(s%3);0==o?(n=0,i=1):(n=(i-1)*(3*t)+o,i=0)}$(this).attr("page",i),a.stop(!0).animate({"margin-top":-n},500)},$e=function(){var e=parseInt($(this).attr("page")),i=$(this).parent().find(".js-tmp2List li"),t=i.length;if(t>3*e){e++,$(this).attr("page",e);for(var a=3*(e-1);a<3*e;a++){if(a>t-1)return $(this).find("span").html("收起全部"),void $(this).find("i").addClass("pull");a==t-1&&($(this).find("span").html("收起全部"),$(this).find("i").addClass("pull")),i.eq(a).removeClass("multiHide")}}else{$(this).find("span").html("展开更多"),$(this).find("i").removeClass("pull");for(var a=3;a<t;a++)i.eq(a).addClass("multiHide");$(this).attr("page",1)}},Se=function(){var e=parseInt($(this).attr("page")),i=$(this).parent().find(".js-tmp1List li"),t=i.length;if(t>9*e){e++,$(this).attr("page",e);for(var a=9*(e-1);a<9*e;a++){if(a>t-1)return $(this).find("span").html("收起全部"),void $(this).find("i").addClass("pull");i.eq(a).removeClass("multiHide")}}else{$(this).find("span").html("展开更多"),$(this).find("i").removeClass("pull");for(var a=9;a<t;a++)i.eq(a).addClass("multiHide");$(this).attr("page",1)}},Le=function(){try{var e=$(this).attr("level"),t=$(this).attr("data-index"),a=($(this).attr("conversationId"),$(this).attr("clickFlag"));if(1!=a&&("UL"===$(this).parent()[0].nodeName?$(this).parent().css("pointerEvents","none"):$(this).parent().parent().css("pointerEvents","none"),$(this).parents(".msgDiv").addClass("noneClick")),!Y.length)return;var s=Y[e],r=s.interfaceRetList[t],l=s.outPutParamList,c=s.template,d={},u=[];s.conversationId;u.push(r),d={interfaceRetList:u,template:c},l=l.split("#");for(var p={},f=0;f<l.length;f++)p[l[f]]=r[l[f]];p.level=Y[s.level].level,p.conversationId=Y[s.level].conversationId;var m="";0==c?m=0==N?'<div class="tmp0InnerList">'+$(this).html()+"</div>":d.interfaceRetList[0].title:1==c?(m=$(this).html(),d=$(this).html()):2==c&&(m=0==N?'<div class="tmp2InnerList">'+$(this).html()+"</div>":d.interfaceRetList[0].title),T.trigger("sendArea.send",[{answer:m,requestText:p,multiDiaQuestion:d,uid:n,cid:o,sysNum:i.sysnum,date:+new Date,questionFlag:2,source:0,robotFlag:i.urlParams.robotFlag||"",lanFlag:i.urlParams.lanFlag||0,currentStatus:0==N?"robot":"human"}])}catch(g){}},Me=function(){try{if(!Y.length)return;var e={},t=($(this).attr("data-index"),$(this).text()),a=$(this).attr("level"),s=Y[a].levelName;$(this).attr("conversationId");e.level=Y[a].level,e.conversationId=Y[a].conversationId,e[s]=t,T.trigger("sendArea.send",[{answer:t,requestText:e,multiDiaQuestion:t,uid:n,cid:o,sysNum:i.sysnum,date:+new Date,questionFlag:2,source:0,robotFlag:i.urlParams.robotFlag||"",lanFlag:i.urlParams.lanFlag||0,currentStatus:0==N?"robot":"human"}])}catch(r){}},Ae=function(){try{if(!Y.length)return;var e={},t=$(this).attr("title"),a=$(this).attr("content"),s=$(this).attr("level"),r=(Y[s].remindQuestion,$(this).attr("conversationId"),t+"："+a);e.level=Y[s].level,e.conversationId=Y[s].conversationId,e[t]=a,T.trigger("sendArea.send",[{answer:r,requestText:e,multiDiaQuestion:r,uid:n,cid:o,sysNum:i.sysnum,date:+new Date,questionFlag:2,source:0,robotFlag:i.urlParams.robotFlag||"",lanFlag:i.urlParams.lanFlag||0,currentStatus:0==N?"robot":"human"}])}catch(l){}},Pe=function(e,t){if(e){if(e.list){if(i.apiConfig.guideGroupFlag&&i.apiConfig.guideGroupNum!==-1){for(var a=e.list,s=JSON.parse(JSON.stringify(a)),n=s.length,o=i.apiConfig.guideGroupNum,r=n%o===0?n/o:Math.floor(n/o+1),l=0;l<r;l++){var c=s.slice(l*o,l*o+o);W.push(c)}var d="";e.answer&&(d="[object Object]"==Object.prototype.toString.call(e.answer)?e.answer.msg:e.answer);var u={list:W[G],isHistory:t,stripe:e.stripe,answer:d,oldsum:a.length,zsum:i.apiConfig.guideGroupNum,count:i.apiConfig.guideGroupFlag},p=doT.template(F.listSugguestionsMsgChange)(u);return p}var a=e.list,d="";e.answer&&(d="[object Object]"==Object.prototype.toString.call(e.answer)?e.answer.msg:e.answer);var u={list:a,isHistory:t,stripe:e.stripe,answer:d},p=doT.template(F.listSugguestionsMsgChange)(u);return p}if(e.sugguestions){var a=e.sugguestions,d="";e.answer&&(d="[object Object]"==Object.prototype.toString.call(e.answer)?e.answer.msg:e.answer);var u={list:a,isHistory:t,stripe:e.stripe,answer:d},p=doT.template(F.listSugguestionsMsg)(u);return p}}return ie.L10032},De=function(){},_e=function(e,a,n){if(a>=e.length)return void(n&&n(a));var o=e[a],d=function(){_e(e,a+1,n)};switch(o.type){case 200:o.serviceInfo.serviceOutDoc&&(ne=o.serviceInfo.serviceOutDoc),o.serviceInfo.serviceOutTime&&o.serviceInfo.serviceOutDoc&&(oe=60*o.serviceInfo.serviceOutTime),T.trigger("core.transfersuccess",{data:o});case 201:if(i.urlParams.msgflag)var m=o.queueDoc;else var m=o.queueDoc+ie.L10039;var g={id:o.msgId,content:m},j=doT.template(F.systemqueue)(g);$(".js-queueing").html(j),ge(),d();break;case 202:"collapse"==s&&k++;var I=We(o.content);I.indexOf("验证码")==-1||0!=re&&1!=re||(J=!0);var g;if(24==o.msgType)g={msg:I,msgId:o.msgId,aname:o.aname,languageText:te,language:ie,revokeFlag:o.revokeFlag,dangerWarnFlag:J,msgType:o.msgType,miniPage:"string"==typeof o.miniPage?JSON.parse(o.miniPage):o.miniPage,pushInformation:o.pushInformation?JSON.parse(o.pushInformation):{},optionList:o.optionList,template:o.template,nodeId:o.nodeId};else if(25==o.msgType){var w=["","待付款","待发货","运输中","派送中","已完成","待评价","已取消"];g={msg:I,msgId:o.msgId,aname:o.aname,languageText:te,language:ie,revokeFlag:o.revokeFlag,dangerWarnFlag:J,msgType:o.msgType,miniPage:"string"==typeof o.miniPage?JSON.parse(o.miniPage):o.miniPage,pushInformation:o.pushInformation?JSON.parse(o.pushInformation):{},optionList:o.optionList,template:o.template,nodeId:o.nodeId},g.miniPage.orderStatusNameList=w}else g={msg:I,msgId:o.msgId,aname:5==i.apiConfig.type||6==i.apiConfig.type?i.apiConfig.cardNikeName:o.aname,languageText:te,language:ie,revokeFlag:o.revokeFlag,dangerWarnFlag:J,pushInformation:o.pushInformation?JSON.parse(o.pushInformation):{},optionList:o.optionList,template:o.template,nodeId:o.nodeId};if(o.pushInformation){var x=JSON.parse(o.pushInformation).message;g.msg=g.msg.replace(x,'<span style="color:#1890FF">'+x+"<span>")}var j=doT.template(F.leftMsg)(g),C=$(j);if(1==i.urlParams.realuateFlag&&o.docId&&C.find(".msgDiv").css("display","block"),u.append(C),J=!1,$("#js-inputIng").removeClass("inputIngActive"),se&&clearInterval(c),overTimeTipFlag="user",ae&&2==i.apiInit.isLock&&Ve(),(document.hidden||!b)&&B&&v&&v.play)try{v.play()}catch(S){}d();break;case 204:var j="";t.parent!==t&&t.parent.postMessage(JSON.stringify({name:"closeSession",data:o,status:o.status}),"*"),R=!1,d();break;case 205:clearInterval(r),o.content=te.T0119,$("#js-inputIng").html(o.content).addClass("inputIngActive"),r=setTimeout(function(){$("#js-inputIng").removeClass("inputIngActive")},5e3),d();break;case 206:var I=We(o.content),g={msg:I,aname:p.html(),languageText:te,pushInformation:o.pushInformation?JSON.parse(o.pushInformation):{},optionList:o.optionList,template:o.template,nodeId:o.nodeId},j=doT.template(F.leftMsg)(g);u.append(j),$("#js-inputIng").removeClass("inputIngActive"),d();break;case 210:f.attr("src",5==i.apiConfig.type||6==i.apiConfig.type?i.apiConfig.cardPhotos:o.face),p.html(o.name),p.attr("title",o.name),T.trigger("listMsg.artificial",o),o.serviceInfo.serviceOutDoc&&(ne=o.serviceInfo.serviceOutDoc),o.serviceInfo.serviceOutTime&&o.serviceInfo.serviceOutDoc&&(oe=60*o.serviceInfo.serviceOutTime),d();break;case-110:var j=doT.template(F.cutoffMsg)({content:te.T0059});u.append(j),d();break;case 209:L(i,t,o),d();break;case 211:var M=ie.L10040.replace("{0}",o.adminName),g={tips:M},j=doT.template(F.recallMsg)(g);u.find('[data-msg-id="'+o.revokeMsgId+'"]').html(j),d();break;case 213:i.apiInit.isLock=o.lockType,1==i.apiInit.isLock?(clearInterval(c),clearInterval(l)):(ae&&"user"==overTimeTipFlag&&Ve(),se&&"admin"==overTimeTipFlag&&Ze()),d();break;case 2e3:var A=o.session.apply.tuname,g={title:te.T0168.replace("{0}",A),desc:te.T0169,btn1:te.T0170,btn2:te.T0171},j=doT.template(F.remoteApply)(g);h.html(j),y=o.session.sessionId;var P={type:"system",status:"startRemote",data:{content:ie.L10049.replace("{0}",o.session.apply.tuname)}};me(P),ui();break;case 2002:var P={type:"system",status:"refuseRemote",data:{content:ie.L10052.replace("{0}",o.session.apply.tuname)}};me(P),pi();break;case 2003:Ne("false");var m="";1===o.realType?m=ie.L10051.replace("{0}",o.session.apply.tuname):2===o.realType?m=ie.L10053.replace("{0}",o.session.apply.tuname):3===o.realType&&(m=ie.L10054.replace("{0}",o.session.apply.uuname));var P={type:"system",status:"endRemote",data:{content:m}};me(P);break;case 2004:var P={type:"system",status:"cancelRemote",data:{content:ie.L10050.replace("{0}",o.session.apply.tuname)}};me(P),pi();break;case 2006:Ne("true"),pi();break;default:d()}si()},Ne=function(e){try{t&&t.localStorage&&t.localStorage.setItem(i.apiInit.uid+"_remoteStatus",e)}catch(a){}},Re=function(e){var i=e.percentage;$("#"+e.token).find(".js-processSpan").css("width",i+"%")},Oe=function(e){var i="fileOther";switch(e.filetype){case"rar":i="fileRar";break;case"txt":i="fileTxt";break;case"doc":i="fileDoc";break;case"pdf":i="filePdf";break;case"ppt":i="filePpt";break;case"xls":i="fileXls";break;default:i="fileOther"}if(e.browserVersion&&"ie-"===e.browserVersion)var t={filename:e.filename+e.extension,filetype:e.filetype,filesize:e.filesize,t:e.date,dateuid:e.token,fileIcoClass:i,source:"uploadFile",languageText:te};else var t={filename:e.filename+e.extension,filetype:e.filetype,filesize:e.filesize||"",t:e.date,dateuid:e.token,fileIcoClass:i,source:"uploadFile",languageText:te};var a=doT.template(F.rightMsg)(t),s=$(a);u.append(s),e.browserVersion&&"ie-"===e.browserVersion?(s.find(".js-uploadFileProcess").remove(),s.find(".js-filecancel").remove(),s.find(".js-fileSize").remove(),s.find(".js-sizeAfter").html("上传中...")):s.delegate("#filecancel"+e.token,"click",function(){T.trigger("listMsg.closeUploadFile","cancel"),s.find(".js-uploadFileProcess").remove(),s.find(".js-filecancel").remove(),s.find(".js-filecanceled").css("display","block")}),si()},Be=function(e){if(e.browserVersion&&"ie-"===e.browserVersion)var i={msg:'<img  class="webchat_img_upload js-zhichiMsgReUpload" src="img/upImgLoad.png"/>',t:e.date,dateuid:e.token,source:"uploadImg"};else var i={msg:'<img  class="webchat_img_upload js-zhichiMsgReUpload" src="'+e.result+'"/>',t:e.date,dateuid:e.token,source:"uploadImg"};var t=doT.template(F.rightMsg)(i),a=$(t);u.append(a);var s=$("#"+e.token).find(".js-uploadImgLayer").height();$("#"+e.token).find(".js-cancelUploadImg").css("margin-top",(s-60)/2+"px"),a.delegate("#imgCancel"+e.token,"click",function(){T.trigger("listMsg.closeUploadImg"),$("#"+e.token).remove()}),si()},ze=function(e){"ie-"===e.browserVersion?($("#"+e.dateuid).find(".js-sizeAfter").remove(),$("#"+e.dateuid).find(".js-filefail").css("display","block")):($("#"+e.dateuid).find(".js-uploadFileProcess").remove(),$("#"+e.dateuid).find(".js-filecancel").remove(),$("#"+e.dateuid).find(".js-filefail").css("display","block"))},Ee=function(e){A.clear(),e=e[0];var t=We(e.answer);e.dateuid||(e.dateuid=e.uid+ +new Date);var a=e.dateuid,s={msg:t,dateuid:a},n=i.apiConfig.sensitiveAuthFlag,o=i.apiInit.sensitive,r=i.apiConfig.sensitiveEffectiveScope||"",c=r.indexOf("0")!=-1,d=!1;if("image"===e.msgSendType)$("#"+a).find(".msgText").html(e.answer),$("#"+a).find(".js-uploadImgLayer").remove(),$("#msgStatus"+a).remove(),d=!0;else if("file"===e.msgSendType)$("#"+a).find(".js-filecancel").remove(),$("#"+a).find(".js-uploadFileProcess").remove(),$("#"+a).find(".js-filedownload").css("display","inline-block").attr("href",e.fileurl),d=!0;else if("ie-image"===e.msgSendType)$("#"+a).find(".js-zhichiMsgReUpload").attr("src",e.fileurl),$("#"+a).find(".js-uploadImgLayer").remove(),d=!0;else if("ie-file"===e.msgSendType)$("#"+a).find(".js-sizeAfter").html("上传完成"),d=!0;else if(1==i.apiInit.sensitive||!e.holdSocket){var p=doT.template(F.rightMsg)(s);u.append(p),$("#msgStatus"+a).addClass("msgsending")}ae&&clearInterval(l),overTimeTipFlag="admin",se&&2==i.apiInit.isLock&&Ze(),e.image===!0?setTimeout(function(){si()},500):si(),e.isCheckedSensitive||(n&&!o&&c&&!d?T.trigger("sendArea.sensitiveMsg",{conf:s,msgData:e}):T.trigger("sendArea.send.TdAction",[e]))},qe=function(e){var i={msg:e.answer,leaveMsgFlag:1},t=doT.template(F.rightMsg)(i);u.append(t),si()},He=function(e){if(e){var i={msg:e},t=doT.template(F.rightMsg)(i);u.append(t),si()}},We=function(e){var t=["<a","<img","<frame","<audio","<video","<iframe","<IFRAME","<EMBED","<embed"],s=!1;if("string"==typeof e){var n=["<script"];if(e.indexOf(n[0])>=0){var o=$("<div></div>").text(e);e=o.html()}for(var r=0;r<t.length;r++)e.indexOf(t[r])>=0&&(s=!0);if(s)for(var l=["<audio"],r=0;r<l.length;r++)if(e.indexOf(l[r])>=0){var c=$(e);c.attr("src",$(c.children()[0]).attr("src"));var d=a(c[0]);e=d}else e=e;else{var u=i.urlParams.isLink;e=0==u?e:j.getNewUrlRegex(e)}return e=_.analysis(e)}},Ue=function(e){"success"===e.result?$("#msgStatus"+e.msgId).remove():"ImgSendFail"==e.result?$("#msgStatus"+e.msgId).addClass("msgsendError js-ImgSendFail"):$("#msgStatus"+e.msgId).addClass("msgsendError")},Ge=function(){A.clear();var e=$(this).attr("id"),t=$("#"+e).parent().find(".msgText").html();if($("#"+e).parent().parent().remove(),e=e.substr(9,e.length),$(this).hasClass("js-ImgSendFail")){var a=$(this).parent().find(".js-zhichiMsgReUpload").attr("src");return void T.trigger("sendArea.createUploadImg",{result:a,date:+new Date,token:e})}T.trigger("sendArea.send",[{answer:t,uid:n,cid:o,dateuid:e,currentStatus:0==N?"robot":"human",date:+new Date,token:e,sendAgain:!0}]),ae&&clearInterval(l),overTimeTipFlag="admin",se&&2==i.apiInit.isLock&&Ze()},Ve=function(){i.urlParams.userTipWord,60*i.apiConfig.userTipTime;clearInterval(l),l=setInterval(function(){},1e3)},Ze=function(){if(1===N&&!le){clearInterval(c),i.apiConfig.serviceOutCountRule&&(le=!0),c=setInterval(function(){},1e3)}},Je=function(){var e=$(this).attr("data-docid")||"",i=$(this).html();if(K){K=!1;var t=n+ +new Date;T.trigger("sendArea.send",[{requestText:e,answer:i,uid:n,cid:o,dateuid:t,requestType:"question",questionFlag:1,date:+new Date,currentStatus:0==N?"robot":"human"}]),$("#msgStatus"+t).removeClass("msgsending"),setTimeout(function(){K=!0},1e3)}},Qe=function(){var e=($(this).attr("data-docid")||"",$(this).attr("data-num")),t=[{question:e,answer:e,sysNum:i.sysnum,uid:n,cid:o,currentStatus:0==N?"robot":"human",source:i.userInfo.source,lanFlag:i.urlParams.lanFlag||0,robotFlag:i.urlParams.robotFlag||"",questionFlag:0}];T.trigger("sendArea.send",t)},Ke=function(){},Xe=function(e){switch(e){case-3:p.attr("title","").html(i.apiConfig.robotName),V=!0;break;case-1:if(p.attr("title","").html(ie.L10027),f.attr("src","https://img.sobot.com/console/common/face/admin.png"),1===i.apiConfig.sideBarStatus&&($(".js-barRobotName").html(ie.L10027),$(".js-barHeadImg").attr("src","https://img.sobot.com/console/common/face/admin.png")),i.urlParams.msgflag)var t=i.urlParams.adminNonelineTitle;else var t=i.urlParams.adminNonelineTitle+i.apiConfig.leaveMsg;var a={type:"system",status:"offline",data:{content:t}};i.apiConfig.adminNoneLineFlag&&me(a);break;case-2:p.attr("title","").html(ie.L10026),f.attr("src","https://img.sobot.com/console/common/face/admin.png"),1===i.apiConfig.sideBarStatus&&($(".js-barRobotName").html(ie.L10026),$(".js-barHeadImg").attr("src","https://img.sobot.com/console/common/face/admin.png")),V=!0;break;case-4:var a={type:"system",status:"offline",data:{content:i.urlParams.adminNonelineTitle}};i.apiConfig.adminNoneLineFlag&&me(a);break;case 2:case 3:if(i.apiConfig.serviceEndPushFlag){if(i.urlParams.msgflag)var s=i.urlParams.serviceEndPushMsg.replace("#客服#",p.html());else var s=i.urlParams.serviceEndPushMsg.replace("#客服#",p.html())+i.apiConfig.leaveMsg;var a={type:"system",status:"offline",data:{content:s}};me(a)}break;case 5:var a={type:"system",status:"offline",data:{content:"温馨提示：请提高警惕，谨防被骗！不要轻信转账、付款二维码等信息！"}};me(a);break;case 6:var a={type:"system",status:"offline",data:{content:ie.L10030}};me(a);break;case 1:var n="";n="暂无客服在线"===p.html()?i.urlParams.serviceEndPushMsg.replace("#客服#","客服"):i.urlParams.serviceEndPushMsg.replace("#客服#","客服");var o={content:n};_html=doT.template(F.systemMsg)(o),i.apiConfig.serviceEndPushFlag&&u.append(_html);
break;case 4:var r=ii(i.apiConfig.userOutWord),o=[{type:206,content:r,aname:p.html()}];_e(o,0,function(){});case 7:break;case 8:var a={type:"system",status:"offline",data:{content:ie.L10031.replace("{0}",p.html())}};me(a)}},Ye=function(e){Z=e.wurl,Q=e.wurlOpenStyle},ei=function(){$(".js-moduleSwitch").remove()},ii=function(e){return e+="",e.replace(/target=\"_self\"/g,'target="_blank"')},ti=function(e){"transfer"===e.status&&($(".js-queueing").remove(),clearInterval(l),$(".js-switchRobot").remove())},ai=function(){var e=$(this),i=e.attr("docId"),t=e.attr("robotFlag"),a=e.attr("question"),s=e.attr("status"),r=e.attr("msgId");x({type:"post",url:"/chat/user/rbAnswerComment.action",dataType:"json",data:{uid:n,cid:o,docId:i,msgId:r,docName:a,status:s,robotFlag:t},success:function(i){if(i.ustatus!==-1&&i.ustatus!==-2){if(0===i.ustatus){var t=te.T0072;return void M.show(t)}var t=te.T0073;return void M.show(t)}if(1==s)var t=te.T0070;else var t=te.T0071;M.show(t),e.hide().siblings(".js-evaback").show(),1==s?(e.siblings(".js-okBack").addClass("yesBack"),e.siblings(".js-noBack").addClass("no2Back")):(e.siblings(".js-okBack").addClass("yes2Back"),e.siblings(".js-noBack").addClass("noBack")),e.siblings(".js-msgEvaluate").remove()}})},si=function(){try{var e=document.getElementById("chatPanel");e.scrollTop=e.scrollHeight}catch(i){return"滚动至底部失败"}},ni=function(){var e=(document.getElementById("chatPanel"),$(".cutoff")),i=$(".js-chatPanel"),t=e.parent(),a=e.offset().top-t.offset().top;i.animate({scrollTop:a-25},300)},oi=function(){$(".js-chatSwitch").hide(),$(".js-fengefu1").hide(),$(".js-manual-remove").remove();for(var e=$(".js-msgBottomArea").length,i=0;i<e;i++)if(!$($(".js-msgBottomArea")[i]).attr("showEvaluate")){$(".js-msgBottomArea").remove();break}},ri=function(e){e.data.serviceOutDoc&&(ne=e.data.serviceOutDoc),e.data.serviceOutTime&&e.data.serviceOutDoc&&(oe=60*e.data.serviceOutTime),$(".js-switchRobot").remove()},li=function(){_=I(t,i),M=M(i);var e=i.apiConfig.invalidSessionFlag,a=i.apiInit.ustatus,s=i.apiInit.isVisit;if(e&&2===i.apiConfig.type&&1!==a&&2!=s){$(".js-chatSwitch").hide();var n={aname:ie.L10055,content:i.urlParams.adminHelloWord},o=doT.template(F.transferSayHello)(n);o=ii(o),i.apiConfig.adminHelloWordFlag&&u.append(o)}if(e&&4===i.apiConfig.type&&0==a&&2!=s){var n={aname:i.apiConfig.robotName,content:i.urlParams.robotHelloWord},o=doT.template(F.transferSayHello)(n);o=ii(o),i.apiConfig.robotHelloWordFlag&&u.append(o)}},ci=function(){var e=$(this).attr("data-src");$("body").append('<div class="videoLayer js-videoLayer"><span class="videoClose">×</span><div class="blackBG"><video class="bigVideo js-bigVideo" src="'+e+'" autoplay loop></video></div></div>'),$(".js-videoLayer").animate({opacity:"0.98"},800)},di=function(e){$(".js-videoLayer").animate({opacity:"0"},300,function(){$(".js-videoLayer").remove()})},ui=function(){h.show()},pi=function(){y="",h.hide()},fi=function(e){$.ajax({type:"post",url:"/chat-remote-assistance/remote-assistance/1/end",dataType:"json",data:{role:"user",sessionId:y},success:function(e){e&&"000000"===e.retCode&&pi()}})},mi=function(e){t.location="SobotRemoteAssistance://"+y;var i={title:te.T0173,downloadBtn1:te.T0174,downloadBtn2:te.T0175,activeLink:te.T0176},a=doT.template(F.remoteDownload)(i);h.html(a)},gi=function(){mi()},vi=function(e){$.ajax({type:"get",url:"/chat-remote-assistance/remote-assistance/1/downloadUserSunflower",dataType:"json",data:{os:e},success:function(e){if(e&&"000000"===e.retCode){var i=e.items[0].fileAddress;t.open(i)}}})},hi=function(){d=$(".js-chatPanel"),u=$(".js-chatPanelList"),$msgStatus=$(".js-msgStatus"),p=$(".js-titleName"),f=$(".js-infoBarLogo"),m=$(".js-header"),g=$(".js-queueing"),v=document.getElementById("newMsgAudio"),h=$(".js-remote")},yi=function(){T.on("core.initsession",ye),T.on("core.onreceive",Ie),T.on("core.keySwitchAdmin",we),T.on("core.transTypeSwitchAdmin",be),T.on("sendArea.send",Ee),T.on("sendArea.send.Td",Ee),T.on("sendArea.sendLeaveMsg",qe),T.on("sendArea.showFirstMsg",He),T.on("sendArea.sendNew",Ee),$(t).on("message",ue),T.on("core.msgresult",Ue),T.on("sendArea.msgresult",Ue),T.on("core.statechange",de),T.on("core.sessionclose",Xe),T.on("core.system",me),T.on("core.system_pc",De),T.on("sendArea.sendAreaSystemMsg",me),T.on("sendArea.robotOverTimeHandler",Ke),T.on("listMsg.openVoice",function(e){B=e}),T.on("listMsg.scrollToBottom",si),T.on("sendArea.wurlHandler",Ye),T.on("sendArea.revmoveChatSwitch",ei),T.on("sendArea.createUploadFile",Oe),T.on("sendArea.uploadFileProcess",Re),T.on("sendArea.createUploadImg",Be),T.on("sendArea.uploadFileFail",ze),T.on("sendArea.hideMsgBotBtn",oi),T.on("core.system",ti),T.on("core.transfersuccess",ri),u.delegate("img","click",function(){var e=$(this).attr("src"),i=$(this).attr("noJump");e.indexOf("data:")>=0||i||t.open(e)}),$(document.body).delegate(".js-unread","click",function(){ni(),$(".js-unread").css("display","none")}),$(t).resize(function(){ge()}),u.delegate(".js-answerBtn","click",Je),u.delegate(".js-answerBtnMutil","click",Me),u.delegate(".js-multiAnswerBtn","click",Qe),u.delegate(".js-msgStatus","click",Ge),u.delegate(".js-msgEvaluate","click",ai),u.delegate(".js-tmpInnerList","click",Le),u.delegate(".js-inputContent","click",Me),u.delegate(".js-inputContent_1511","click",Ae),u.delegate(".js-tranMultiGroup","click",Ce),u.delegate(".js-tmp2MultiMore","click",$e),u.delegate(".js-tmp1MultiMore","click",Se),u.delegate(".js-keySwitchAdmin","click",xe),$("body").delegate(".js_webchat_video","click",ci),$("body").delegate(".js-videoLayer","click",di),$("body").delegate(".js-bigVideo","click",function(e){e.stopPropagation()}),t.onfocus=function(){b=!0},t.onblur=function(){b=!1},d.on("scroll",function(){var e=d.scrollTop(),i=$(".cutoff"),t=($(".js-chatPanel"),i.parent());if(!(i.length<=0)){var a=i.offset().top-t.offset().top;e<a&&$(".js-unread").css("display","none")}}),h.delegate(".refuse-btn","click",fi),h.delegate(".accept-btn","click",mi),h.delegate(".js-download-win10","click",function(){vi("windows10")}),h.delegate(".js-download-win7","click",function(){vi("windows7")}),h.delegate(".js-active-btn","click",gi),h.delegate(".js-close-remote-modal","click",function(){pi()})},Ti=function(){n=i.apiInit.uid,o=i.apiInit.cid,hi(),li(),yi()};Ti()};i.exports=a},{"../../../common/comm.js":1,"../../../common/util/errorlog.js":30,"../../../common/util/listener.js":33,"../../../common/util/monitAjax.js":35,"../../../common/util/msgReminder.js":36,"../../../common/util/promise.js":37,"../sendArea/leaveMessage.js":55,"../util/datetime.js":59,"../util/qqFace.js":70,"../util/showTip.js":71,"./noticeMessage.js":43,"./pushEvaHandler.js":44,"./template.js":46}],43:[function(e,i,t){var a=function(i,t){var a,s,n,o,r,l=e("../../../common/util/listener.js"),c=(e("./template.js"),i.language.lan,i.language.text),d=i.apiConfig.announceTopFlag,u=function(){s.css("display","block"),n.html(i.apiConfig.announceMsg),n.find("a").attr("target","_blank"),n.height()>114&&(n.addClass("noticeInner-ellipsis-5"),r.css("display","block"),s.css("padding-bottom","30px"))},p=function(){var e=40,i=$(".js-chatPanelBody").width()-e;o.css("display","block"),o.css("width",i+"px"),n.hasClass("zd")||n.css("width",i+"px");var t=40;d&&($(".js-chatPanelBody").css("padding-top",t),n.css("overflow","hidden")),l.trigger("listMsg.noticeInit",{noticeMsgHeight:t})},f=function(){r.hasClass("openActive")?(r.removeClass("openActive").addClass("closeActive"),r.html(c.T0069),n.removeClass("noticeInner-ellipsis-5")):(r.addClass("openActive").removeClass("closeActive"),r.html(c.T0068),n.addClass("noticeInner-ellipsis-5"))},m=function(){},g=function(){$mainBox=$(".js-mainBox"),a=$mainBox.find(".js-header"),s=$mainBox.find(".js-noticeMsg"),o=$mainBox.find(".js-noticeMsgBox"),n=$mainBox.find(".js-noticeInner"),r=$mainBox.find(".js-openNotice")},v=function(){d&&$(t).resize(function(){p()}),r.on("click",f),l.on("listMsg.noticeToTop",m),l.on("listMsg.sideBarAfterNotice",p)},h=function(){g(),v(),u(),d&&p()};h()};i.exports=a},{"../../../common/util/listener.js":33,"./template.js":46}],44:[function(e,i,t){var a=function(i,t,a){var s,n=e("../../../common/util/listener.js"),o=e("./template.js"),r=e("../util/showTip.js"),l=!0,c=0,d={},u=1,p=0,f=e("../../../common/util/monitAjax.js")(i),m=i.language.lan,g=i.language.text,v=i.userInfo.color?i.userInfo.color:i.apiConfig.color,h=function(){$aLi=s.find("#pushStar li");for(var e=0,i=1;i<=$aLi.length;i++)$aLi[i-1].index=i,$($aLi[i-1]).bind("click",function(){switch(e=this.index){case 1:case 2:case 3:case 4:c=e,j();break;case 5:c=e,j()}s.find(".js-commit").css({"background-color":v,color:"#fff"})})},y=function(e){for(var i=0;i<$aLi.length;i++)$aLi[i].className=i<e?"on":""},T=function(){s.find("#pushStar li").unbind()},j=function(){w()},I=function(){if(l){l=!1;var e=[],t=s.find(".js-tag").length;if(s.find(".js-tag").each(function(){var i=$(this).html();$(this).hasClass("active")&&e.push(i)}),0==e.length&&d[4].isTagMust&&t>0)return showTipObj.show(g.T0104),void setTimeout(function(){l=!0},3e3);tag=e.join(","),1!=d[0].isQuestionFlag&&(u=-1),f({type:"post",url:"/chat/user/comment.action",dataType:"json",data:{cid:i.apiInit.cid,visitorId:i.apiInit.uid,score:5,tag:tag,remark:"",commentType:0,type:1,solved:u},success:function(e){1===e.status?(T(),showTipObj.show(g.T0032),s.undelegate(),s.find(".js-moregood").removeClass("perfect").html(g.T0025),s.find(".js-situation").css("display","none"),s.find(".js-evaluateSubmitArea").css("display","none"),1==u?(s.find(".js-unSolved").removeClass("unsolveActive"),s.find(".js-unSolved").css({background:"#fff",border:"1px solid #d6dbe5"}),s.find(".js-solved").css({background:v,border:"1px solid "+v}),s.find(".js-solved").removeClass("defaultSolveActive").addClass("solveActive")):0==u&&(s.find(".js-solved").removeClass("solveActive"),s.find(".js-solved").css({background:"#fff",border:"1px solid #d6dbe5"}),s.find(".js-unSolved").addClass("unsolveActive"),s.find(".js-unSolved").css({background:v,border:"1px solid "+v}))):showTipObj.show(g.T0033)},error:function(){showTipObj.show(g.T0033)}})}setTimeout(function(){l=!0},4e3)},b=function(){h()},w=function(){var e=0;e=s.find(".js-solved").hasClass("solveActive")?1:s.find(".js-unSolved").hasClass("unsolveActive")?2:0;var i={from:"push",score:c,resultFlag:!1,sourceType:0,commentType:0,solveActive:e};n.trigger("listMsg.toEvaluate",i)},x=function(e){$aLi=$("#pushStar li");var i=e.score,t=e.solved;1==t?(s.find(".js-unSolved").removeClass("unsolveActive"),s.find(".js-unSolved").css({background:"#fff",border:"1px solid #d6dbe5"}),s.find(".js-solved").css({background:v,border:"1px solid "+v}),s.find(".js-solved").removeClass("defaultSolveActive").addClass("solveActive")):0==t&&(s.find(".js-solved").removeClass("solveActive"),s.find(".js-solved").css({background:"#fff",border:"1px solid #d6dbe5"}),s.find(".js-unSolved").addClass("unsolveActive"),s.find(".js-unSolved").css({background:v,border:"1px solid "+v})),y(i),s.undelegate(),s.find(".js-moregood").removeClass("perfect").html(g.T0025),s.find(".js-situation").css("display","none"),s.find(".js-evaluateSubmitArea").css("display","none")},k=function(){$mainBox=$(".js-mainBox"),$chatPanelList=$(".js-chatPanelList")},F=function(){s.undelegate(),s.delegate(".js-commit","click",I),n.on("listMsg.closePushEva",T),n.on("sendArea.toPushEav",x),n.on("sendArea.reTopushEav",b),s.delegate(".js-solved","click",function(){$(this).hasClass("solveActive")||($(this).addClass("solveActive"),$(this).css({background:v,border:"1px solid "+v}),s.find(".unsolveActive").css({background:"#fff",border:"1px solid #d6dbe5"}),s.find(".js-unSolved").removeClass("unsolveActive")),u=1}),s.delegate(".js-unSolved","click",function(){$(this).hasClass("unsolveActive")||($(this).addClass("unsolveActive"),$(this).css({background:v,border:"1px solid "+v}),s.find(".solveActive").css({background:"#fff",border:"1px solid #d6dbe5"}),s.find(".js-solved").removeClass("solveActive")),u=0}),s.delegate(".js-tag","click",function(){$(this).hasClass("active")?($(this).removeClass("active"),$(this).css({background:"#fff",color:"#8a9699",border:"1px solid #e0e9e8"})):($(this).addClass("active"),$(this).css({background:v,color:"#fff",border:"1px solid "+v}))}),s.delegate(".js-evaluateSubmit","click",I)},C=function(){f({type:"get",url:"/chat/user/satisfactionMessage.action",dataType:"json",data:{uid:i.apiInit.uid},success:function(e){if(1===e.status){d=e.data,p=e.defaultType||0,showTipObj=r(i),$chatPanelList.find(".js-zhichipushEva")&&$chatPanelList.find(".js-zhichipushEva").remove();var t=a.aname.length>4?a.aname.substr(0,4)+"...":a.aname,l=[];e.data&&e.data.length&&e.data.forEach(function(e,i){5==e.score&&(l=e.labelName?e.labelName.split(","):[])});var c={config:d,language:m,languageText:g,subName:t,aname:a.aname,defaultType:p,tags:l},u=doT.template(o.pushEvaMsg)(c);s=$(u),$chatPanelList.append(s),h(),F(),n.trigger("listMsg.scrollToBottom")}},error:function(){r.show("请检查网络链接")}})},S=function(){k(),C()};S()};i.exports=a},{"../../../common/util/listener.js":33,"../../../common/util/monitAjax.js":35,"../util/showTip.js":71,"./template.js":46}],45:[function(e,i,t){var a=function(i,t,a){var s,n,o,r,l,c,d,u,p,f,m,g,v,h,y,T,j,I,b=e("../../../common/util/listener.js"),w=(e("../../../common/util/load.js")(),e("./template.js")),x=(e("../../../common/comm.js"),e("../../../common/util/monitAjax.js")(t)),k=t.language.text,F=0,C=42,S=0,L=1,M=0,A=0,P=80,D=120,_=[],N=function(){var e=doT.template(w.sideBarMenu)(_);p.append(e),P*M>F?(I=80,A=F-C,I-A%I>1&&(I=A/Math.floor(A/I)),S=Math.ceil(I*M/(A+1)),p.find("li").eq(0).css("border-left","1px solid #fff")):P*M<=F&&D*M>=F?(I=F/M,A=F,I-A%I>1&&(I=A/Math.floor(A/I)),g.css("display","none")):(I=120,A=F,I-A%I>5&&(I=A/Math.floor(A/I)),g.css("display","none")),n.css("width",F+"px"),u.css("width",A+1+"px"),p.css("width",I*M+"px"),p.find("li").css("width",I-1+"px");var e=doT.template(w.barMain)({list:_,languageText:k});v.append(e),$(".js-barInner:first").css("display","block"),$(".js-barAddress").html(h.html()),$(".js-barRobotName").html(y.html()),$(".js-barRobotName").attr("title",y.html()),t.apiConfig.invalidSessionFlag&&2===t.apiConfig.type&&0===t.apiInit.ustatus?$(".js-barHeadImg").attr("src","https://img.sobot.com/console/common/face/admin.png"):$(".js-barHeadImg").attr("src",t.apiConfig.robotLogo),$(".js-customInner").find("a").attr("target","_blank"),$(".js-barInner2 img").on("click",function(){var e=$(this).attr("src");a.open(e)}),setTimeout(function(){b.trigger("listMsg.sideBarAfterNotice")},50),R()},R=function(){var e=r.width()-F-2;e<360&&(e=360);var i=$("#zcChat").outerHeight()-r.outerHeight()-p.outerHeight()-20;v.css({height:i}),s.css("min-width",F+360+2+"px"),o.css("width",e+"px");var t=p.find("li.barMenuActive").index(),a=l.find(".js-barInner").eq(t).find("iframe");a.css({height:i+Math.floor(11*Math.random())}),setTimeout(function(){a.css({height:i-5})},3),d.css("width",e+"px"),$(".barInner2").css("height",c.height()+10+"px")},O=function(){L<S&&(L+=1),z(L)},B=function(){L>1&&(L-=1),z(L)},z=function(e){currentMarginLeft=-A*(e-1),p.stop(!0).animate({"margin-left":currentMarginLeft},500)},E=function(){setTimeout(function(){var e=p.css("marginLeft");"0px"===e?(f.addClass("noAbleLeftBtn").removeClass("hoverBtn"),m.removeClass("noAbleRightBtn").addClass("hoverBtn")):L===S?(m.addClass("noAbleRightBtn").removeClass("hoverBtn"),f.removeClass("noAbleLeftBtn").addClass("hoverBtn")):(f.removeClass("noAbleLeftBtn").addClass("hoverBtn"),m.removeClass("noAbleRightBtn").addClass("hoverBtn"))},600)},q=function(){$(this).addClass("barMenuActive").siblings().removeClass("barMenuActive"),$(".js-barInner").css("display","none");var e=$(this).attr("data-tab");$("#"+e).css("display","block"),R()},H=function(e){if(e.displayField||!e.serviceInfo||e.serviceInfo.displayField){if("object"!=typeof e.serviceInfo)return!1;e.displayField=e.displayField||e.serviceInfo.displayField,"string"==typeof e.displayField&&(e.displayField=e.displayField.split(",")||[]);var i=doT.template(w.cusCard)({data:e,languageText:k});$(".js-barCard").html(i),$(".js-barHeadImg").attr("src",e.aface||e.serviceInfo.face)}},W=function(){l=$(i),s=$(".js-mainBox"),n=$(".js-rightBar"),o=$(".js-chatPanelBody"),r=$(".js-header"),c=$(".js-chatPanel"),d=$(".js-footer"),u=$(".js-barMenuWidely"),p=$(".js-barMenu"),f=$(".js-prev"),m=$(".js-next"),g=$(".js-menuBtn"),v=$(".js-barMain"),h=$(".js-infoBarCompany"),y=$(".js-titleName"),T=$(".js-barRobotName"),j=$(".js-barAddress")},U=function(){$(a).on("resize",R),f.on("click",B),m.on("click",O),g.on("click",E),p.delegate("li","click",q),b.on("listMsg.artificial",H)},G=function(){x({type:"post",url:"/chat/user/querySideBar.action ",dataType:"json",data:{sysNum:t.sysnum,source:t.userInfo.source,uid:t.apiInit.uid||"",channelFlag:t.urlParams.channelFlag||"",chatFlag:1},success:function(e){if(1===t.apiConfig.sideBarStatus){F=t.apiConfig.sideBarWidth;for(var i=0;i<e.list.length;i++)1===e.list[i].menuStatus&&_.push(e.list[i]);M=_.length,W(),U(),N()}}})};G()};i.exports=a},{"../../../common/comm.js":1,"../../../common/util/listener.js":33,"../../../common/util/load.js":34,"../../../common/util/monitAjax.js":35,"./template.js":46}],46:[function(e,i,t){var a={},s='<li id="{{=it.id||""}}" class="clearfix js-queueing"><div class="systemMsg"><div class="systemMsgText">{{=it.content}}</div></div></li>',n='<li id="{{=it.id||""}}" class="clearfix js-serviceOff"><div class="systemMsg"><div class="systemMsgText">{{=it.content}}</div></div></li>',o='<li class="clearfix agree-author"><div class="agree-author-desc">温馨提示：您在使用本系统客服功能时，我们可能会收集、使用、储存、分享您的必要信息，您的会话记录可能会被分享至您接入本系统的渠道方，希望您在会话前完整阅读<a target="_blank" href="https://www.sobot.com/clausetext.html">《隐私政策》</a>。您开始使用我们的服务时，即意味着同意我们按照本<a target="_blank" href="https://www.sobot.com/clausetext.html">《隐私政策》</a>处理您的相关信息。如有异议，请终止本会话。</div></li>',r='<li id="" class="clearfix js-zhichipushEva zhichipushEva"><div class="systemMsg"><div class="systemMsgPushEva"><div class="pushEvaluate js-pushEvaluate">{{if(it.config[0].isQuestionFlag){}}<p class="pushEvaTitle"><label class="aname" title="{{=it.aname}}">{{=it.subName}}</label>{{=it.languageText.T0093}}</p><div class="operateType"><p class="operateTypeTitle"><label class="aname" title="{{=it.aname}}">{{=it.subName}}</label>{{=it.languageText.T0106}}</p><div class="operateTypeBtn"><p class="solve solved js-solved defaultSolveActive"><span></span>{{=it.languageText.T0041}}</p><p class="solve unSolved js-unSolved" style="margin-left:25px;"><span></span>{{=it.languageText.T0042}}</p></div></div>{{}else{}}<p class="pushEvaTitle" style="padding-bottom: 10px;"><label class="aname" title="{{=it.aname}}">{{=it.subName}}</label>{{=it.languageText.T0093}}</p>{{}}}<div id="pushStar"><ul>{{if(it.defaultType == 0){}}<li class="on"><a href="javascript:;">1</a></li><li class="on"><a href="javascript:;">2</a></li><li class="on"><a href="javascript:;">3</a></li><li class="on"><a href="javascript:;">4</a></li><li class="on"><a href="javascript:;">5</a></li>{{}else{}}<li class="js-toSideEvaluate"><a href="javascript:;">1</a></li><li class="js-toSideEvaluate"><a href="javascript:;">2</a></li><li class="js-toSideEvaluate"><a href="javascript:;">3</a></li><li class="js-toSideEvaluate"><a href="javascript:;">4</a></li><li class="js-toSideEvaluate"><a href="javascript:;">5</a></li>{{}}}</ul></div>{{if(it.defaultType == 0){}}<p class="perfect moregood js-moregood">{{=it.languageText.T0164}}</p>{{}else{}}<p class="moregood js-moregood">{{=it.languageText.T0107}}</p>{{}}}{{if(it.defaultType == 0){}}<div class="situation js-situation">{{for(var i=0;i<it.tags.length;i++){}}{{if(i%2==0){}}<span class="tag js-tag">{{=it.tags[i]}}</span>{{}else{}}<span class="tag js-tag" style="margin-right:0">{{=it.tags[i]}}</span>{{}}}{{}}}</div><div class="evaluateSubmitArea js-evaluateSubmitArea"><a class="submit js-evaluateSubmit js-submitTheme" href="#">{{=it.languageText.T0029}}</a></div>{{}}}</div></div></div></li>',l='<div class="systemMsg"><div class="systemMsgText">{{=it.content}}</div></div>',c='<li class="clearfix magBox leftMsg"><p class="leftName">{{=it.list.senderName}}</p><div class="msgDiv"><div class="msgText">{{=it.list.msg}}</div></div></li>',d='<li class="clearfix magBox leftMsg">{{if(it.global.apiConfig.type == "5" || it.global.apiConfig.type == "6"){}}<p class="leftName">{{=it.global.apiConfig.cardNikeName }}</p>{{}else{}}<p class="leftName">{{=it.aname}}</p>{{}}}<div class="msgDiv"><div class="msgText">{{=it.content}}</div></div></li>',u='{{if(it.aname){ }}{{if(it.revokeFlag){}}<li class="clearfix magBox leftMsg"><div class="systemMsg"><div class="systemMsgText">您有一条消息被撤回</div></div></li>{{}else{}}<li class="clearfix magBox leftMsg" data-msg-id="{{=it.msgId}}" creattime="{{=it.t||""}}"><p class="leftName">{{=it.aname||""}}</p>{{if(it.msgType==24){}}<div class="msgDiv"><div class="msgText"><a href="{{=it.miniPage.url}}" target="_blank"><div class="goods-wrap"><div class="goods-thum">{{if(it.miniPage.thumbnail){ }}<img src="{{=it.miniPage.thumbnail}}">{{}}}</div><div class="goods-detail"><p class="goods-title" title="{{=it.miniPage.title}}">{{=it.miniPage.title}}</p><p class="goods-abstract" title="{{=it.miniPage.description}}">{{=it.miniPage.description}}</p><p class="goods-label" title="{{=it.miniPage.label}}"><span class="rmb-icon"></span>{{=it.miniPage.label}}</p></div></div></a></div></div>{{}else if(it.msgType==25){ }}<div class="msgDiv"><div class="msgText"><a class="order-wrapA" href="{{=it.miniPage.orderUrl}}" target="_blank"><div class="order-wrap"><div class="order-desc fixed">{{if(it.miniPage.goods[0].pictureUrl){}}<div class="order-pic"><img src="{{=it.miniPage.goods[0].pictureUrl}}" alt=""></div>{{}}}{{if(it.miniPage.goods.length>0){}}<div class="order-text"><div class="order-name">{{=it.miniPage.goods[0].name}}{{if(it.miniPage.goods.length>1){}}等{{=it.miniPage.goods.length}}件商品{{}}}</div><div class="order-tip">{{if(it.miniPage.goodsCount){}}<span>{{=it.miniPage.goodsCount}}件商品，</span>{{}}}{{if(it.miniPage.totalFee){}}<span>合计￥{{=it.miniPage.totalFee/100}}</span>{{}}}</div></div>{{}}}</div><div class="order-info">{{if(it.miniPage.orderStatus){}}<div class="order-status">订单状态：<span style="color:#F6A623">{{=it.miniPage.orderStatusNameList[it.miniPage.orderStatus]}}</span></div>{{ } }}<div class="order-code">订单编号：{{=it.miniPage.orderCode}}</div>{{if(it.miniPage.createTime){}}<div class="order-time">下单时间：{{=it.miniPage.createTimeFormat}}</div>{{ } }}</div></div></a></div></div>{{}else if(it.ticketMsgFlag && it.msgType!=5){ }}<div class="editContent msgDiv {{if(it.from=="initHistory"){ }} noneClick {{ } }}"><div class="msgText">{{=it.msg||""}}</div>{{ }else{ }}<div class="msgDiv {{if(it.from=="initHistory"){ }} noneClick {{ } }}"><div class="msgText">{{=it.msg||""}}</div>{{ } }}{{if(it.pushInformation&&it.pushInformation.imgUrl){}}<img src="{{=it.pushInformation.imgUrl}}"  class="wsimg"  />{{ } }}{{if(it.optionList&&it.template==2){}}<div class="template2">{{for(var j=0;j<it.optionList.length;j++){}}<div class="dxx js-dxx" nodeId={{=it.nodeId}}><span>{{=it.optionList[j]}}</span></div>{{}}}</div>{{}}}{{if(it.showEvaluate||it.showArtificial){ }}<div class="msgBottomArea js-msgBottomArea" showEvaluate="{{=it.showEvaluate||""}}">{{if(it.showArtificial&&!it.wurl){ }}<span class="js-chatSwitch js-moduleSwitch msgChatSwitch"><i>{{=it.languageText.T0141}}</i></span>{{ } }}{{if(it.showArtificial&&it.wurl){ }}{{if(it.wurlOpenStyle){ }}<a href="{{=it.wurl}}" target="_blank" class="js-moduleSwitch msgChatSwitch"><i>{{=it.languageText.T0141}}</i></a>{{ }else{ }}<a href="{{=it.wurl}}" target="_parent" class="js-moduleSwitch msgChatSwitch"><i>{{=it.languageText.T0141}}</i></a>{{ } }}{{ } }}{{if(it.showEvaluate&&it.showArtificial){ }}<span class="js-fengefu1 fengefu">|</span>{{ } }}{{if(it.showEvaluate){ }}<span docId="{{=it.docId||""}}" robotFlag="{{=it.robotFlag||""}}" question="{{=it.question||""}}" msgId="{{=it.msgId||""}}" status="1" title="{{=it.languageText.T0142}}" class="js-msgEvaluate msgEvaluateOk msgChatEvaluate"><i>{{=it.languageText.T0142}}</i></span><span title="{{=it.languageText.T0142}}" class="js-evaback js-okBack hide msgChatEvaluate"><i>{{=it.languageText.T0142}}</i></span><span class="fengefu">|</span><span docId="{{=it.docId||""}}" robotFlag="{{=it.robotFlag||""}}" question="{{=it.question||""}}" msgId="{{=it.msgId||""}}" status="-1" title="{{=it.languageText.T0143}}" class="js-msgEvaluate msgEvaluateNo msgChatEvaluate"><i>{{=it.languageText.T0143}}</i></span><span title="{{=it.languageText.T0143}}" class="js-evaback js-noBack hide msgChatEvaluate"><i>{{=it.languageText.T0143}}</i></span>{{ } }}</div>{{ } }}</div>{{if(it.optionList&&it.template==1){}}<div style="display:flex;flex-wrap:wrap">{{for(var j=0;j<it.optionList.length;j++){}}<div class="ckdxx js-dxx" nodeId={{=it.nodeId}}><span>{{=it.optionList[j]}}</span></div>{{}}}</div>{{}}}{{if(it.pushInformation&&it.pushInformation.copyFlag==1){}}<div class="copy" message="{{=it.pushInformation.message}}"><span>复制微信</span></div>{{ } }}{{ if(it.ticketMsgFlag){ }}<div class="queryAll"><span class="openEdit"><span class="texts">查看全部</span><i></i></span></div>{{ } }}</li>{{if(it.dangerWarnFlag){}}<li class="clearfix magBox leftMsg"><div class="systemMsg"><div class="systemMsgText">{{=it.language.L10041||""}}</div></div></li>{{}}}{{ } }}{{ } }}',p='<div><div class="group-layer js-group-layer"></div><div class="group-outer js-group-outer pc-leaveMessage-layer"><p class="group-title">请选择留言模板<span class="close_button js-cancel-btn js-group-cancel"></span></p><div class="group-main"><ul class="clearfix">{{  for(var i=0;i<it.list.length;i++){ }}{{ var item = it.list[i];}}<li class="js-item" data-id="{{=item.templateId}}">{{=item.templateName}}</li>{{  } }}</ul></div></div></div>',f='{{if(it.source&&it.source==="uploadImg"){}}<li class="clearfix imgMagBox magBox rightMsg" id="{{=it.dateuid||""}}" creattime="{{=it.t||""}}"><div class="msgDiv"><div id="msgStatus{{=it.dateuid||""}}" class="msgStatus js-msgStatus msgsending"></div><div class="msgText">{{=it.msg||""}}</div><div class="uploadImgLayer js-uploadImgLayer"><p id="imgCancel{{=it.dateuid||""}}" class="cancelUploadImg js-cancelUploadImg">取消上传</p></div></div></li>{{ }else if(it.source&&it.source==="uploadFile"){ }}<li class="clearfix fileMagBox magBox rightMsg" id="{{=it.dateuid||""}}" creattime="{{=it.t||""}}"><div class="msgDiv"><div class="msgText"><div class="msgFileIco js-msgFileIco {{=it.fileIcoClass}}"></div><div class="msgFileDetail js-msgFileDetail"><p class="filename" title="{{=it.filename}}">{{=it.filename}}</p><span class="fileSize js-fileSize">{{=it.filesize}}</span> <span class="sizeAfter js-sizeAfter">|</span> <div class="uploadFileProcess js-uploadFileProcess"><span class="processSpan js-processSpan"></span></div><span id="filecancel{{=it.dateuid}}" class="filecancel js-filecancel">{{=it.languageText.T0000}}</span><span class="filecanceled js-filecanceled">{{=it.languageText.T0159}}</span><span class="filefail js-filefail">{{=it.languageText.T0084}}</span><a class="filedownload js-filedownload" target="_blank">{{=it.languageText.T0160}}</a></div></div></div></li>{{ }else{ }}<li class="clearfix magBox rightMsg" id="{{=it.dateuid||""}}" creattime="{{=it.t||""}}"><div class="msgDiv">{{if(it.from!=="initHistory"){}}<div id="msgStatus{{=it.dateuid||""}}" class="msgStatus js-msgStatus"></div>{{ } }}<div class="msgText">{{=it.msg||""}}</div></div>{{if(it.leaveMsgFlag==1){}}<span class="xinfeng"></span>{{}}}</li>{{ } }}',m='<li id="cutoff" class="cutoff"><span class="cutleft"></span>{{=it.content}}<span class="cutright"></span></li>',g='<li class="clearfix sysData"><p class="msgData">{{=it}}</p></li>',v='<li class="clearfix magBox leftMsg js-SwitchAdminsMsg"><p class="leftName">{{=it.aname||""}}</p><div class="msgDiv"><div class="msgText">{{=it.tipsMessage||"您的消息涉及到重点业务，需要人工客服帮您解决，您可以选择以下技能组："}}<div class="msgwrap leftMsg"><div class="msgOuter js-msgOuter"><div style="margin-bottom:10px;">{{=it.answer?it.answer:""}}</div><p>{{=it.stripe?it.stripe:""}}</p><ul class="sugguestions">{{for(var i=0,lan=it.list ||[] ;i<lan.length;i++){ }}<li style="color:#4298ba"><a href="#0" class="js-keySwitchAdmin keySwitchAdmin" data-id="{{=it.list[i].groupId}}" keyword="{{=it.keyword}}" keywordId="{{=it.keywordId}}">{{=it.list[i].groupName}}</a></li>{{ } }}</ul></div></div></div></div></li>',h='<div class="msgwrap leftMsg"><div class="msgOuter js-msgOuter"><div style="margin-bottom:10px;">{{=it.answer?it.answer:""}}</div><p>{{=it.stripe?it.stripe:""}}</p><ul class="sugguestions sugguestions">{{for(var i=0,lan=it.list ||[] ;i<lan.length;i++){ }}{{if(it.isHistory){ }}<li style="color:#4298ba">{{=i+1}}. <a href="#0" data-num="{{=i+1}}" class="js-answerBtn" style="color:#4298ba">{{=it.list[i]}}</a></li>{{}else{}}<li style="color:#4298ba">{{=i+1}}. <a href="#0" data-num="{{=i+1}}" class="js-answerBtn" style="color:#4298ba" data-docid="{{=it.list[i]["docId"]}}">{{=it.list[i]["question"]}}</a></li>{{}}}{{ } }}</ul></div></div>',y='<div class="msgwrap leftMsg"><div class="msgOuter js-msgOuter"><div style="margin-bottom:10px;">{{=it.answer?it.answer:""}}</div><p>{{=it.stripe?it.stripe:""}}</p><ul class="sugguestions-change">{{for(var i=0,lan=it.list ||[] ;i<lan.length;i++){ }}{{if(it.isHistory){ }}<li style="color:#4298ba">{{=i+1}}. <a href="#0" data-num="{{=i+1}}" class="js-answerBtn" style="color:#4298ba">{{=it.list[i]}}</a></li>{{}else{}}<li style="color:#4298ba">{{=i+1}}. <a href="#0" data-num="{{=i+1}}" class="js-answerBtn" style="color:#4298ba" data-docid="{{=it.list[i]["docId"]}}">{{=it.list[i]["question"]}}</a></li>{{}}}{{ } }}</ul></div>{{if(it.count&&it.oldsum>it.zsum){}}<div class="changeGroup js-changeGroup">换一组<i></i></div>{{}}}',T='{{for(var i=0,lan=it.list ||[] ;i<lan.length;i++){ }}{{if(it.isHistory){ }}<li style="color:#4298ba">{{=i+1}}. <a href="#0" data-num="{{=i+1}}" class="js-answerBtn" style="color:#4298ba">{{=it.list[i]}}</a></li>{{}else{}}<li style="color:#4298ba">{{=i+1}}. <a href="#0" data-num="{{=i+1}}" class="js-answerBtn" style="color:#4298ba" data-docid="{{=it.list[i]["docId"]}}">{{=it.list[i]["question"]}}</a></li>{{}}}{{ } }}',j='<div class="msgwrap leftMsg"><div class="msgOuter js-msgOuter"><p style="{{=it.stripe?"margin-bottom:10px":""}}">{{if(it.answerStrip){}}{{for(var i=0;i<it.answerStrip.length;i++){}}{{if(i==it.answerStrip.length-1){}}<p class="beginLan">{{=it.answerStrip[i]||""}}</p>{{}else{}}<p class="">{{=it.answerStrip[i]||""}}</p>{{}}}{{}}}{{}}}</p><div>{{=it.answer?it.answer:""}}</div><div>{{=it.stripe?it.stripe:""}}</div><ul class="sugguestions">{{for(var i=0,lan=it.list ||[] ;i<lan.length;i++){ }}{{if(it.isHistory){ }}<li style="color:#4298ba">{{=i+1}}. <a href="#0" data-num="{{=i+1}}" class="js-answerBtn" style="color:#4298ba">{{=it.list[i]}}</a></li>{{}else{}}<li style="color:#4298ba">{{=i+1}}. <a href="#0" data-num="{{=i+1}}" class="js-answerBtn" style="color:#4298ba" data-docid="{{=it.list[i]["docId"]}}">{{=it.list[i]["question"]}}</a></li>{{}}}{{ } }}</ul></div></div>',I='{{for(var i=0;i<it.length;i++){ }}{{if(i==0){ }}<li data-tab="{{=it[i].sidebarId}}" class="barMenuActive"><span title="{{=it[i].menuName}}">{{=it[i].menuName}}</span></li>{{}else{}}<li data-tab="{{=it[i].sidebarId}}"><span title="{{=it[i].menuName}}">{{=it[i].menuName}}</span></li>{{}}}{{}}}',b='{{var list = it.list;}}{{for(var i=0;i<list.length;i++){ }}{{if(list[i].menuType===0){ }}<div id="{{=list[i].sidebarId}}" class="barInner js-barInner js-barCard"><div class="barInfo"><img class="headimage js-barHeadImg"/><p class="headname js-barRobotName"></p></div><div class="barInformation js-barInformation"><dl><dt>{{=it.languageText.T0061}}</dt><dd class="js-barAddress"></dd></dl></div></div>{{}else if(list[i].menuType===1){}}<div id="{{=list[i].sidebarId}}" class="js-barInner js-barInner2 barInner barInner2 js-customInner"><p>{{=list[i].customContent||""}}</p></div>{{}else{}}<div id="{{=list[i].sidebarId}}" class="js-barInner barInner"><iframe name="barIfm" id="barIfm" src="{{=list[i].menuUrl||""}}" scrolling="yes" frameborder="0"></iframe></div>{{}}}{{}}}',w='{{var list = it.data;}}<div class="barInfo">{{if(list.displayField[0]==="1"){ }}<img class="headimage js-barHeadImg"/>{{}}}{{if(list.displayField[2]==="1"){ }}<p class="headname js-barCusName"">{{=list.serviceInfo.nickName||"-"}}</p>{{}}}</div><div class="barInformation">{{if(list.displayField[4]==="1"){ }}<div id="{{=list.displayField[4]}}" class="inforLi"><label>{{=it.languageText.T0063}}</label><span>{{=list.serviceInfo.serviceNo||"-"}}</span></div>{{}}}{{if(list.displayField[6]==="1"){ }}<div class="inforLi"><label>{{=it.languageText.T0064}}</label><span>{{=list.serviceInfo.name||"-"}}</span></div>{{}}}{{if(list.displayField[8]==="1"){ }}<div class="inforLi"><label>{{=it.languageText.T0067}}</label><span>{{=list.serviceInfo.phone||"-"}}</span></div>{{}}}{{if(list.displayField[1]==="1"){ }}<div class="inforLi"><label>{{=it.languageText.T0066}}</label><span>{{=list.serviceInfo.tel||"-"}}</span></div>{{}}}{{if(list.displayField[3]==="1"){ }}<div class="inforLi"><label>{{=it.languageText.T0062}}</label><span>{{=list.serviceInfo.email||"-"}}</span></div>{{}}}{{if(list.displayField[5]==="1"){ }}<div class="inforLi"><label>Q Q：</label><span>{{=list.serviceInfo.qq||"-"}}</span></div>{{}}}{{if(list.displayField[7]==="1"){ }}<dl><dt>{{=it.languageText.T0065}}</dt><dd>{{=list.serviceInfo.remark||"-"}}</dd></dl>{{}}}</div>',x='<div class="js-closeWindow"><div class="closeLayer js-closeLayer"></div><div class="closeEvaluate js-closeEvaluate"><span class="closeEvaBtn js-closeEvaBtn"></span><p class="closeEvaTitle">{{=it.languageText.T0096}}</p><div id="closeStar"><ul><li><a href="javascript:;">1</a></li><li><a href="javascript:;">2</a></li><li><a href="javascript:;">3</a></li><li><a href="javascript:;">4</a></li><li><a href="javascript:;">5</a></li></ul></div><div class="btnGroup"><span class="js-toSideEvaluate toSideEvaluate" style="display:none">{{=it.languageText.T0094}}</span><span class="js-commit commit" style="display:none">{{=it.languageText.T0095}}</span></div></div></div>',k='<div class="js-closeWindow"><div class="closeLayer js-closeLayer"></div><div class="closeEvaluate js-closeEvaluate"><span class="closeEvaBtn js-closeEvaBtn"></span><p class="closeEvaTitle">{{=it.languageText.T0098}}</p><div class="robotChose"><span class="js-isques js-robotResult evaluateok" resultFlag="true"><i></i>{{=it.languageText.T0041}}</span><span class="js-noques js-robotResult evaluateno" resultFlag="false"><i></i>{{=it.languageText.T0042}}</span></div><div class="btnGroup"><span class="js-toSideEvaluate toSideEvaluate" style="display:none">{{=it.languageText.T0094}}</span><span class="js-commit commit" style="display:none">{{=it.languageText.T0095}}</span></div></div></div>',F='<div class="js-evamsg evamsg"><p>{{=it.language.L10037}}</p></div>',C='<div class="js-evamsg evamsg" style="color:#cb1f16"><p>{{=it.language.L10038}}</p></div>',$='{{if(it.style){ }}<div class="noticeMsgBox js-noticeMsgBox"><span class="noticeVoice"></span><a class="noticeMsg js-noticeMsg" target="_blank"><div class="noticeInner js-noticeInner zd"></div><span class="openUrl js-openUrl"></span> </a> </div>{{}else{}}<li class="noticeMsg js-noticeMsg"><span class="noticeVoice"></span><div class="noticeInner js-noticeInner"></div><span class="openNotice js-openNotice openActive">{{=it.languageText.T0068}}</span> </li>{{}}}',S='<div class="sessionTmp0 js-tmp{{=it.multiDiaRespInfo.conversationId||""}}" >{{if(it.multiDiaRespInfo.endFlag&&it.multiDiaRespInfo.answerStrip){}}{{for(var i=0;i<it.multiDiaRespInfo.answerStrip.length;i++){}}{{if(i==it.multiDiaRespInfo.answerStrip.length-1){}}<p class="beginLan">{{=it.multiDiaRespInfo.answerStrip[i]||""}}</p>{{}else{}}<p class="">{{=it.multiDiaRespInfo.answerStrip[i]||""}}</p>{{}}}{{}}}{{}else if(!it.multiDiaRespInfo.endFlag&&it.multiDiaRespInfo.remindQuestion){}}{{for(var i=0;i<it.multiDiaRespInfo.remindQuestion.length;i++){}}<p>{{=it.multiDiaRespInfo.remindQuestion[i]||""}}</p>{{}}}{{}}}<p>{{=it.multiDiaRespInfo.answer||""}}</p>{{if(it.multiDiaRespInfo.interfaceRetList){}}<div class="interfaceRetListArea"><ul class="js-interfaceRetList{{=it.multiDiaRespInfo.conversationId||""}}" style="pointer-events:{{=it.clickFlag?"none":"auto"}};">{{for(var i=0;i<it.multiDiaRespInfo.interfaceRetList.length;i++){}}<li class="tmp0InnerList js-tmpInnerList" {{if(i==it.multiDiaRespInfo.interfaceRetList.length-1){}} style="border-bottom: 1px solid #d6dbe5"{{}}}conversationId="{{=it.multiDiaRespInfo.conversationId}}" clickFlag="{{=it.multiDiaRespInfo.clickFlag}}" level="{{=it.multiDiaRespInfo.level}}" data-index="{{=i}}">{{if(it.multiDiaRespInfo.endFlag&&it.multiDiaRespInfo.interfaceRetList[i].anchor){}}<a class="viewImg" href="{{=it.multiDiaRespInfo.interfaceRetList[i].anchor}}" target="_blank" style="width:{{=it.multiDiaRespInfo.interfaceRetList[i].thumbnail?"22%":"0"}};">{{if(it.multiDiaRespInfo.interfaceRetList[i].thumbnail){}}<img noJump="true" src="{{=it.multiDiaRespInfo.interfaceRetList[i].thumbnail}}">{{}else{}}<span style="display:inline-block"></span>{{}}}</a>{{}else{}}<div class="viewImg" style="width:{{=it.multiDiaRespInfo.interfaceRetList[i].thumbnail?"22%":"0"}};">{{if(it.multiDiaRespInfo.interfaceRetList[i].thumbnail){}}<img noJump="true" src="{{=it.multiDiaRespInfo.interfaceRetList[i].thumbnail}}">{{}else{}}<span style="display:inline-block"></span>{{}}}</div>{{}}}<div class="innerRight" style="width:{{=it.multiDiaRespInfo.interfaceRetList[i].thumbnail?"72%":"92%"}};"><div class="rightTop">{{if(it.multiDiaRespInfo.endFlag&&it.multiDiaRespInfo.interfaceRetList[i].anchor){}}<a class="title" href="{{=it.multiDiaRespInfo.interfaceRetList[i].anchor}}" target="_blank">{{=it.multiDiaRespInfo.interfaceRetList[i].title||""}}</a>{{}else{}}<p class="title">{{=it.multiDiaRespInfo.interfaceRetList[i].title||""}}</a>{{}}}</div><div class="rightMid"><p class="mark1">{{=it.multiDiaRespInfo.interfaceRetList[i].summary||""}}</p></div><div class="rightBottom"><p class="mark2">{{=it.multiDiaRespInfo.interfaceRetList[i].label||""}}</p><p class="mark4">{{=it.multiDiaRespInfo.interfaceRetList[i].tag||""}}</p></div></div><div style="clear:both"></div></li>{{}}}</ul></div>{{if(it.multiDiaRespInfo.interfaceRetList.length>3){}}{{if(it.from!="history"){}}<div class="tranMultiGroup js-tranMultiGroup" conversationId="{{=it.multiDiaRespInfo.conversationId||""}}" page="1"><span>换一组</span><i></i></div>{{}}}{{}}}{{}else{}}{{if(it.multiDiaRespInfo.endFlag){}}<p>{{=it.multiDiaRespInfo.answerStrip}}</p>{{}else{}}{{if(it.multiDiaRespInfo.endFlag&&it.from!="history"){}}<p>{{=it.multiDiaRespInfo.remindQuestion}}</p>{{}}}{{}}}{{}}}<div style="clear:both"></div> </div>',L='<div class="sessionTmp1 js-tmp{{=it.multiDiaRespInfo.conversationId||""}}">{{if(it.multiDiaRespInfo.endFlag&&it.multiDiaRespInfo.answerStrip){}}{{for(var i=0;i<it.multiDiaRespInfo.answerStrip.length;i++){}}{{if(i==it.multiDiaRespInfo.answerStrip.length-1){}}<p class="beginLan">{{=it.multiDiaRespInfo.answerStrip[i]||""}}</p>{{}else{}}<p class="">{{=it.multiDiaRespInfo.answerStrip[i]||""}}</p>{{}}}{{}}}{{}else if(!it.multiDiaRespInfo.endFlag&&it.multiDiaRespInfo.remindQuestion){}}{{for(var i=0;i<it.multiDiaRespInfo.remindQuestion.length;i++){}}{{if(i==it.multiDiaRespInfo.remindQuestion.length-1){}}<p class="beginLan">{{=it.multiDiaRespInfo.remindQuestion[i]||""}}</p>{{}else{}}<p class="">{{=it.multiDiaRespInfo.remindQuestion[i]||""}}</p>{{}}}{{}}}{{}}}<ul class="tmp1InnerList js-tmp1List" style="pointer-events:{{=it.clickFlag?"none":"auto"}};">{{if(it.multiDiaRespInfo.interfaceRetList){}}{{for(var i=0;i<it.multiDiaRespInfo.interfaceRetList.length;i++){}}{{if(it.multiDiaRespInfo.endFlag&&it.multiDiaRespInfo.interfaceRetList[i].anchor){}}{{if(i<9){}}<li class="innerEle" title="{{=it.multiDiaRespInfo.interfaceRetList[i].title}}">{{}else{}}<li class="innerEle multiHide" title="{{=it.multiDiaRespInfo.interfaceRetList[i].title}}">{{}}}<a href="{{=it.multiDiaRespInfo.interfaceRetList[i].anchor}}" target="_blank">{{=it.multiDiaRespInfo.interfaceRetList[i].title}}</a></li>{{}else{}}{{if(i<9){}}<li class="innerEle js-tmpInnerList" clickFlag="{{=it.multiDiaRespInfo.clickFlag}}" conversationId="{{=it.multiDiaRespInfo.conversationId}}" data-index="{{=i}}" level="{{=it.multiDiaRespInfo.level}}" title="{{=it.multiDiaRespInfo.interfaceRetList[i].title}}">{{}else{}}<li class="innerEle js-tmpInnerList multiHide" clickFlag="{{=it.multiDiaRespInfo.clickFlag}}" conversationId="{{=it.multiDiaRespInfo.conversationId}}" data-index="{{=i}}" level="{{=it.multiDiaRespInfo.level}}" title="{{=it.multiDiaRespInfo.interfaceRetList[i].title}}">{{}}}{{=it.multiDiaRespInfo.interfaceRetList[i].title}}</li>{{}}}{{}}}{{}}} </ul>{{if(it.multiDiaRespInfo.interfaceRetList.length>9){}}{{if(it.from!="history"){}}<div class="multiMore js-tmp1MultiMore" page="1"><span>展开更多</span><i></i></div>{{}}}{{}}}<div style="clear:both"></div> </div>',M='<div class="sessionTmp2 js-tmp{{=it.multiDiaRespInfo.conversationId}}">{{if(it.multiDiaRespInfo.endFlag&&it.multiDiaRespInfo.answerStrip){}}{{for(var i=0;i<it.multiDiaRespInfo.answerStrip.length;i++){}}{{if(i==it.multiDiaRespInfo.answerStrip.length-1){}}<p class="beginLan">{{=it.multiDiaRespInfo.answerStrip[i]||""}}</p>{{}else{}}<p class="">{{=it.multiDiaRespInfo.answerStrip[i]||""}}</p>{{}}}{{}}}{{}else if(!it.multiDiaRespInfo.endFlag&&it.multiDiaRespInfo.remindQuestion){}}{{for(var i=0;i<it.multiDiaRespInfo.remindQuestion.length;i++){}}{{if(i==it.multiDiaRespInfo.remindQuestion.length-1){}}<p class="beginLan">{{=it.multiDiaRespInfo.remindQuestion[i]||""}}</p>{{}else{}}<p class="">{{=it.multiDiaRespInfo.remindQuestion[i]||""}}</p>{{}}}{{}}}{{}}}{{if(it.multiDiaRespInfo.interfaceRetList){}}<ul class="js-tmp2List" style="pointer-events:{{=it.clickFlag?"none":"auto"}};">{{for(var i=0;i<it.multiDiaRespInfo.interfaceRetList.length;i++){}}{{if(it.multiDiaRespInfo.endFlag&&it.multiDiaRespInfo.interfaceRetList[i].anchor){}}{{if(i>2){}}<li class="multiHide">{{}else{}}<li>{{}}}<a href="{{=it.multiDiaRespInfo.interfaceRetList[i].anchor}}" target="_blank"><div class="tmp2InnerList" {{if(i==0){}}style="border-top: 1px solid #d6dbe5"{{}}}>{{if(it.multiDiaRespInfo.interfaceRetList[i].thumbnail){}}<img class="viewImg" noJump="true" src="{{=it.multiDiaRespInfo.interfaceRetList[i].thumbnail}}"><div class="innerTop">{{}else{}}<div class="innerTop" style="width:97%">{{}}}<p class="title" title="{{=it.multiDiaRespInfo.interfaceRetList[i].title}}">{{=it.multiDiaRespInfo.interfaceRetList[i].title}}</p><p class="tag">{{=it.multiDiaRespInfo.interfaceRetList[i].tag||""}}</p></div><div class="innerBottom"><p class="summary">{{=it.multiDiaRespInfo.interfaceRetList[i].summary||""}}</p> </div><div style="clear:both"></div></div></a></li>{{}else{}}{{if(i>2){}}<li class="multiHide">{{}else{}}<li>{{}}}<div class="tmp2InnerList js-tmpInnerList" {{if(i==0){}}style="border-top: 1px solid #d6dbe5"{{}}} conversationId="{{=it.multiDiaRespInfo.conversationId}}" clickFlag="{{=it.multiDiaRespInfo.clickFlag}}" level="{{=it.multiDiaRespInfo.level}}"  data-index="{{=i}}">{{if(it.multiDiaRespInfo.interfaceRetList[i].thumbnail){}}<img class="viewImg" noJump="true" src="{{=it.multiDiaRespInfo.interfaceRetList[i].thumbnail}}"><div class="innerTop">{{}else{}}<div class="innerTop" style="width:97%">{{}}}<p class="title" title="{{=it.multiDiaRespInfo.interfaceRetList[i].title}}">{{=it.multiDiaRespInfo.interfaceRetList[i].title}}</p><p class="tag">{{=it.multiDiaRespInfo.interfaceRetList[i].tag||""}}</p></div><div class="innerBottom"><p class="summary">{{=it.multiDiaRespInfo.interfaceRetList[i].summary||""}}</p> </div><div style="clear:both"></div></div></li>{{}}}{{}}}</ul>{{if(it.multiDiaRespInfo.interfaceRetList.length>3){}}{{if(it.from!="history"){}}<div class="multiMore js-tmp2MultiMore" page="1"><span>展开更多</span><i></i></div>{{}}}{{}}}{{}}} </div>',A='<div class="sessionTmp3 js-tmpInnerList2 js-tmp{{=it.multiDiaRespInfo.conversationId||""}}" level="{{=it.multiDiaRespInfo.level}}"><div class="viewParent"><img class="viewImg" noJump="true" src="{{=it.multiDiaRespInfo.interfaceRetList[0].thumbnail}}"><div class="inner"><p class="title">{{=it.multiDiaRespInfo.interfaceRetList[0].title}}</p><p class="summary">{{=it.multiDiaRespInfo.interfaceRetList[0].summary}}</p>{{if(it.multiDiaRespInfo.endFlag&&it.multiDiaRespInfo.interfaceRetList[0].anchor){}}<a class="more" target="_blank" href="{{=it.multiDiaRespInfo.interfaceRetList[0].anchor}}">查看详情 ></a> </div>{{}else{}}<p class="more">查看详情 ></p>{{}}}<div style="clear:both"></div></div> </div>',P='<div class="sessionTmp4">{{if(it.multiDiaRespInfo.answerStrip){}}{{for(var i=0;i<it.multiDiaRespInfo.answerStrip.length;i++){}}{{if(i==it.multiDiaRespInfo.answerStrip.length-1){}}<p class="">{{=it.multiDiaRespInfo.answerStrip[i]||""}}</p>{{}else{}}<p class="">{{=it.multiDiaRespInfo.answerStrip[i]||""}}</p>{{}}}{{}}}{{}else if(it.multiDiaRespInfo.remindQuestion){}}{{for(var i=0;i<it.multiDiaRespInfo.remindQuestion.length;i++){}}{{if(i==it.multiDiaRespInfo.remindQuestion.length-1){}}<p class="">{{=it.multiDiaRespInfo.remindQuestion[i]||""}}</p>{{}else{}}<p class="">{{=it.multiDiaRespInfo.remindQuestion[i]||""}}</p>{{}}}{{}}}{{}}}{{if(it.multiDiaRespInfo.answerStrip||it.multiDiaRespInfo.remindQuestion){}}<p style="height:10px;width:100%;"></p>{{}}}<div ><p class="title">{{=it.multiDiaRespInfo.interfaceRetList[0].title}}</p> </div><div style="clear:both"></div> </div>',D='<div class="sessionTmp4">{{if(it.multiDiaRespInfo.answerStrip){}}{{for(var i=0;i<it.multiDiaRespInfo.answerStrip.length;i++){}}{{if(i==it.multiDiaRespInfo.answerStrip.length-1){}}<p class="">{{=it.multiDiaRespInfo.answerStrip[i]||""}}</p>{{}else{}}<p class="">{{=it.multiDiaRespInfo.answerStrip[i]||""}}</p>{{}}}{{}}}{{}else if(it.multiDiaRespInfo.remindQuestion){}}{{for(var i=0;i<it.multiDiaRespInfo.remindQuestion.length;i++){}}{{if(i==it.multiDiaRespInfo.remindQuestion.length-1){}}<p class="">{{=it.multiDiaRespInfo.remindQuestion[i]||""}}</p>{{}else{}}<p class="">{{=it.multiDiaRespInfo.remindQuestion[i]||""}}</p>{{}}}{{}}}{{}}}{{if(it.multiDiaRespInfo.answerStrip||it.multiDiaRespInfo.remindQuestion){}}<p style="height:10px;width:100%;"></p>{{}}}<div ><p class="title">{{=it.multiDiaRespInfo.interfaceRetList[0].tempStr}}</p> </div><div style="clear:both"></div> </div>',_='<div class="sessionTmp1">{{if(it.multiDiaRespInfo.answerStrip){}}{{for(var i=0;i<it.multiDiaRespInfo.answerStrip.length;i++){}}{{if(i==it.multiDiaRespInfo.answerStrip.length-1){}}<p class="beginLan">{{=it.multiDiaRespInfo.answerStrip[i]||""}}</p>{{}else{}}<p class="">{{=it.multiDiaRespInfo.answerStrip[i]||""}}</p>{{}}}{{}}}{{}else if(it.multiDiaRespInfo.remindQuestion){}}{{for(var i=0;i<it.multiDiaRespInfo.remindQuestion.length;i++){}}{{if(i==it.multiDiaRespInfo.remindQuestion.length-1){}}<p class="beginLan">{{=it.multiDiaRespInfo.remindQuestion[i]||""}}</p>{{}else{}}<p class="">{{=it.multiDiaRespInfo.remindQuestion[i]||""}}</p>{{}}}{{}}}{{}}}<ul class="tmp1InnerList">{{for(var i=0;i<it.contentAry.length;i++){}}<li class="innerEle js-inputContent js-tmp{{=it.multiDiaRespInfo.conversationId}}" conversationId="{{=it.multiDiaRespInfo.conversationId}}" title="{{=it.contentAry[i]}}" outPutParamList="{{=it.multiDiaRespInfo.outPutParamList}}" level="{{=it.multiDiaRespInfo.level}}">{{=it.contentAry[i]}}</li>{{}}} </ul><div style="clear:both"></div> </div>',N='{{if(it.multiDiaRespInfo.retCode=="000000"){}}<div class="sessionTmp1511">{{if(it.multiDiaRespInfo.answerStrip){}}{{for(var i=0;i<it.multiDiaRespInfo.answerStrip.length;i++){}}{{if(i==it.multiDiaRespInfo.answerStrip.length-1){}}<p class="beginLan">{{=it.multiDiaRespInfo.answerStrip[i]||""}}</p>{{}else{}}<p class="">{{=it.multiDiaRespInfo.answerStrip[i]||""}}</p>{{}}}{{}}}{{}else if(it.multiDiaRespInfo.remindQuestion){}}{{for(var i=0;i<it.multiDiaRespInfo.remindQuestion.length;i++){}}{{if(i==it.multiDiaRespInfo.remindQuestion.length-1){}}<p class="beginLan">{{=it.multiDiaRespInfo.remindQuestion[i]||""}}</p>{{}else{}}<p class="">{{=it.multiDiaRespInfo.remindQuestion[i]||""}}</p>{{}}}{{}}}{{}}}<ul class="tmp1InnerList">{{for(var i=0;i<it.contentAry.length;i++){}}<li class="innerEle js-inputContent_1511 js-tmp{{=it.multiDiaRespInfo.conversationId}}" conversationId="{{=it.multiDiaRespInfo.conversationId}}" title="{{=it.titleAry[i]}}" content="{{=it.contentAry[i]}}" level="{{=it.multiDiaRespInfo.level}}">• {{=it.titleAry[i]}}：{{=it.contentAry[i]}}</li>{{}}} </ul><div style="clear:both"></div> </div>{{}else{}}<div class="sessionTmp1511"><p>{{=it.multiDiaRespInfo.retErrorMsg||""}}</p><div style="clear:both"></div> </div>{{}}}',R='<div class="cyclicSessionError"><span class="icn"></span><p class="errorP">{{=it.multiDiaRespInfo.retErrorMsg}}</p></div>',O='<div class="sessionTmp1"><p class="beginLan" style="margin-bottom:0px">{{=it.multiDiaRespInfo.answer||"说的什么玩意儿"}}</p><div style="clear:both"></div> </div>',B='<li class="clearfix magBox leftMsg" creattime=""><p class="leftName">{{=it.robotData.robotName}}</p><div class="msgDiv"><div class="msgText"><div class="msgwrap leftMsg"><div class="msgOuter js-msgOuter"><div style="margin-bottom:10px;"><p>{{=it.multiGuideData.guide}}</p></div><p></p><ul class="multiGuide">{{for(var i=0;i<it.multiGuideData.msg.length;i++){}}{{if(i<6){}}<li class="guideEle"><a href="#0" data-num="{{=it.multiGuideData.msg[i].question}}" class="js-multiAnswerBtn multiAnswerBtn" data-docid="{{=it.multiGuideData.msg[i].id}}">{{=it.multiGuideData.msg[i].title}}</a><i></i></li>{{}}}{{}}}</ul></div></div></div></div><div class="msgBottomArea"></div></li>',z='<div class="systemMsg"><div class="systemMsgText">{{=it.tips}}</div></div>',E='<div class="content remote-apply"><img src="img/remote.png" class="remote-logo" /><div class="remote-remind-msg"><p class="title">{{=it.title}}</p><div class="desc"><p>{{=it.desc}}</p></div></div><div class="remote-right"><div class="btn refuse-btn" id="refuse-remote">{{=it.btn1}}</div><div class="btn accept-btn" id="accept-remote">{{=it.btn2}}</div></div></div>',q='<div class="content remote-count-down"><p>{{=it.desc}} <span id="remoteCountDown">{{=it.count}}</span></p></div>',H='<div class="content remote-download"><span class="close-btn js-close-remote-modal"></span><div class="tips"><img src="img/remote-warnning.png" width="40px" height="40px" class="icon-remote-warnning" /><div class="desc">{{=it.title}}</div></div><div class="download"><div class="download-btn js-download-win10">{{=it.downloadBtn1}}</div><div class="download-btn js-download-win7">{{=it.downloadBtn2}}</div><div class="active-btn js-active-btn">{{=it.activeLink}}</div></div></div>',W='<div class="msgwrap leftMsg"><div class="msgOuter js-msgOuter"><div style="margin-bottom:10px;">{{if(it.multiDiaRespInfo.answerStrip){}}{{for(var i=0;i<it.multiDiaRespInfo.answerStrip.length;i++){}}{{if(i==it.multiDiaRespInfo.answerStrip.length-1){}}<p class="beginLan">{{=it.multiDiaRespInfo.answerStrip[i]||""}}</p>{{}else{}}<p class="">{{=it.multiDiaRespInfo.answerStrip[i]||""}}</p>{{}}}{{}}}{{}else if(it.multiDiaRespInfo.remindQuestion){}}{{for(var i=0;i<it.multiDiaRespInfo.remindQuestion.length;i++){}}{{if(i==it.multiDiaRespInfo.remindQuestion.length-1){}}<p class="beginLan">{{=it.multiDiaRespInfo.remindQuestion[i]||""}}</p>{{}else{}}<p class="">{{=it.multiDiaRespInfo.remindQuestion[i]||""}}</p>{{}}}{{}}}{{}}}</div><ul class="sugguestions sugguestions">{{for(var i=0;i<it.contentAry.length;i++){}}{{if(it.from!=="initHistory"){}}<li style="color:#4298ba">{{=i+1}}. <a href="#0" class="js-answerBtnMutil" conversationId="{{=it.multiDiaRespInfo.conversationId}}" title="{{=it.contentAry[i]}}" outPutParamList="{{=it.multiDiaRespInfo.outPutParamList}}" level="{{=it.multiDiaRespInfo.level}}">{{=it.contentAry[i]}}</a></li>{{}else{}}<li style="color:#333">{{=i+1}}. <span href="#0" conversationId="{{=it.multiDiaRespInfo.conversationId}}" title="{{=it.contentAry[i]}}" outPutParamList="{{=it.multiDiaRespInfo.outPutParamList}}" level="{{=it.multiDiaRespInfo.level}}">{{=it.contentAry[i]}}</span></li>{{}}}{{ } }}</ul></div></div>',U='<div class="remote-close-confirm"><div class="header"><div class="title">{{=it.title}}</div><span class="js-cancel-remotemodel close-icon"></span></div><div class="content">{{=it.desc}}</div><div class="btns"><div class="js-close-remote btn ok">{{=it.btn1}}</div><div class="js-cancel-remotemodel btn cancel">{{=it.btn2}}</div></div></div>',G="<div  >{{for(var j=0;j<it.data.length;j++){}}<span class='link-add'><a target='_blank' style='color:#586B89' ondragstart='return false' href='{{=it.data[j].labelLink}}'>{{=it.data[j].labelName}}</a></span>{{}}}</div>";
a.inputContentTMP_2=W,a.systemMsg=s,a.systemqueue=l,a.sayHello=c,a.transferSayHello=d,a.leftMsg=u,a.rightMsg=f,a.cutoffMsg=m,a.msgDate=g,a.listSugguestionsMsg=h,a.multiListSugguestionsMsg=j,a.sideBarMenu=I,a.barMain=b,a.cusCard=w,a.closeFormHumanEvaluate=x,a.closeFormRobotEvaluate=k,a.evamsgHtml=F,a.evamsgHtml2=C,a.noticeHtml=$,a.pushEvaMsg=r,a.cyclicSessionTMP0=S,a.cyclicSessionTMP1=L,a.cyclicSessionTMP2=M,a.cyclicSessionTMP3=A,a.cyclicSessionTMP4=P,a.cyclicSessionTMP99=D,a.inputContentTMP=_,a.inputContentTMP_1511=N,a.cyclicSession_1522=O,a.cyclicSessionError=R,a.multiGuideHtml=B,a.recallMsg=z,a.keySwitchAdmins=v,a.systemMsg2=n,a.groupTemplate=p,a.sugguestionsListMsg=T,a.listSugguestionsMsgChange=y,a.agreeAuthor=o,a.remoteApply=E,a.remoteCountDown=q,a.remoteDownload=H,a.closeConfirmDialog=U,a.link=G,i.exports=a},{}],47:[function(e,i,t){var a=function(i){var t=(e("../../../common/util/listener.js"),""),a=function(){t=i.userInfo.color?i.userInfo.color:i.apiConfig.color,$header.css("background",t);var e=".rightMsg .msgDiv::before{border-color:transparent "+t+"}.rightMsg .msgDiv{background: "+t+"}";try{var a=document.getElementById("setStyle");a.appendChild(document.createTextNode(e))}catch(s){a.styleSheet.cssText=e}},s=function(){},n=function(){$header=$(".js-header"),$zhichiVoice=$(".js-zhichiVoice"),$infoBarLogo=$(".infoBarLogo"),$item=$(".js-item")},o=function(){a()},r=function(){n(),o(),s()};r()};i.exports=a},{"../../../common/util/listener.js":33}],48:[function(e,i,t){var a=function(){var i,t=e("../../../common/util/listener.js"),a=e("../../../common/comm.js"),s=e("../listMsg/sideBar.js"),n=a.getQueryParam(),o="",r="",l=function(){"iframe"===n.from?($(".js-mainBox").css({display:"block",height:"100%",width:"100%","max-height":"100%","max-width":"100%","min-height":"430px","min-width":"360px",top:"0px",bottom:"0px",left:"0px","margin-top":"0","margin-left":"0"}),(n.hideMax||n.hide_max)&&$zhichiMax.css("display","none")):($(".js-mainBox").css({display:"block",height:"90%",width:"70%","max-height":"720px","max-width":"640px",top:"50%",left:"50%","margin-left":"-240px","margin-top":"-320px","min-height":"430px","min-width":"360px"}),$zhichiMin.css("display","none"),$zhichiMax.css("display","none"))},c=function(){l(),$(".js-evaluate").find(".block-text").html("")},d=function(){var e=$(window).height(),i=$(window).width(),t=$(".js-mainBox").width(),a=$(".js-mainBox").height();"iframe"!=n.from&&$(".js-mainBox").css({top:(e-a)/2,left:(i-t)/2,"margin-top":"0","margin-left":"0"})},u=function(){var e=window.location.href,i=[],t=[];for(var a in n)"from"!==a&&"unit"!==a&&(i.push(a),t.push(n[a]));e=e.substring(0,e.lastIndexOf("?")+1);for(var s=0;s<i.length;s++)e+=i[s]+"="+t[s]+"&";e=e.substring(0,e.length-1),$zhichiMax.attr("href",e)},p=function(){$zhichiMin=$(".js-zhichiMin"),$zhichiMax=$(".js-zhichiMax"),$zhichiVoice=$(".js-zhichiVoice"),$closeForm=$(".js-closeForm"),t.on("core.onload",function(e){i=e[0],$zhichiVoice.attr("title",i.language.lan.L10047),$zhichiMax.attr("title",i.language.lan.L10045),$zhichiMin.attr("title",i.language.lan.L10044),$closeForm.attr("title",i.language.lan.L10046),o=i.language.lan,r=i.language.text,"iframe"!==n.from&&1===i.apiConfig.sideBarStatus&&(s($(".js-rightBar")[0],i,window),$(".js-mainBox").css({"max-width":i.apiConfig.sideBarWidth+640+"px"})),d()})},f=function(){$(window).resize(function(){d()}),u(),$zhichiMax.on("click",function(){window.parent!==window&&(window.parent.postMessage(JSON.stringify({name:"chat_collapseWindow",data:""}),"*"),window.parent.postMessage(JSON.stringify({name:"zc_post_message",data:{action:"chat_collapse_window"}}),"*"))}),$zhichiMin.on("click",function(){window.parent!==window&&(window.parent.postMessage(JSON.stringify({name:"chat_collapseWindow",data:""}),"*"),window.parent.postMessage(JSON.stringify({name:"zc_post_message",data:{action:"chat_collapse_window",status:"collapse"}}),"*"))})},m=function(){p(),f(),c()};m()};i.exports=a},{"../../../common/comm.js":1,"../../../common/util/listener.js":33,"../listMsg/sideBar.js":45}],49:[function(e,i,t){var a={orderClassify:"/ws/queryTicketTypeInfoList/4"},s={},n="orderClassify",o=function(i,t){var o=(e("../../../common/util/monitAjax.js")(t),e("../../../common/util/listener.js")),r=e("./template.js"),l=!1,c=i,d=!1,u=1,p="",f=function(e){e.stopPropagation(),o.trigger("sendArea.closeAlldropMenu"),l?(c.find(".js-classDropdownAreaFixed").removeClass("openActive"),c.find(".js-classDropdown-btn").removeClass("checkActive"),$(this).find(".classIfyTitleIcn").css("background-position","-3279px 13px"),l=!1):(d||m(),c.find(".js-classDropdownAreaFixed").removeClass("openActive"),c.find(".js-classDropdown-btn").removeClass("checkActive"),$(this).addClass("checkActive"),$(this).next().addClass("openActive"),$(this).find(".classIfyTitleIcn").css("background-position","-3320px 13px"),l=!0)},m=function(){var e={},i=JSON.stringify(e),s={uid:t.apiInit.uid,url:a[n],method:"get",param:i};$.ajax({url:"/chat/data/invokeOtherByUser.action",dataType:"json",type:"get",data:s}).success(function(e){var i={items:e.items};g(i.items),p=doT.template(r.classifyOrderList)(i),c.find(".js-classifyOrderMenu").html(p),d=!0})},g=function(e){if(e)for(var i=0;i<e.length;i++)e[i].items&&e[i].items.length>0&&(s[e[i].typeId]=e[i].items,g(s[e[i].typeId]))},v=function(){var e=$(this).attr("dataId")||"",i=$(this).attr("data-nodeFlag")||"",t=$(this).attr("title")||"",a=s[e];if("1"===i&&e&&a.length&&u<5){u++;var n={items:a},o=doT.template(r.classifyOrderList)(n);c.find(".js-classifyOrderMenu").html(o),c.find(".js-routerDeep").addClass("active"),c.find(".js-classRouter").append("<span class='routerDeep js-routerDeep' dataDeep='"+u+"' dataId='"+e+"' data-nodeFlag='"+i+"' title='"+t+"'><i style='color:#0DAEAF'>/ </i>"+t+"</span>"),h(u);try{var l=document.getElementById("classDropdownMenu");l.scrollTop=0}catch(d){return"滚动至底部失败"}}},h=function(e){for(var i=1;i<6;i++)c.find(".js-routerDeep").removeClass("routerNum"+i).addClass("routerNum"+e)},y=function(){var e=$(this).attr("dataId")||"",i=$(this).attr("dataDeep")||"",t=s[e];u=i;for(var a=$(this).parent().find(".js-routerDeep"),n=a.length,o=0;o<n-i;o++)$(a[n-o-1]).remove();if($(this).removeClass("active"),e){if(t.length){var l={items:t},d=doT.template(r.classifyOrderList)(l);c.find(".js-classifyOrderMenu").html(d)}}else c.find(".js-classifyOrderMenu").html(p);h(i)},T=function(e){e.stopPropagation();var i=$(this).attr("data-key")||"",t=$(this).attr("data-nodeFlag")||"";if("1"!==t){var a=$(this).parents(".js-questionClassify");a.find(".js-classDropdown-title").html($(this).html());var s=$(this).attr("dataId")||"",n=$(this).attr("dataName")||"",r={key:i,dataId:s,dataName:n,typePathName:$(this).attr("data-name")};o.trigger("sendArea.definedFieldResult",r),c.find(".js-classDropdownAreaFixed").removeClass("openActive"),c.find(".js-classDropdown-btn").removeClass("checkActive"),c.find(".classIfyTitleIcn").css("background-position","-3279px 13px"),l=!1}},j=function(){l=!1,c.find(".js-classDropdownAreaFixed").removeClass("openActive"),c.find(".js-classDropdown-btn").removeClass("checkActive"),c.find(".classIfyTitleIcn").css("background-position","-3279px 13px")},I=function(e){e.stopPropagation()},b=function(){},w=function(){c.delegate(".js-classDropdown-btn","click",f),c.delegate(".js-classDropdownLi","click",T),c.delegate(".js-classOrderList","click",v),c.delegate(".js-routerDeep","click",y),c.delegate(".js-classDropdownAreaFixed","click",I),c.delegate(".js-leaveMsgBody","click",j)},x=function(){},k=function(){x(),b(),w()};k()};i.exports=o},{"../../../common/util/listener.js":33,"../../../common/util/monitAjax.js":35,"./template.js":57}],50:[function(e,i,t){function a(i,t,a,s){var n,o=e("./template.js"),r=e("../../../common/util/listener.js"),l=e("../../../common/util/msgReminder.js"),c=e("../util/showTip.js"),d=e("../../../common/util/monitAjax.js")(t),u=(t.language.lan,t.language.text),p=t.userInfo.color?t.userInfo.color:t.apiConfig.color,f=0,m="",g="",v=!1,h=!1,y=0===a.commentType?a.commentType:1,T=1,j="",I={},b=0;l.clear();var w=function(){var e=doT.template(o.AlertTemplate)();n=$(e),$(".js-mainBox").append(n),L();var i=$(".js-titleName").html(),t=i.length>4?i.substr(0,4)+"...":i,s=doT.template(o.humanOne_selfHtml)({config:I,languageText:u,aname:i,subName:t});if(n.find(".model-body").html(s),$aLi=$("#star li"),"push"==a.from){f=a.score;var r=a.solveActive;S(f),k(a.from),n.find(".js-evaluateTip").html(I[4].scoreExplain),x(f),0==r?n.find(".js-solved").addClass("solveActive").css({background:p,border:"1px solid "+p,color:"#fff"}):1==r?n.find(".js-solved").addClass("solveActive").css({background:p,border:"1px solid "+p,color:"#fff"}):2==r&&n.find(".js-unSolved").addClass("unsolveActive").css({background:p,border:"1px solid "+p,color:"#fff"}),n.find(".js-submitTheme").css("background",p)}else f=1==b?0:5,S(f),n.find(".js-solved").addClass("solveActive").css({background:p,border:"1px solid "+p,color:"#fff"}),f>0?(h=!0,k(a.from),n.find(".js-evaluateTip").html(I[4].scoreExplain),n.find(".js-submitTheme").css("background",p),x(f)):n.find(".js-evaluateTip").css("paddingBottom","20px");for(var l=0,c=1;c<=$aLi.length;c++)$aLi[c-1].index=c,$($aLi[c-1]).bind("click",function(){l=this.index,S(l),h=!0,n.find(".js-evaluateTip").css("paddingBottom","0px");try{I[l-1].labelName?$(".js-evaluateTitle").html(I[l-1].tagTips):$(".js-evaluateTitle").html("")}catch(e){}switch(l){case 1:case 2:f=l,x(l),k(a.from),P(),n.find(".js-submitTheme").css("background",p);break;case 3:case 4:f=l,x(l),k(a.from),n.find(".js-submitTheme").css("background",p),P();break;case 5:f=5,x(l),k(a.from),n.find(".js-submitTheme").css("background",p),P()}});P()},x=function(e){h=!0,conf=I[e-1];var i=[],t=conf.scoreExplain;conf.labelName&&(i=conf.labelName.split(","));for(var a=0;a<i.length;a++)""==i[a]&&i.splice(a,1);var s=doT.template(o.humanTwo_selfHtml)({list:i,conf:conf,star:e,languageText:u});n.find(".model-body-extend").html(s),n.find(".js-evaluateTip").html(t),P()},k=function(e){var i=doT.template(o.evaluateFooter_selfHtml)({from:e,languageText:u});n.find(".model-body-commit").html(i)},F=function(){if("push"==a.from&&(h=!0),0==v&&h){v=!0;var e=[],s=n.find(".js-tag").length;if(n.find(".js-tag").each(function(){var i=$(this).html();$(this).hasClass("active")&&e.push(i)}),i&&0==e.length&&I[f-1].isTagMust&&s>0)return c.show(u.T0104),void setTimeout(function(){v=!1},3e3);if(m=e.join(","),g=n.find(".js-evaluateInner").val()||"",/^\s+$/g.test(g)&&(g=""),i&&""==g&&I[f-1].isInputMust&&5!=f)return c.show(u.T0105),void setTimeout(function(){v=!1},3e3);T=1==i?1==I[0].isQuestionFlag?n.find(".js-solved").hasClass("solveActive")?1:0:-1:n.find(".js-isques").hasClass("okactive")?1:0,0==i&&(j=t.apiConfig.robotFlag||""),d({type:"post",url:"/chat/user/comment.action",dataType:"json",data:{cid:t.apiInit.cid,visitorId:t.apiInit.uid,score:f,solved:T,tag:m,robotFlag:j,remark:g,type:i,commentType:y},success:function(e){if(1===e.status){var i={score:f,solved:T};if(r.trigger("sendArea.toPushEav",i),M(),"push"==a.from)r.trigger("listMsg.closePushEva");else{var s={type:"system",status:"evaluate",data:{content:u.T0025}};r.trigger("sendArea.sendAreaSystemMsg",s)}c.show(u.T0032),a&&a.resultFlag&&(window.parent!==window?(window.parent.postMessage(JSON.stringify({name:"chat_collapseWindow",data:""}),"*"),2===t.apiConfig.pageCloseFlag&&C()):C())}else c.show(u.T0033)},error:function(){c.show(u.T0033)}}),setTimeout(function(){v=!1},3e3)}},C=function(){d({type:"post",url:"/chat-web/user/out.action",dataType:"json",data:{uid:t.apiInit.uid},success:function(e){r.trigger("core.sessionclose",999)}})},S=function(e){for(var i=0;i<$aLi.length;i++)$aLi[i].className=i<e?"on":"";setTimeout(function(){$(".js-evaluateTitle").html(I[e-1].tagTips)},0)},L=function(){n.find(".js-evaluatelayer").css("display","block"),n.find(".js-evaluateDialog").css("display","block")},M=function(){n.find(".js-evaluatelayer").css("display","none"),n.find(".js-evaluateDialog").css("display","none"),setTimeout(function(){$(".js-evaluateArea").remove()},500)},A=function(){Alert.show()},P=function(){var e=$(".js-mainBox").width(),i=$(".js-mainBox").height(),t=n.find(".js-evaluateDialog").height();i>t?n.find(".js-evaluateDialog").css({left:(e-360)/2+"px",top:(i-t)/2+"px"}):(n.find(".js-evaluateDialog").css({left:(e-360)/2+"px",top:"0px","overflow-y":"scroll"}),n.find(".js-evaluateDialog").height(i+"px"))},D=function(){},_=function(){n.undelegate(),n.delegate(".js-tag","click",function(){$(this).hasClass("active")?($(this).removeClass("active"),$(this).css({background:"#fff",color:"#8a9699",border:"1px solid #e0e9e8"})):($(this).addClass("active"),$(this).css({background:p,color:"#fff",border:"1px solid "+p}))}),n.delegate(".js-evaluateSubmit","click",F),n.delegate(".js-evaluateClose","click",function(){M(),r.trigger("sendArea.reTopushEav")}),n.delegate(".js-evaluatelayer","click",function(){M(),r.trigger("sendArea.reTopushEav"),setTimeout(function(){$(".js-evaluateArea").remove()},500)}),n.delegate(".js-solved","click",function(){$(this).hasClass("solveActive")||($(this).addClass("solveActive").css({background:p,border:"1px solid "+p,color:"#fff"}),n.find(".js-unSolved").removeClass("unsolveActive").css({background:"#fff",border:"1px solid #d6dbe5",color:"#8b98ad"}))}),n.delegate(".js-unSolved","click",function(){$(this).hasClass("unsolveActive")||($(this).addClass("unsolveActive").css({background:p,border:"1px solid "+p,color:"#fff"}),n.find(".js-solved").removeClass("solveActive").css({background:"#fff",border:"1px solid #d6dbe5",color:"#8b98ad"}))}),n.delegate(".js-noevaluateSubmit","click",function(){a&&a.resultFlag&&(M(),window.parent!==window?(window.parent.postMessage(JSON.stringify({name:"chat_collapseWindow",data:""}),"*"),2===t.apiConfig.pageCloseFlag&&C()):C())})},N=function(){$evaluate=$(".js-evaluate")},R=function(e){N(),w(),D(),_(),c=c(t),"push"==a.from},O=function(){d({type:"get",url:"/chat/user/satisfactionMessage.action",dataType:"json",data:{uid:t.apiInit.uid},success:function(e){if(1===e.status){I=e.data,b=e.defaultType;try{0===e.defaultType&&""!=I[4].labelName&&setTimeout(function(){$(".js-evaluateTitle").html(I[4].tagTips),P()},0)}catch(i){}R()}},error:function(){c.show("请检查网络链接"),setTimeout(function(){$(".js-evamsg").remove()},3e3)}})};O(),this.modeAlert=A}i.exports=a},{"../../../common/util/listener.js":33,"../../../common/util/monitAjax.js":35,"../../../common/util/msgReminder.js":36,"../util/showTip.js":71,"./template.js":57}],51:[function(e,i,t){i.exports={".bmp":"image",".jpg":"image",".JPG":"image",".jpeg":"image",".JPEG":"image",".png":"image",".PNG":"image",".gif":"image",".GIF":"image",".txt":"txt",".TXT":"txt",".DOC":"doc",".doc":"doc",".docx":"doc",".DOCX":"doc",".pdf":"pdf",".PDF":"pdf",".ppt":"ppt",".PPT":"ppt",".PPTX":"ppt",".pptx":"ppt",".xls":"xls",".XLS":"xls",".xlsx":"xls",".XLSX":"xls",".RAR":"rar",".rar":"rar",".ZIP":"rar",".zip":"rar",".swj":"swj",".eml":"eml",".msb":"msb",".ssu":"ssu",".SSU":"SSU",".mp3":"player",".MP3":"player",".mp4":"player",".MP4":"player",".wma":"player",".WMA":"player",".WMV":"player",".wmv":"player",".rmvb":"player",".RMVB":"player"}},{}],52:[function(e,i,t){i.exports={txt:"//img.sobot.com/yun/attachment/fileTypeImages/icon_txt.gif",doc:"//img.sobot.com/yun/attachment/fileTypeImages/icon_doc.gif",pdf:"//img.sobot.com/yun/attachment/fileTypeImages/icon_pdf.gif",ppt:"//img.sobot.com/yun/attachment/fileTypeImages/icon_ppt.gif",xls:"//img.sobot.com/yun/attachment/fileTypeImages/icon_xls.gif",rar:"//img.sobot.com/yun/attachment/fileTypeImages/icon_rar.gif",player:"//img.sobot.com/yun/attachment/fileTypeImages/icon_mp3.gif"}},{}],53:[function(e,i,t){var a=function(i,t,a){var s,n,o,r,l,c,d,n,u,p,f,m,g,v,h,y,T,j,I,b,w,x,k,F,C,S,L,M,A,P,D,_,N,R,O=e("../../../common/util/listener.js"),B=e("../../../common/mode/currentState.js"),z=e("../util/qqFace.js"),E=e("./uploadImg.js"),q=e("./leaveMessage.js"),H=e("./evaluate.js"),W=e("./template.js"),U=e("../util/modal/dialog.js"),G=e("./switchRobot.js"),V=e("../util/showTip.js"),Z={},J=e("../../../common/comm.js"),Q=!1,K=!1,X=0,Y="",ee=2e3,ie=function(){var e=y.val();if(0==e.length||/^\s+$/g.test(e))return y.val(""),!1;if(e.length>ee)return!1;var i=l+ +new Date,t=$("<div></div>").text(e),a=t.html(),s="",o=!1,u=r.apiConfig.sensitiveAuthFlag,p=r.apiInit.sensitive,f=r.apiConfig.sensitiveEffectiveScope||"",m=f.indexOf("0")!=-1;clearTimeout(n),"human"==B.getCurrentState()?(s="sendArea.send",u&&!p&&m&&(o=!0)):s="sendArea.send.Td",O.trigger(s,[{answer:a,uid:l,cid:c,dateuid:i,date:+new Date,currentStatus:d,holdSocket:o}]),y.val(""),$inputPlaceholder.css("display","block"),re(),clearTimeout(n),setTimeout(function(){le()},1e3)},te=function(e){var i=y.val();if(0==i.length||/^\s+$/g.test(i))return y.val(""),!1;if(i.length>ee)return!1;var t=l+ +new Date,a=$("<div></div>").text(i),o=a.html();clearTimeout(n),O.trigger("sendArea.sendNew",[{answer:o,uid:l,cid:c,dateuid:t,date:+new Date,currentStatus:d}]);var r={puid:e.puid,cid:c,uid:l,content:o};s({url:"/chat/user/chatsend.action",data:r,dataType:"json",type:"POST",success:function(e){O.trigger("core.msgresult",{msgId:t,result:"success"})},error:function(e){}}),y.val(""),$inputPlaceholder.css("display","block"),re(),clearTimeout(n),setTimeout(function(){le()},1e3)},ae=function(e){switch(e.type){case 0:se();break;case 1:te(e)}},se=function(){var e=y.val();if(0==e.length||/^\s+$/g.test(e))return y.val(""),!1;if(e.length>ee)return!1;var i=$("<div></div>").text(e),t=i.html();clearTimeout(n);var a={cid:c,content:t};s({url:"/chat-web/user/sendFirstMsg",data:a,dataType:"json",type:"POST",success:function(e){O.trigger("sendArea.showFirstMsg",t)},error:function(e){}}),y.val(""),$inputPlaceholder.css("display","block"),re(),clearTimeout(n),setTimeout(function(){le()},1e3)},ne=function(){var e="iframe"==r.urlParams.from,i=e?320:360,t=new U({title:"截图说明",footer:!1,width:i,source:"capture"});t.setInner(W.captureDialogTemplate),t.show(),e&&$(".capture-outer").css({width:i})},oe=function(){clearInterval(n),n=setTimeout(function(){var e=$("<div></div>").text(y.val()).html();s({type:"post",url:"/chat/user/input.action",dataType:"json",data:{cid:c,uid:l,content:e}})},200)},re=function(){var e=y.val(),i=e.length,t=0;if(i>ee&&(t=i-ee),t>0){h.css("background","#e0e9e8");var a=p.T0177.replace("{0}",ee).replace("{1}",t);return $(".text-over").text(a).css("display","block"),!1}$(".text-over").text("").css("display","none");var s=$("<div></div>").text($(".js-inputMsg").val());_.html(s.html()),setTimeout(function(){var e=_.height();e<160?$(".js-inputMsg").css({height:e}):$(".js-inputMsg").css({height:e,"overflow-y":"scroll"})},5),X&&oe(),i>0?h.css("background",f):h.css("background","#e0e9e8")},le=function(){x.find(".js-respInfoList").remove()},ce=function(e){if(13==e.keyCode)return ie(),!1},de=function(e){d=e,O.trigger("sensitiveMsg.currentStatus",e),"human"===d?(X=1,L.show(),r.apiConfig.lan||S.show(),"hide"===r.urlParams.cut_flag&&S.hide(),C.show(),b.show(),w.show(),le()):"robot"===d&&(X=0,L.hide(),S.hide(),C.hide(),b.show(),w.show())},ue=function(e,i){0==K&&(K=!0,O.trigger("sendArea.artificial",i),setTimeout(function(){K=!1},2e3))},pe=function(e){"transfer"!==e.status&&"hide"!==e.action||(y.unbind("paste"),y.on("paste",he),X=1,y.css("display","block"),y.html()&&$inputPlaceholder.css("display","block"),_.html("").css("visibility","hidden"),$inputPlaceholder.html(r.apiConfig.customDoc))},fe=function(e){"transfer"!==e.status&&"hide"!==e.action||O.trigger("sendArea.hideMsgBotBtn"),"blacklist"===e.status&&O.trigger("sendArea.robotOverTimeHandler")},me=function(){Z.hide()},ge=function(){setTimeout(function(){K=!1,T.trigger("click")},10)},ve=function(e){var i=document.getElementById("js-inputMsg"),t=-1;if(i.selectionStart||0==i.selectionStart)t=i.selectionStart;else{var a=document.selection.createRange();a.moveStart("character",-i.value.length),t=a.text.length}var s=y.val().substring(0,t),n=y.val().substring(t),o=s+e+n;$(y).val(o);var r=(s+e).length;if(i.setSelectionRange)i.setSelectionRange(r,r),i.focus();else if(i.createTextRange){var a=i.createTextRange();a.collapse(!0),a.moveEnd("character",r),a.moveStart("character",r),a.select()}re(),$inputPlaceholder.css("display","none")},he=function(e){for(var i=e.originalEvent,t=0,a=i.clipboardData.items.length;t<a;t++){var s=i.clipboardData.items[t];"file"===s.kind&&(e.preventDefault(),uploadFile.onFormDataPasteHandler(s,l,c))}},ye=function(){uploadFile.onChangeHandler(l,c)},Te=function(e){je(e),O.trigger("sendArea.send",[{answer:u,uid:e.uid,cid:e.cid,dateuid:e.dateuid,date:+new Date,currentStatus:d,msgSendType:m,fileurl:e.url}]),y.focus()},je=function(e){if(Ie(e)){m=e.browserVersion&&"ie-"===e.browserVersion?"ie-file":"file";var i="fileOther";switch(e.filetype){case"rar":i="fileRar";break;case"txt":i="fileTxt";break;case"doc":i="fileDoc";break;case"pdf":i="filePdf";break;case"ppt":i="filePpt";break;case"xls":i="fileXls";break;default:i="fileOther"}var t={url:e.url,dateuid:e.token,filesize:e.filesize,fileIcoClass:i,filename:e.filename+e.extension,languageText:p};u=doT.template(W.tranfiletype)(t)}},Ie=function(e){switch(e.filetype){case"image":m=e.browserVersion&&"ie-"===e.browserVersion?"ie-image":"image";var i={url:e.url};return u=doT.template(W.fileImage)(i),!1;default:return!0}},be=function(){s({type:"post",url:"/chat-web/user/out.action",dataType:"json",data:{uid:r.apiInit.uid},success:function(e){O.trigger("core.sessionclose",999)}})},we=function(e){0==Q&&(Q=!0,s({type:"post",url:"/chat/user/isComment.action",dataType:"json",data:{cid:r.apiInit.cid,uid:r.apiInit.uid,type:X},success:function(i){if(isEvaluated=i.isComment,1==isEvaluated){if("close"==e.from)return void(a.parent!==a?(a.parent.postMessage(JSON.stringify({name:"chat_collapseWindow",data:""}),"*"),a.parent.postMessage(JSON.stringify({name:"zc_post_message",data:{action:"chat_collapse_window"}}),"*"),2===r.apiConfig.pageCloseFlag&&be()):be());var t={type:"system",status:"evaluate",data:{content:p.T0025}};O.trigger("sendArea.sendAreaSystemMsg",t)}else if(0==isEvaluated)if(r.urlParams&&"0"!==r.urlParams.show_evaluate)H(X,r,e,Y);else{if("close"==e.from)return void(a.parent!==a?(a.parent.postMessage(JSON.stringify({name:"chat_collapseWindow",data:""}),"*"),a.parent.postMessage(JSON.stringify({name:"zc_post_message",data:{action:"chat_collapse_window"}}),"*"),2===r.apiConfig.pageCloseFlag&&be()):be());H(X,r,e,Y)}else{if("close"==e.from)return void(a.parent!==a?(a.parent.postMessage(JSON.stringify({name:"chat_collapseWindow",data:""}),"*"),a.parent.postMessage(JSON.stringify({name:"zc_post_message",data:{action:"chat_collapse_window"}}),"*"),2===r.apiConfig.pageCloseFlag&&be()):be());var t={type:"system",status:"evaluate",data:{content:p.T0026}};O.trigger("sendArea.sendAreaSystemMsg",t)}}}),setTimeout(function(){Q=!1},1e3))},xe=function(e){switch(e){case-3:break;case-2:y.css("display","none"),$inputPlaceholder.css("display","none"),_.html(r.apiConfig.waitDoc).css("visibility","visible");break;case-4:case-1:case 1:case 2:case 3:case 5:case 4:case 6:case 7:case 8:case 999:case 888:x.remove(),e!=-1&&3!=e||M.remove(),O.trigger("sendArea.revmoveChatSwitch"),$(".js-endleaveMessage").remove(),r.urlParams.satDegree_A&&"robot"!=B.getCurrentState()||$(".js-endEvaluate").remove(),setTimeout(function(){ke()},100),k.css("display","block")}},ke=function(){var e=0;switch($(".js-endavgWidth").each(function(){"block"===$(this).css("display")&&(e+=1)}),e){case 1:D.css("width","100%");break;case 2:D.css("width","50%");break;case 3:D.css("width","33.333%")}},Fe=function(e){var i=e.originalEvent;if(!i.data)try{var t=JSON.parse(i.data||"{}");if("human"==B.getCurrentState())return;"auto"==i.data.type&&(r.urlParams.autoManual=!0,r.urlParams.aid=t.aid,ue())}catch(e){}},Ce=function(){var e=$(this).attr("title"),i=l+ +new Date;O.trigger("sendArea.send",[{requestText:e,answer:e,uid:l,cid:c,dateuid:i,date:+new Date,currentStatus:d}]),le(),y.val(""),$inputPlaceholder.css("display","block"),re()},$e=function(){if("iframe"==r.urlParams.from){var e=a.location.href.replace(/#[\S]+$/,"").replace(/(&|\?)cid=[^&]+/,"").replace(/(&|\?)tnk=[^&]+/,"").replace(/(&|\?)autoManual=[^&]+/,"");a.location.href=e+"&tnk="+ +new Date}else{var e=a.location.href;e=e.replace(/(&|\?)autoManual=[^&]+/,"").replace(/#[\S]+$/,""),e=e.replace(/(&|\?)tnk=[^&]+/,""),e+="&tnk="+ +new Date,a.location.href=e}},Se=function(){s({type:"post",url:"/chat-web/user/getWsTemplate.action",dataType:"json",data:{uid:r.apiInit.uid,source:0,channelFlag:r.urlParams.channelFlag||""},success:function(e){var i=e||[];if(i.length>1){var t=doT.template(W.groupTemplate)({list:i});o=$(t),$(".js-mainBox").append(o),o.delegate(".js-item","click",function(){o.remove();var e=$(this).data("id");Le(e)}),o.find(".js-group-outer").animate({right:"0"}),o.delegate(".js-cancel-btn,.js-group-layer","click",function(){o.find(".js-group-outer").animate({right:"-390px"},function(){o.remove()})})}else Le(i[0].templateId)}})},Le=function(e){r.urlParams.templateId=e,s({url:"/chat/data/invokeOtherByUser.action",dataType:"json",type:"get",data:{uid:r.apiInit.uid,url:"basic-set/getCusMsgTemplateConfig/4",method:"get",param:JSON.stringify({templateId:e})}}).success(function(e){r.urlParams.msgTxt=e.item.msgTxt,r.urlParams.msgTmp=e.item.msgTmp,r.urlParams.emailFlag=e.item.emailFlag,r.urlParams.emailShowFlag=e.item.emailShowFlag,r.urlParams.enclosureFlag=e.item.enclosureFlag,r.urlParams.enclosureShowFlag=e.item.enclosureShowFlag,r.urlParams.telFlag=e.item.telFlag,r.urlParams.telShowFlag=e.item.telShowFlag,r.urlParams.ticketShowFlag=e.item.ticketShowFlag,r.urlParams.ticketTypeFlag=e.item.ticketTypeFlag,r.urlParams.ticketTypeId=e.item.ticketTypeId,r.urlParams.ticketTitleShowFlag=e.item.ticketTitleShowFlag,q(r)})},Me=function(){var e=$(this).val();""===e?$(this).next().css("display","block"):$(this).next().css("display","none"),e&&(_length=e.length)},Ae=function(e){var i=$(e).val();""===i?$(e).next().css("display","block"):$(e).next().css("display","none"),i&&(_length=i.length)},Pe=function(e){e&&!e.notClear&&$inputMsg.val(""),$inputPlaceholder.html(r.apiConfig.customDoc),$inputPlaceholder.css("display","block")},De=function(){G(r)},_e=function(i){r=i[0],s=e("../../../common/util/monitAjax.js")(r),p=r.language.text,f=r.userInfo.color?r.userInfo.color:r.apiConfig.color,T.css("color",f);var t=r.urlParams.wurl||"",n=r.urlParams.wurlOpenStyle;t&&1==r.urlParams.isCustomSysFlag&&(T.remove(),n?C.before('<a class="chatSwitch js-sendChatSwitch" target="_blank" style="color:'+f+'" href="'+t+'">'+p.T0060+"</a>"):C.before('<a class="chatSwitch js-sendChatSwitch" target="_parent" style="color:'+f+'" href="'+t+'">'+p.T0060+"</a>"),T=$(".js-sendChatSwitch"),O.trigger("sendArea.wurlHandler",{wurl:t,wurlOpenStyle:n})),r.urlParams.isLeaveCustomSysFlag?$(".js-mainBox").delegate(".js-leaveMessage","click",function(){a.open(r.urlParams.leaveCustomUrl)}):$(".js-mainBox").delegate(".js-leaveMessage","click",Se);var o=r.urlParams.chatConnectButton;"1"==o&&T.css("display","none"),$inputPlaceholder.html(r.apiConfig.robotDoc),L.attr("title",p.T0049),C.attr("title",p.T0050),w.attr("title",p.T0052),b.attr("title",p.T0051),N.text(p.T0057),Re(),Ne()},Ne=function(){Z=z(a,r),uploadFile=E(i,t,a,r),!r.urlParams.autoManual||1!=r.apiConfig.type&&3!=r.apiConfig.type||setTimeout(ue,100),0==r.urlParams.designButton&&$(".js-powBox").css("visibility","hidden"),r.urlParams.isMessageFlag||$(".js-sendLeaveMessage").remove(),2==r.apiConfig.msgToTicketFlag&&$(".js-sendLeaveMessage").remove(),r.apiConfig.isUploadFlag||$(".js-uploadFile").remove(),r.urlParams.isFeedBackFlag&&"robot"!=B.getCurrentState()||$(".js-sendEvaluate").remove(),r.apiConfig.robotSwitchFlag&&$(".js-switchRobot").css("display","block")},Re=function(){l=r.apiInit.uid,c=r.apiInit.cid},Oe=function(){g=$(document.body),v=$(i),h=v.find(".js-send-btn"),y=v.find(".js-inputMsg"),T=v.find(".js-chatSwitch"),j=v.find(".js-voiceCalls"),I=v.find(".js-upload"),S=v.find(".js-capture"),b=v.find(".js-leaveMessage"),w=v.find(".js-evaluate"),x=v.find(".js-footerOn"),k=v.find(".js-footerOff"),F=v.find(".js-newMessage"),C=v.find(".js-uploadFile"),L=v.find(".js-emotion"),M=v.find(".js-endEvaluate"),A=v.find(".js-endnewMessage"),P=v.find(".js-endleaveMessage"),D=v.find(".js-endavgWidth"),_=v.find(".js-textareaPre"),$inputPlaceholder=v.find(".js-inputPlaceholder"),N=v.find(".js-sobotTitle"),$inputMsg=v.find(".js-inputMsg"),R=v.find(".js-respInfoBtn"),$switchRobot=v.find(".js-switchRobot")},Be=function(){O.on("core.onload",_e),O.on("core.buttonchange",fe),O.on("core.grouplist",ge),$(".js-capture").on("click",ne),O.on("core.system",pe),h.on("click",ie),O.on("sendArea.senderMsg",ae),y.on("keydown",ce),J.detectEventSupport("input")?y.on("input",re):setInterval(function(){re()},200),$(".js-mainBox").delegate(".js-chatSwitch","click",ue),$(".js-mainBox").delegate(".copy","click",function(e){function i(){try{var e=document.createElement("input");e.value=t,document.body.appendChild(e),e.select(),document.execCommand("Copy"),e.className="oInput",e.style.display="none",V.show("复制成功")}catch(i){}}var t=$(this).attr("message");i()}),$(".js-mainBox").delegate(".js-dxx","click",function(e){var i=$(this).attr("nodeId"),t=l+ +new Date,a=!1,s=r.apiConfig.sensitiveAuthFlag,n=r.apiInit.sensitive,o=r.apiConfig.sensitiveEffectiveScope||"",u=o.indexOf("0")!=-1;"human"==B.getCurrentState()?(str="sendArea.send",s&&!n&&u&&(a=!0)):str="sendArea.send.Td",O.trigger(str,[{answer:this.innerText,uid:l,cid:c,nodeId:i,dateuid:t,date:+new Date,currentStatus:d,holdSocket:a}])}),y.on("focus",me),O.on("sendArea.gotoxy",ve),O.on("sendArea.uploadImgUrl",Te),I.on("change",ye),w.on("click",we),O.on("listMsg.toEvaluate",we),O.on("listMsg.artificial",Pe),F.on("click",$e),x.delegate(".js-respInfoBtn","click",Ce),O.on("core.sessionclose",xe),O.on("listMsg.openleaveMsgPage",Se),$(a).on("message",Fe),O.on("core.transfersuccess",function(e){Y=e.data.aname,y.unbind("paste"),y.on("paste",he),X=1}),O.on("listMsg.showChatSwitch",function(){T.css("display","block")}),J.detectEventSupport("input")?y.on("input",Me):setInterval(function(){Ae(y)},100),$inputPlaceholder.on("click",function(){y.focus()}),g.on("click",le),$switchRobot.on("click",De)},ze=function(){Oe(),Be(),O.on("core.statechange",de),V=V(r)};ze()};i.exports=a},{"../../../common/comm.js":1,"../../../common/mode/currentState.js":12,"../../../common/util/listener.js":33,"../../../common/util/monitAjax.js":35,"../util/modal/dialog.js":67,"../util/qqFace.js":70,"../util/showTip.js":71,"./evaluate.js":50,"./leaveMessage.js":55,"./switchRobot.js":56,"./template.js":57,"./uploadImg.js":58}],54:[function(e,i,t){var a=function(i,t){var a=(e("./template.js"),e("../../../common/util/monitAjax.js")(t),e("../../../common/util/listener.js")),s=!1,n="",o=function(e){e.stopPropagation(),n=$(this).attr("data-key"),s?(i.find(".js-dropdown-menu").removeClass("openActive"),i.find(".js-dropdown-btn").removeClass("checkActive"),i.find(".dropListTitleIcn").css("background-position","-3279px 13px"),s=!1,i.find(".js-classDropdownAreaFixed").removeClass("openActive"),i.find(".js-classDropdown-btn").removeClass("checkActive"),i.find(".classIfyTitleIcn").css("background-position","-3279px 13px")):(i.find(".js-dropdown-menu").removeClass("openActive"),i.find(".js-dropdown-btn").removeClass("checkActive"),$(this).find(".dropListTitleIcn").css("background-position","-3320px 13px"),$(this).addClass("checkActive"),$(this).next().addClass("openActive"),i.find(".js-classDropdownAreaFixed").removeClass("openActive"),i.find(".js-classDropdown-btn").removeClass("checkActive"),i.find(".classIfyTitleIcn").css("background-position","-3279px 13px"),s=!0)},r=function(e){e.stopPropagation();var t=$(this).attr("data-nodeFlag")||"";if("1"!==t){var o=$(this).parent().parent();if(o.find(".js-dropdown-title").html($(this).html()),n){var r=$(this).attr("dataId")||"",l=$(this).attr("dataName")||"",c={key:n,dataId:r,dataName:l};a.trigger("sendArea.definedFieldResult",c);
}else{var d=$(this).attr("data-fieldId")||"",u=$(this).attr("dataValue")||"",l=($(this).attr("fieldType")||"",$(this).attr("dataName")||"");if(u)var c={fieldId:d,dataValue:u,dataName:l,type:"definedList"};else{var p="00:00";p=o.parent().find(".js-definedHour").html()+":"+o.parent().find(".js-definedMinutes").html();var c={fieldId:d,dataValue:p,dataName:p,type:"time"}}a.trigger("sendArea.definedFieldResult",c)}i.find(".js-dropdown-menu").removeClass("openActive"),i.find(".js-dropdown-btn").removeClass("checkActive"),i.find(".dropListTitleIcn").css("background-position","-3279px 13px"),s=!1}},l=function(){s=!1,i.find(".js-dropdown-menu").removeClass("openActive"),i.find(".js-dropdown-btn").removeClass("checkActive"),i.find(".dropListTitleIcn").css("background-position","-3279px 13px"),i.find(".js-classDropdownAreaFixed").removeClass("openActive"),i.find(".js-classDropdown-btn").removeClass("checkActive"),i.find(".classIfyTitleIcn").css("background-position","-3279px 13px")},c=function(){},d=function(){},u=function(){l()},p=function(){i.delegate(".js-dropdown-btn","click",o),i.delegate(".js-dropdownLi","click",r),$(document.body).on("click",function(){l()}),a.on("sendArea.closeAlldropMenu",u)},f=function(){},m=function(){f(),d(),p()};m(),this.expand=c,this.collapse=l};i.exports=a},{"../../../common/util/listener.js":33,"../../../common/util/monitAjax.js":35,"./template.js":57}],55:[function(e,i,t){var a=function(i,t){var a,s,n,o,r,l,c,d,u,p,f,m,g,v,h,y,T,j,I,b,w=e("../util/load.js")(),x=e("../../../common/comm.js"),k=e("../../../common/util/listener.js"),F=e("../config/config.json"),C=e("../util/showTip.js"),S=e("./leaveDropdown.js"),L=e("./dropdownClassify.js"),M=e("../../../common/util/monitAjax.js")(i),A=e("./template.js"),P=!1,D=!1,_=!1,N=!1,R=!1,O=!1,B=!1,z=!0,E=60,q=60,H=[],W=!1,U=0,G=0,V=0,Z=0,s=i.apiInit.uid,J=(i.apiInit.cid,i.userInfo.color?i.userInfo.color:i.apiConfig.color),Q=i.language.lan,l=i.language.text,K=[],X={},Y="",ee="",ie=i.urlParams.leaveMsgGroupId||"",te=navigator.userAgent.toLowerCase(),ae={},se=[],ne={score:5},oe=function(){$leaveMsglayer.removeClass("show"),$(".js-drag-layer").css("display","block"),window.parent!==window&&window.parent.postMessage(JSON.stringify({name:"toggleDrag",toggleDrag:"true"}),"*"),$("#leaveMsg").animate({right:"-390px"},function(){a.remove()}),$sureWindow.removeClass("show"),$sureWindowlayer.removeClass("show"),$(".gt_holder").remove(),clearInterval(G),clearInterval(V),clearInterval(Z)},re=function(){$(".js-drag-layer").css("display","none"),$(".js-drag-layer").remove(),window.parent!==window&&window.parent.postMessage(JSON.stringify({name:"toggleDrag",toggleDrag:"false"}),"*"),$(".js-leaveMsglayer").addClass("show"),$("#leaveMsg").animate({right:"0"}),t&&($(".leaveMsgShowtem").css("display","none"),$(".leaveMsgRecord").css("display","block"),$(".js-titleTwo").addClass("active").siblings().removeClass("active")),i.apiConfig.ticketShowFlag||$(".js-titleTwo").css("display","none")},le=function(){var e=d.val();return""===e?(_text=l.T0037,$leaveMsgDetailTip.html(_text).css("visibility","inherit"),P=!1,!1):($leaveMsgDetailTip.css("visibility","hidden"),P=!0,!0)},ce=function(){var e=a.find(".js-leaveMsgDetail_msg").val();return""===e?(_text=l.T0146,$leaveMsgDetailTip.html(_text).css("visibility","inherit"),!1):($leaveMsgDetailTip.css("visibility","hidden"),!0)},de=function(){var e=$(".js-email").val(),i=/^([a-zA-Z0-9]+([-_\.][a-zA-Z0-9]+)*(?:@(?!-))(?:(?:[-a-zA-Z0-9]*)(?:[a-zA-Z0-9](?!-))(?:\.(?!-)))+[a-zA-Z0-9]{2,})$/;if(o){if(e&&i.test(e))return v.css("visibility","hidden"),D=!0,!0;var t=l.T0036;return""===e&&(t=l.T0035),v.html(t).css("visibility","inherit"),D=!1,!1}return e&&!i.test(e)?(v.html(t).css("visibility","inherit"),D=!1,!1):(v.css("visibility","hidden"),D=!0,!0)},ue=function(){var e=/(^1\d{10}$)/,i=$(".js-telephone").val(),t=l.T0045;if(_=!1,n){if(!i||!e.test(i))return h.html(t).css("visibility","inherit"),_;h.css("visibility","hidden")}else{if(i&&!e.test(i))return h.html(t).css("visibility","inherit"),_;h.css("visibility","hidden")}return _=!0,!0},pe=function(){r?$(".js-leaveMsgFileStyle").length?N=!0:(N=!1,$enclosureTip.html(l.T0076).css("visibility","inherit")):N=!0},fe=function(e,i){var t=!1,a=!1,s=!1,n=!1;return i.forEach(function(e){7===e&&(s=!0,n=!1,a=!1,t=!1),8===e&&s===!1&&(n=!0,a=!1,t=!1),5===e&&s===!1&&n===!1&&(a=!0,t=!1),4===e&&s===!1&&n===!1&&a===!1&&(t=!0)}),s?/^([A-Za-z0-9_\-\.])+\@([A-Za-z0-9_\-\.])+\.([A-Za-z]{2,4})$/.test(e):n?/^1[1-9]\d{9}$/.test(e):a?/^[0-9]+$/.test(e):!t||/^[\u4e00-\u9fa5_a-zA-Z0-9]+$/.test(e)},me=function(e){for(var t=0,n=0;n<K.length;n++)if(X[K[n].id].fillFlag&&""==X[K[n].id].value)a.find(".js-errorTip"+X[K[n].id].id).css("visibility","inherit"),B=!1;else if(1==X[K[n].id].fieldType&&""!=X[K[n].id].value&&X[K[n].id].limitOptions&&X[K[n].id].limitOptions.length>0){var o=fe(X[K[n].id].value,X[K[n].id].limitOptions);o?(a.find(".js-errorTip"+X[K[n].id].id).css("visibility","hidden"),t++):(a.find(".js-errorTip"+X[K[n].id].id).css("visibility","inherit"),B=!1)}else K[n].value=X[K[n].id].value,a.find(".js-errorTip"+X[K[n].id].id).css("visibility","hidden"),t++;0!=K.length&&t!=K.length||(B=!0),2==i.urlParams.ticketTypeFlag&&(Y=i.urlParams.ticketTypeId),1==i.urlParams.ticketTypeFlag&&""===Y?(R=!1,a.find(".js-errorQuestionClass").css("visibility","inherit")):(R=!0,a.find(".js-errorQuestionClass").css("visibility","hidden"));var r=a.find(".js-ticketTitle").val();if(1==i.urlParams.ticketTitleShowFlag&&""==r?(O=!1,a.find(".js-ticketTitle-tip").css("visibility","inherit")):(O=!0,a.find(".js-ticketTitle-tip").css("visibility","hidden")),le()||(P=!1),de()||(D=!1),ue()||(_=!1),pe(),W)return void C.show(l.T0090);if(e&&1===e&&(U=0),U>0)return $commitSureWindow.animate({opacity:"1"}).addClass("show"),void $sureWindowlayer.animate({opacity:"1"}).addClass("show");if(P&&D&&_&&N&&B&&O&&R&&z){for(var p=d.val()||"",m=u.val()||"",g=f.val()||"",v=0,h=0,y=i.sysnum,T="",j=[],n=0;n<H.length;n++)""!==H[n]&&j.push(H[n]);if(p.length>5e3)return void C.show(Q.L10042);if(T=j.join(";"),I=JSON.stringify(K),i.urlParams.enclosureShowFlag&&i.urlParams.enclosureFlag&&!T)return void $enclosureTip.html(l.T0076).css("visibility","inherit");if(c)$(".gt_holder").addClass("gt_show").removeClass("gt_hide");else{z=!1;var b={uid:s,companyId:y,ticketContent:p,customerEmail:m,customerPhone:g,ticketFrom:v,customerSource:h,fileStr:T,customerNick:i.apiInit.uname,groupId:i.urlParams.leaveMsgSendGroupIdFlag?ie:"",extendFields:I,ticketTypeId:Y,ticketTypeNamePath:ee,templateId:i.urlParams.templateId||1,ticketTitle:r};M({type:"post",url:"/chat/data/postMsg.action",dataType:"json",data:b,success:function(e){if(e&&"000000"==e.retCode){var i={type:"system",status:"leaveMsgComplete",data:{content:l.T0056}};k.trigger("sendArea.sendAreaSystemMsg",i),d.val(""),u.val(""),f.val(""),oe(),C.show(l.T0032),setTimeout(function(){z=!0},5e3)}else C.show(Q.L10038)},error:function(){C.show(l.T0033)}})}}},ge=function(){$(this).css({border:"1px solid #acbbbf"})},ve=function(){$(this).css({border:"1px solid #e0e9e8"})},he=function(){""!==d.val()||""!==u.val()||""!==f.val()||$(".js-leaveMsgFileStyle").length?($sureWindow.addClass("show"),$sureWindow.animate({opacity:"1"}),$sureWindowlayer.addClass("show"),$sureWindowlayer.animate({opacity:"1"})):oe()},ye=function(){var e=$(this).val();""===e?$(this).next().css("visibility","inherit"):$(this).next().css("visibility","hidden"),e&&(_length=e.length)},Te=function(e){var i=$(e).val();""===i?$(e).next().css("visibility","inherit"):$(e).next().css("visibility","hidden"),i&&(_length=i.length)},je=function(){var e=0;e>200&&$(this).val($(this).val().substring(0,200))},Ie=function(){var e=$(".js-mainBox").height()-E-q;$(".leaveMsgBody").height(e)},be=function(){M({type:"post",url:"/chat/data/isMessage.action?t="+(new Date).getTime(),dataType:"json",data:{uid:s,msgFlag:"0"},success:function(e){c=+e.isMessage,c&&e.resStr&&(e.resStr=JSON.parse(e.resStr),initGeetest({gt:e.resStr.gt,challenge:e.resStr.challenge,offline:!e.resStr.success,product:"popup"},we))}})},we=function(e){e.onSuccess(function(){for(var t=e.getValidate(),n=d.val()||"",o=u.val()||"",r=f.val()||"",c=0,p=i.sysnum,m="",g=[],v=0;v<H.length;v++)""!==H[v]&&g.push(H[v]);return m=g.join(";"),n.length>5e3?void C.show(Q.L10042):void M({url:"/chat/data/postMsgAfterVerify.action",type:"post",dataType:"json",data:{uid:s,companyId:p,source:c,ticketFrom:c,customerSource:c,customerPhone:r,customerEmail:o,ticketContent:n,msgFlag:"0",fileStr:m,geetest_challenge:t.geetest_challenge,geetest_validate:t.geetest_validate,geetest_seccode:t.geetest_seccode,customerNick:i.apiInit.uname,groupId:i.urlParams.leaveMsgSendGroupIdFlag?ie:"",extendFields:I,ticketTypeId:Y,ticketTypeNamePath:ee,templateId:i.urlParams.templateId||1,ticketTitle:a.find(".js-ticketTitle").val()},success:function(e){if(e&&"000000"==e.retCode){$(".gt_holder").remove();var i={type:"system",status:"leaveMsgComplete",data:{content:l.T0056}};k.trigger("sendArea.sendAreaSystemMsg",i),oe(),C.show(l.T0032)}else C.show(Q.L10038)}})}),e.appendTo(".js-popup-captcha-pc"),xe()},xe=function(){var e=$(".js-mainBox").width(),i=$(".js-mainBox").height();$("#popup-captcha-pc").css({top:(i-250)/2+"px",left:(e-260)/2+"px"})},ke=function(){if($(".js-leaveMsgFileStyle").length>4)return C.show(l.T0077),void Me();if(window.FormData){var e=+new Date,i=$leaveMsgUploadBtn[0],t=$leaveMsgUploadBtn.val(),a=t.substr(t.lastIndexOf(".")),s=t.substring(t.lastIndexOf("\\")+1,t.lastIndexOf("."));if(Le(a,s)){var n=i.files[0],o=n.size;if(o<1024)o+="B";else if(o<1048576)o=(o/1024).toFixed(2)+"KB";else{if(o=(o/1048576).toFixed(2),o>50)return C.show(l.T0082),void Me();o+="M"}Fe(n,a,s,o,e)}}else $e(),$sureWindowlayer.addClass("show"),$sureWindowlayer.removeClass("show")},Fe=function(e,i,t,s,n){var o={filename:t,extension:i,filesize:s,date:n,languageText:l},r=doT.template(A.leaveMsgFileStyle)(o);a.find(".js-enclosureTip").before(r),Ce(e,i,t,n)},Ce=function(e,t,s,n){var o=(i.apiConfig.uid+n,new XMLHttpRequest),r=new FormData;r.append("file",e),r.append("type","msg"),r.append("uid",i.apiInit.uid),r.append("pid",i.apiInit.pid),r.append("countTag",1),r.append("source",0),o.open("post","/chat/webchat/fileUploadForPostMsgBypc.action");var c=new FileReader;c.readAsDataURL(e),c.onload=function(e){o.send(r)},a.delegate(".js-leaveMsgFileClose"+n,"click",function(){o.abort(),W=!1;var e=$(this).attr("data-url");if(e){var i=H.join(";");i=i.replace(e,""),H=i.split(";")}$(this).parent().remove(),Me(),U--,a.find(".js-leaveMsgFileClose"+n).attr("data-url",e)}),o.onreadystatechange=function(e){if(4==e.target.readyState){if(200==e.target.status){var i=JSON.parse(e.target.response).url;H.push(i),$enclosureTip.css("visibility","hidden"),a.find(".js-leaveMsgFileClose"+n).attr("data-url",i)}else a.find(".js-leaveMsgFile"+n).find(".fileTip").html(l.T0075).addClass("fileTipShow"),U++;Me()}},o.upload.addEventListener("progress",function(e){if(e.lengthComputable){W=!0;var i=Math.round(100*e.loaded/e.total),t=i.toString();a.find(".js-leaveMsgProcess"+n).css("width",t+"%"),"100"==t&&(W=!1,a.find(".js-leaveMsgProcess"+n).parent().remove())}else a.find(".js-leaveMsgProcess"+n).parent().remove()},!1)},$e=function(){var e=a.find(".js-leavemsgfileinfo");e.find('input[name="pid"]').val(i.apiInit.pid);var t=$leaveMsgUploadBtn.val(),s=t.substr(t.lastIndexOf(".")),n=t.substring(t.lastIndexOf("\\")+1,t.lastIndexOf(".")),o=+new Date;i.apiConfig.uid+o;if(Le(s,n)){var r=Se(s,n),l="iframe"+r;e.attr("target",l),e.attr("action","/chat/webchat/fileUploadForPostMsgBypc.action");var c=$('<iframe id="'+l+'" style="display:none;height:1000px;width:500px;" name="'+l+'" src="about:blank;"></iframe>');c.on("load",function(){var e=c[0],i=e.contentWindow.document.getElementsByTagName("body")[0].innerHTML;if(i){var t=JSON.parse(i);t.filesize===!1?(C.show("文件太大，上传失败"),a.find(".js-leaveMsgFile"+r).find(".ie-uploadLoading").remove(),a.find(".js-leaveMsgFile"+r).find(".fileTip").addClass("fileTipShow"),U++):(a.find(".js-leaveMsgFile"+r).find(".ie-uploadLoading").remove(),H.push(t.url)),a.find(".js-leaveMsgFileClose"+r).attr("data-url",t.url),a.delegate(".js-leaveMsgFileClose"+r,"click",function(){var e=$(this).attr("data-url");if(e){var i=H.join(";");i=i.replace(e,""),H=i.split(";")}$(this).parent().remove(),Me(),U--})}}),$(document.body).append(c),e.submit()}Me()},Se=function(e,i){var t=+new Date,s={filename:i,extension:e,date:t,languageText:l},n=doT.template(A.IframeleaveMsgFileStyle)(s);return a.find(".js-leaveMsgUpload").append(n),t},Le=function(e,i){var t="";return e=e.toLowerCase(),t=/^(.jpg|.jpeg|.png|.gif|.tiff|.bmp|.xls|.xlsx|.csv|.pdf|.doc|.docx|.odc|.txt|.wps|.et|.xps|.rtf|.ppt|.pptx|.otd|.rmvb|.rm|.flv|.mp4|.mid|.3gp|.mpg|.mov|.mkv|.mp3|.wma|.wav|.rar|.zip|.psd)$/,!!t.test(e)||(e&&C.show(l.T0078),Me(),!1)},Me=function(){a.find(".js-leaveMsgUploadBtn").val(""),a.find(".js-leavemsgfileinfo")[0].reset()},Ae=function(){var e=$(this).attr("data-fieldId"),i=[],t=[];$(this).find(".js-userCheckIco"+e).hasClass("userCheckIcoActive")?($(this).addClass("userCheck"),$(this).find(".js-userCheckIco"+e).removeClass("userCheckIcoActive")):($(this).removeClass("userCheck"),$(this).find(".js-userCheckIco"+e).addClass("userCheckIcoActive")),$(".js-userCheckIco"+e).each(function(){$(this).hasClass("userCheckIcoActive")&&(i.push($(this).parent().attr("dataValue")),t.push($(this).parent().attr("dataName")))}),i=i.join(","),t=t.join(",");var a={fieldId:e,dataValue:i,dataName:t};X[a.fieldId].value=a.dataValue},Pe=function(){var e=$(this).attr("data-fieldId"),i=$(this).attr("dataValue"),t=$(this).attr("dataName");$(".js-userOptIco"+e).removeClass("userOptIcoActive"),$(".js-userOptIco"+e).parent().addClass("userOpt"),$(this).removeClass("userOpt").find(".js-userOptIco"+e).addClass("userOptIcoActive");var a={fieldId:e,dataValue:i,dataName:t};X[a.fieldId].value=a.dataValue},De=function(){var e=$(this).attr("data-fieldId"),i=$(this).val();X[e].value=i,a.find(".js-errorTip"+e).css("visibility","hidden")},_e=function(e,i){X[i].value=e,a.find(".js-errorTip"+i).css("visibility","hidden")},Ne=function(e){e.key?(Y=e.dataId,ee=e.typePathName,a.find(".js-errorQuestionClass").css("visibility","hidden")):("definedList"==e.type?X[e.fieldId].value=e.dataValue:"time"==e.type&&(X[e.fieldId].value=e.dataValue),a.find(".js-errorTip"+e.fieldId).css("visibility","hidden"))},Re=function(){var e=doT.template(A.evaluationDialog)(ae);$(".leaveMsglayer-wrapper").append(e),se=ae.ticketScoreInfooList},Oe=function(){$(".evaluation-layer").remove()},Be=function(){var e=$(this).index();$(".js-start-btn").each(function(i,t){i<=e?$(t).addClass("active"):$(t).removeClass("active")}),ne.score=e+1,$(".js-change-evaluation").text(se[e].scoreExplain)},ze=function(){$("#js-text-evaluation").length>0?ne.remark=$("#js-text-evaluation").val():ne.remark="",$.ajax({type:"POST",url:"/chat-web/data/invokeOtherByUser.action",dataType:"json",data:{uid:s,param:JSON.stringify(ne),url:"ws/addTicketSatisfactionScoreInfo/4",method:"post"},success:function(e){if(e.retCode="000000"){$(".evaluation-layer").remove();var i=se[ne.score-1].scoreExplain+"("+ne.score+"星)",t="";ne.remark&&(t='<div><span style="color: #333">评价反馈：</span><span style="color: #888;word-break: break-all;text-align: justify">'+ne.remark+"</span></div>");var a='<div style="margin-left: 23px;margin-bottom: 10px;"><div><span style="color: #333">评价星级：</span><span style="color: #888">'+i+"</span></div>"+t+"</div>";ne={score:5},$(".js-evaluation-area").before(a),$(".js-evaluation-area").remove()}}})},Ee=function(e){var t=i.urlParams.msgTxt,s=i.urlParams.msgTmp;w.load(F.basePath+"/views/sendArea/leaveMessage.html").then(function(c){var u=doT.template(c)({global:i,guide:t,leaveMsgDetail:s,languageText:l,definedField:e.items,ticketTitleShowFlag:i.urlParams.ticketTitleShowFlag});a=$(u),$(".js-mainBox").append(a);for(var f=0;f<e.items.length;f++){var g={};g.id=e.items[f].cusFieldConfig.fieldId,g.fieldName=e.items[f].cusFieldConfig.fieldName,4==e.items[f].cusFieldConfig.fieldType?(g.fillFlag=0,g.value="00:00"):(g.fillFlag=e.items[f].cusFieldConfig.fillFlag,g.value=""),g.limitOptions=e.items[f].cusFieldConfig.limitOptions,g.fieldType=e.items[f].cusFieldConfig.fieldType,K.push(g),X[g.id]=g}We(),Ge(),re(),Ie(),S(a,i),L(a,i),Ve(),$leaveMsgsubmit.css("background",J);i.urlParams.emailFlag||"",i.urlParams.emailShowFlag||"";1==i.urlParams.emailShowFlag?o=1==i.urlParams.emailFlag:(p.remove(),D=!0);i.urlParams.telFlag||"",i.urlParams.telShowFlag||"";1==i.urlParams.telShowFlag?(n=!0,n=0!=i.urlParams.telFlag):(m.remove(),_=!0),1==i.urlParams.enclosureShowFlag?r=0!=i.urlParams.enclosureFlag:$leaveMsgUpload.remove();var v=$txtTip.height();v>114&&d.height(v);for(var f=0,h=e.items.length;f<h;f++)3==e.items[f].cusFieldConfig.fieldType&&a.find("#dp"+e.items[f].cusFieldConfig.fieldId).datepicker().on("changeDate",function(e){var i,t,a,s=e.date;i=s.getFullYear(),t=s.getMonth()+1<10?"0"+(Number(s.getMonth())+1):s.getMonth()+1,a=s.getDate()<10?"0"+s.getDate():s.getDate(),_bir=i+"-"+t+"-"+a,$(this).val(_bir);var n=$(this).attr("data-fieldId");_e(_bir,n),$(".datepicker.dropdown-menu").hide()})})},qe=function(){var e=i.apiConfig.msgLeaveTxt,t=i.apiConfig.msgLeaveContentTxt;w.load(F.basePath+"/views/sendArea/leaveMsg.html").then(function(s){var n=doT.template(s)({global:i,msgLeaveTxt:e,leaveMsgDetail:t,languageText:l});a=$(n),$(".js-mainBox").append(a),We(),Ge(),re()})},He=function(){var e=$(this).attr("data-fieldId"),i=$(".js-definedNumInput"+e).val();i.length>300&&(i=i.slice(0,300)),$(".js-definedNumInput"+e).val(i)},We=function(){u=a.find(".js-email"),p=a.find(".js-emailArea"),f=a.find(".js-telephone"),m=a.find(".js-telArea"),d=a.find(".js-leaveMsgDetail"),g=a.find(".js-leaveMessage"),$leaveMsgDetailTip=a.find(".js-leaveMsgDetailTip"),v=a.find(".js-emailTip"),h=a.find(".js-telephoneTip"),$leaveMsgsubmit=a.find(".js-leaveMsgsubmit"),$leaveMsglayer=a.find(".js-leaveMsglayer"),$focusStyle=a.find(".js-focusStyle"),$close=a.find(".js-close"),$txtTip=a.find(".js-txt-tip"),$sureWindow=a.find(".js-sureWindow"),$leaveclose=a.find(".js-leaveclose"),$leavecancel=a.find(".js-leavecancel"),$leavesure=a.find(".js-leavesure"),y=a.find(".js-leaveMsgHeader"),$sureWindowlayer=a.find(".js-sureWindowlayer"),$leaveMsgUploadBtn=a.find(".js-leaveMsgUploadBtn"),$leaveMsgUpload=a.find(".js-leaveMsgUpload"),$enclosureTip=a.find(".js-enclosureTip"),$commitSureWindow=a.find(".js-commitSureWindow"),$commitLeavesure=a.find(".js-commitLeavesure"),$leaveMsgBody=a.find(".js-leaveMsgBody"),$definedFields=a.find(".js-definedFields"),$userCheck=a.find(".js-userCheck"),$userOpt=a.find(".js-userOpt"),$definedNumInput=a.find(".js-definedNumInput"),$jsTitle=a.find(".js-title"),$jsTitles=a.find(".js-titles"),$descript=$(".detailed-description"),j=a.find(".bgback")},Ue=function(){var e=$("<div></div>").text($(".js-leaveMsgDetail_msg").val());if(_content=e.html(),""!=_content){var t={uid:s,companyId:i.sysnum,groupId:i.urlParams.leaveMsgSendGroupIdFlag?ie:"",content:_content};z&&(z=!1,M({type:"post",url:"/chat-web/user/leaveMsg.action",dataType:"json",data:t,success:function(e){if(e&&1==e.status){var i={type:"system",status:"leaveMsgComplete",data:{content:l.T0157}};k.trigger("sendArea.sendLeaveMsg",{answer:_content}),k.trigger("sendArea.sendAreaSystemMsg",i),k.trigger("core.sessionclose",888),oe(),setTimeout(function(){z=!0},5e3)}else C.show(Q.L10038)},error:function(){C.show(l.T0033)}}))}},Ge=function(){j.on("click",function(){$("#leaveMsg1").css("display","block"),$("#leaveMsg2").css("display","none")}),$jsTitle.on("click",function(){$(this).addClass("active").siblings().removeClass("active"),"请您留言"===$(this)[0].innerHTML?(a.find(".leaveMsgShowtem").css("display","block"),a.find(".leaveMsgRecord").css("display","none")):(a.find(".leaveMsgShowtem").css("display","none"),a.find(".leaveMsgRecord").css("display","block"),T=a.find(".quectionDisc"))}),$(".clickShow").on("click",function(){$(".tubo").toggleClass("active"),$(".detailed-description").toggleClass("active")}),$close.on("click",he),$leaveMsglayer.on("click",he),$leavesure.on("click",oe),d.on("blur",le),a.find(".js-leaveMsgDetail_msg").on("blur",ce),u.on("blur",de),f.on("blur",ue),$leaveMsgsubmit.on("click",me),$focusStyle.on("focus",ge),$focusStyle.on("blur",ve),$(window).on("resize",Ie),d.on("input",je),$definedNumInput.on("input",He),$commitLeavesure.on("click",function(){me(1)}),a.delegate(".js-definedInput","blur",De),k.on("sendArea.definedFieldResult",Ne),te.indexOf("ie 7")!==-1&&$leaveMsgBody.on("scroll",function(){$sureWindowlayer.addClass("show"),$sureWindowlayer.removeClass("show")}),$leaveMsgUploadBtn.on("change",ke),x.detectEventSupport("input")?(d.on("input",ye),u.on("input",ye),f.on("input",ye)):G=setInterval(function(){Te(".js-leaveMsgDetail")},100),$txtTip.on("click",function(){d.focus()}),$leavecancel.on("click",function(){$sureWindow.css({opacity:"0"}).removeClass("show"),$sureWindowlayer.css({opacity:"0"}).removeClass("show"),$commitSureWindow.animate({opacity:"0"}).removeClass("show")}),$leaveclose.on("click",function(){$sureWindow.css({opacity:"0"}).removeClass("show"),$sureWindowlayer.css({opacity:"0"}).removeClass("show"),$commitSureWindow.animate({opacity:"0"}).removeClass("show")}),$leavesure.css({background:J,color:"#fff"}),$commitLeavesure.css({background:J,color:"#fff"}),$userCheck.on("click",Ae),$userOpt.on("click",Pe),a.find(".js-leaveMsgDetail_msg").on("input",function(){a.find(".js-leaveMsgCommit").css("background",J)}),a.find(".js-leaveMsgCommit").on("click",function(){Ue()}),a.on("click",".js-evaluation-score",Re),a.on("click",".js-close-evaluation",Oe),a.on("click",".js-start-btn",Be),a.on("click",".js-submit-evaluation",ze)},Ve=function(){if(i.apiInit.userId&&"null"!==i.apiInit.userId&&"undefined"!==i.apiInit.userId)$.ajax({type:"get",dataType:"json",url:"/chat-web/user/getUserTicketInfoList.action",data:{uid:s},success:function(e){if(e.retCode="000000"){if(b=e.items,!b.length)return void $(".js-titleTwo").remove();var t={items:b,languageText:l},n=doT.template(A.switchLeaveMsgTemplate)(t);$(".js-leaveMsgRecord").html(n),T=$(".js-li-click"),T.off("click"),T.on("click",function(){var e=$(this).index();$("#leaveMsg1").css("display","none"),$("#leaveMsg2").css("display","block"),j=a.find(".bgback");var t=JSON.stringify({companyId:i.sysnum,ticketId:b[e].ticketId});ne.companyId=i.sysnum,ne.ticketId=b[e].ticketId,$.ajax({type:"get",url:"/chat-web/data/invokeOtherByUser.action",dataType:"json",data:{uid:s,param:t,url:"ws/getUserDealTicketInfoList/4",method:"get"},success:function(e){if(e.retCode="000000"){var i={items:e.items,currentOrderData:b,languageText:l,endFlag:e.items[0].flag};e.items.forEach(function(e){3==e.flag&&(e.ticketScoreInfooList&&e.ticketScoreInfooList.reverse(),ae=e)});var t=doT.template(A.procressLeaveMsg)(i),a=doT.template(A.showOrHide)(i);$(".js-bottomss").html(t),$(".detailed-description").html(a),Ve()}}})})}}});else{$(".js-titleTwo").remove(),b=[];var e={items:b,languageText:l},t=doT.template(A.switchLeaveMsgTemplate)(e);$(".js-leaveMsgRecord").html(t)}},Ze=function(){if(2==i.apiConfig.msgToTicketFlag)qe();else{var e={operateType:3,openFlag:1,templateId:i.urlParams.templateId},t=JSON.stringify(e),a={uid:s,url:"basic-set/getTemplateFieldsInfo/4",method:"get",param:t};M({url:"/chat/data/invokeOtherByUser.action",dataType:"json",type:"get",data:a}).success(function(e){Ee(e),be()})}C=C(i)};Ze(),window.validateField=function(e){var i=$(e),t=i.data("info");if(t.length>0){var a=!1,s=!1,n=!1,o=!1;t.forEach(function(e){7===e&&(n=!0,o=!1,s=!1,a=!1),8===e&&n===!1&&(o=!0,s=!1,a=!1),5===e&&n===!1&&o===!1&&(s=!0,a=!1),4===e&&n===!1&&o===!1&&s===!1&&(a=!0)}),o&&i.val(i.val().replace(/\D/g,"")),s&&i.val(i.val().replace(/\D/g,"")),a&&i.val(i.val().replace(/[^\u4E00-\u9FA5A-Za-z0-9]/g,""))}}};i.exports=a},{"../../../common/comm.js":1,"../../../common/util/listener.js":33,"../../../common/util/monitAjax.js":35,"../config/config.json":38,"../util/load.js":65,"../util/showTip.js":71,"./dropdownClassify.js":49,"./leaveDropdown.js":54,"./template.js":57}],56:[function(e,i,t){var a=function(i){var t,a,s,t,n,o,r=(e("../../../common/util/listener.js"),e("../../../common/util/monitAjax.js")(i)),l=e("./template.js"),c=e("../../../common/comm.js"),d=function(){a.removeClass("show"),s.animate({right:"-390px"},function(){t.remove()})},u=function(){a.addClass("show"),s.animate({right:"0"})},p=function(e){o=c.getQueryParam();var a=document.location.href,s=a.substring(0,a.indexOf("?")+1);for(key in o)"robotid"==key||(s+=key+"="+encodeURIComponent(o[key])+"&");s=s.substring(0,s.lastIndexOf("&"));var n={uid:i.apiInit.uid,channelFlag:o.channelFlag||""};r({url:"/chat-web/user/getRobotSwitchList.action",dataType:"json",type:"get",data:n}).success(function(e){if(1==e.status){for(var a=0;a<e.list.length;a++)e.list[a].newLink=s+"&robotid="+e.list[a].robotFlag,e.list[a].robotFlag==i.apiConfig.robotid&&(e.list[a].currentRobot=1);var n={languageText:i.language.text,list:e.list},o=doT.template(l.switchRobotTemplete)(n);t=$(o),$(".js-mainBox").append(t),t.find(".js-currentRobot").css({background:i.userInfo.color,border:"1px solid "+i.userInfo.color}),f(),m(),u()}})},f=function(){a=t.find(".js-switchRobotlayer"),s=t.find(".js-switchRobot"),n=t.find(".js-close")},m=function(){n.on("click",d),a.on("click",d),t.find(".js-switchRobotEle").hover(function(){$(this).css({background:i.userInfo.color,border:"1px solid "+i.userInfo.color}),$(this).find("a").css({color:"#fff"})},function(){$(this).css({background:"#fff",border:"1px solid #e0e9e8"}),$(this).find("a").css({color:"#535656"})})},g=function(){p()};g()};i.exports=a},{"../../../common/comm.js":1,"../../../common/util/listener.js":33,"../../../common/util/monitAjax.js":35,"./template.js":57}],57:[function(e,i,t){var a={},s='<div class="evaluation-layer"><div class="dialog-box"><div class="dialog-content"><div class="close-dialog"><i class="js-close-evaluation"></i></div><div class="title">请您对本次服务进行评分</div><div class="star-list"><ul class="clearfix"><li class="js-start-btn active"></li><li class="js-start-btn active"></li><li class="js-start-btn active"></li><li class="js-start-btn active"></li><li class="js-start-btn active"></li></ul></div><div class="tips js-change-evaluation">{{=it.ticketScoreInfooList[4].scoreExplain }}</div>{{ if(it.txtFlag == 1){ }}<div class="desc"><textarea maxlength="150" id="js-text-evaluation" placeholder="欢迎给我们的服务提意见～"></textarea></div>{{ } }}{{ else{ }}<div style="margin-top: 80px"></div>{{ } }}<a class="submit js-submit-evaluation" href="javascript:">提交评价</a></div></div></div>',n='<div><div class="group-layer js-group-layer"></div><div class="group-outer js-group-outer pc-leaveMessage-layer"><p class="group-title">请选择留言模板<span class="close_button js-cancel-btn js-group-cancel"></span></p><div class="group-main"><ul class="clearfix">{{  for(var i=0;i<it.list.length;i++){ }}{{ var item = it.list[i];}}<li class="js-item" data-id="{{=item.templateId}}">{{=item.templateName}}</li>{{  } }}</ul></div></div></div>',o='<div class="msgFileIco js-msgFileIco {{=it.fileIcoClass}}" style="float: left; width: 30px;height: 30px;margin-top: 3px;background-repeat: no-repeat;"></div><div class="msgFileDetail js-msgFileDetail" style="float: left;margin-left: 9px;font-size: 12px;"><p class="filename" title="{{=it.filename}}" style="width: 170px;height: 20px;color: #555556;overflow: hidden;text-overflow: ellipsis;word-break: normal;white-space: nowrap;font-size: 12px;">{{=it.filename}}</p><span class="fileSize" style="float: left;color: #8a9699;font-size: 12px">{{=it.filesize}}</span> <span class="sizeAfter js-sizeAfter" style="float: left;margin: 0 5px;color: #8a9699;font-size: 12px;">|</span><a class="filedownload js-filedownload" href="{{=it.url}}" target="_blank" style="display:block;color: #28a7dc!important; font-size: 12px; cursor: pointer;">{{=it.languageText.T0160}}</a></div>',r='<img src="{{=it.url}}" class="webchat_img_upload upNowImg uploadedFile" />',l='<div class="systeamTextBox systeamNowText js-systeamTextBox{{=it.date}}"><p class="systeamText">正在上传 {{=it.filename}}{{=it.extension}}</p></div>',c='<div class="evaluateWether"><p class="evaluateTitle"><label class="aname" style="text-overflow: ellipsis; max-width: 100px;word-break: normal;white-space: nowrap; display: inline-block; overflow: hidden;line-height: 13px;" title="{{=it.subName}}">{{=it.subName}}</label> {{=it.evaluateTitle}}</p><div class="btnGroup"><span class="js-isques evaluate-btn evaluateok"><i></i>{{=it.okText || "确定"}}</span><span class="js-noques evaluate-btn evaluateno"><i></i>{{=it.cancelText || "取消"}}</span></div></div>',d='<div class="evaluate js-evaluate"><div class="situation">{{for(var i=0;i<it.list.length;i++){}}{{if(i%2==0){}}<span class="tag js-tag">{{=it.list[i]}}</span>{{}else{}}<span class="tag js-tag" style="margin-right:0">{{=it.list[i]}}</span>{{}}}{{}}}</div><textarea id="js-evaluateInner" class="js-evaluateInner" placeholder="{{=it.languageText.T0028}}" maxLength="200"></textarea></div>',u='<div class="evaluateWether js-evaluate">{{if(it.config[0].isQuestionFlag){}}<div class="operateType"><p class="operateTypeTitle" title={{=it.aname}}>{{=it.subName}}{{=it.languageText.T0106}}</p><div class="operateTypeBtn"><p class="solve solved js-solved"><span></span>{{=it.languageText.T0041}}</p><p class="solve unSolved js-unSolved" style="margin-left:25px;"><span></span>{{=it.languageText.T0042}}</p></div></div>{{}}}<p class="evaluateTitle">{{=it.languageText.T0096}}</p><div id="star"><ul><li><a href="javascript:;">1</a></li><li><a href="javascript:;">2</a></li><li><a href="javascript:;">3</a></li><li><a href="javascript:;">4</a></li><li><a href="javascript:;">5</a></li></ul></div><p class="evaluateTip js-evaluateTip"><span style="color:#8b98ad;">{{=it.languageText.T0107}}</span></p><p class="js-evaluateTitle" style="font-size:15px;color:#555;margin:8px 0 20px;"></p></div>',p='<div class="evaluate js-evaluate"><div class="situation">{{for(var i=0;i<it.list.length;i++){}}{{if(i%2==0){}}<span class="tag js-tag">{{=it.list[i]}}</span>{{}else{}}<span class="tag js-tag" style="margin-right:0">{{=it.list[i]}}</span>{{}}}{{}}}</div>{{if(it.star != 6){}}<textarea id="js-evaluateInner" class="js-evaluateInner" placeholder="{{=it.conf.inputLanguage||it.languageText.T0028}}{{=it.conf.isInputMust?it.languageText.T0046:it.languageText.T0047}}" maxLength="200"></textarea>{{}}}</div>',f='<div class="evaluateSubmitArea">{{if(it.from=="close"){}}<a class="submit js-evaluateSubmit js-submitTheme" href="#">{{=it.languageText.T0029}}</a><a class="nosubmit js-noevaluateSubmit" href="#">{{=it.languageText.T0097}}</a>{{}else{}}<a class="submit js-evaluateSubmit js-submitTheme" href="#">{{=it.languageText.T0029}}</a>{{}}}</div>',m='<a class="js-leaveMsgBtn" href="{{=it.hostUrl}}"><i class="leaveMessagebg"></i><p>{{=it.languageText.T0030}}</p></a>',g='<span class="span3"><a class="js-leaveMsgBtn" href="{{=it.hostUrl}}"><i class="icon"></i><p>{{=it.languageText.T0030}}</p></a></span>',v='<div class="js-allScreen allScreen"><div class="loadingUploadImg"><i></i><p>{{=it.language.L10036}}</p></div></div>',h='<div class="js-evamsg evamsg"><p>{{=it.language.L10037}}</p></div>',y='<div class="js-evamsg evamsg" style="color:#cb1f16"><p>{{=it.language.L10038}}</p></div>',T='<div class="js-evaluateArea"><div class="evaluatelayer js-evaluatelayer"></div><div class="evaluateDialog js-evaluateDialog"><span class="close_button js-evaluateClose"></span><div class="evaluate-body-widely"><div class="model-body"></div><div class="model-body-extend"></div><div class="model-body-commit"></div></div></div></div>',j='<div class="js-leaveMsgFileStyle leaveMsgFileStyle js-leaveMsgFile{{=it.date}}"><p class="leaveMsgFileName" title="{{=it.filename}}{{=it.extension}}">{{=it.filename}}{{=it.extension}}</p><p class="leaveMsgFilesize">({{=it.filesize}})</p><p class="leaveMsgProcessWidely"><span class="js-leaveMsgProcess{{=it.date}} leaveMsgProcess"></span></p><p class="fileTip">{{=it.languageText.T0084}}</p><span class="leaveMsgFileClose js-leaveMsgFileClose{{=it.date}}"></span></div>',I='<div class="js-leaveMsgFileStyle leaveMsgFileStyle js-leaveMsgFile{{=it.date}}"><p class="leaveMsgFileName" title="{{=it.filename}}{{=it.extension}}">{{=it.filename}}{{=it.extension}}</p><p class="ie-uploadLoading">{{=it.languageText.T0083}}</p><p class="fileTip">{{=it.languageText.T0084}}</p><span class="leaveMsgFileClose js-leaveMsgFileClose{{=it.date}}"></span></div>',b='{{if(it.items.length>0){}}{{ for(var i=0;i<it.items.length;i++){ }}<li class="js-classDropdownLi js-classOrderList" data-nodeFlag="{{=it.items[i].nodeFlag}}" dataId="{{=it.items[i].typeId}}" data-name="{{=it.items[i].typePathName}}" data-key="classifyByPid" title="{{=it.items[i].typeName||""}}">{{=it.items[i].typeName}}{{if(it.items[i].nodeFlag){}}<span class="firstIcon"></span>{{}}}</li>{{ } }}{{ }else{ }} <li>空</li>{{ } }}',w='<div class="capture-outer"><p class="captTips">提示：建议使用微信或QQ的截图功能进行截图，然后直接粘贴到对话框即可。</p><p class="h5">您可按照以下步骤下载截图插件：</p><ol><li><h6>下载地址</h6><div class="capture-text">Windows系统下载qq截图插件 <a href="https://img.sobot.com/tools/%E6%88%AA%E5%9B%BE%E5%B7%A5%E5%85%B7-win.exe" target="_blank">点击此处</a></div><div class="capture-text">Mac系统下载qq截图插件 <a href="https://img.sobot.com/tools/%E6%88%AA%E5%9B%BE%E5%B7%A5%E5%85%B7-mac.dmg" target="_blank">点击此处</a></div></li><li><h6>完成下载后，请找到程序所在文件夹，然后按照下面链接的方法设置截图快捷键</h6><div class="capture-text">Windows系统下 <a href="https://jingyan.baidu.com/article/2fb0ba408a1e1300f2ec5f03.html" target="_blank">安装设置方法</a></div><div class="capture-text">Mac系统下 <a href="https://jingyan.baidu.com/article/3d69c5514e44a3f0ce02d751.html" target="_blank">安装设置方法</a></div></li><li><h6>完成上述步骤后，即可使用。</h6></li>',x='<ul class="respInfoList js-respInfoList">{{for(var i=0;i<it.respInfoList.length;i++){}}{{if(i<6){}}<li class="js-respInfoBtn" title="{{=it.respInfoList[i].question}}" data-docid="{{=it.respInfoList[i].docId}}">{{=it.respInfoList[i].highlight}}</li>{{}}}{{}}}</ul>',k='<div><div class="switchRobotlayer js-switchRobotlayer"></div><div class="switchRobot js-switchRobot"><div class="js-switchRobotHeader switchRobotHeader"><p class="title">{{=it.languageText.T0140}}</p><span class="close js-close"></span></div><div class="switchRobotBody js-switchRobotBody"><ul class="robotList">{{for(var i=0;i<it.list.length;i++){}}{{if(it.list[i].currentRobot){}}<li class="js-switchRobot currentRobot js-currentRobot"><a href="{{=it.list[i].newLink}}">{{=it.list[i].operationRemark}}</a></li>{{}else{}}<li class="js-switchRobotEle"><a href="{{=it.list[i].newLink}}">{{=it.list[i].operationRemark}}</a></li>{{}}}{{}}}</ul></div></div></div>',F='{{if(it.items.length===0){}}<span style="display: block;margin-top: 200px"> {{=it.languageText.T0148}}</span>{{}else{}}<div class="leaveMsgListRecord"><ul>{{for(var i=0;i<it.items.length;i++){}}<li class="js-li-click"><div class="quectionDisc"><div class="header"><div class="tips">{{=it.languageText.T0110}}{{if(it.items[i].newFlag===2){}}<span class="umi"><span>New</span></span>{{}}}</div>{{if(it.items[i].flag===3){}}<div class="state">{{=it.languageText.T0131}}</div>{{}else if(it.items[i].flag===2){}}<div class="state1">{{=it.languageText.T0132}}</div>{{}else{}}<div class="state2">{{=it.languageText.T0133}}</div>{{}}}</div><div class="content"><div class="culoum">{{=it.items[i].content}}</div></div><div class="bottom"><div class="left">{{=it.languageText.T0134}}:{{=it.items[i].ticketCode}}</div><div class="right">{{=it.items[i].timeStr}}</div></div></div></li>{{}}}</ul>{{}}}',C='<div class="bottom">{{for(var i=0;i<it.items.length;i++){}}{{if(it.items[i].flag===3){}}<div class="proseess"><div><span class="timer actives"></span><span class="texts active">{{=it.items[i].timeStr}}</span></div><div style="margin-top: 8px"><span class="tipsss active"></span><span class="texts active">{{=it.languageText.T0131}}</span></div><div class="contents-sl active" ><div style="margin-left: 15px"><div class="resful">{{=it.languageText.T0149}}</div><div class="resfuls">{{=(it.items[i].content||it.languageText.T0139)}}</div></div></div>{{ if(it.items[i].isOpen == 1 && it.items[i].isEvalution == 0){ }}<div class="js-evaluation-area" style="margin: 10px 0 10px 23px"><a href="javascript:" class="js-evaluation-score" style="display: block;width: 124px;line-height: 30px;font-size: 14px;color: #fff;background: #0DAEAF; text-align: center; border-radius: 2px;">立即评价</a></div>{{ } }}{{ else if(it.items[i].isEvalution == 1){ }}<div style="margin-left: 23px;margin-bottom: 10px;"><div><span style="color: #333">评价星级：</span><span style="color: #888">{{=it.items[i].ticketScoreInfooList[it.items[i].score - 1].scoreExplain}}({{=it.items[i].score}}星)</span></div>{{ if(it.items[i].remark){ }}<div><span style="color: #333">评价反馈：</span><span style="color: #888;word-break: break-all;text-align: justify">{{=it.items[i].remark}}</span></div>{{ } }}</div>{{ } }}</div>{{}}}{{if(it.items[i].flag===2){}}{{for(var j=0;j<it.items[i].replayList.length;j++){}}{{if(j===0&&it.items.length===2){}}<div class="proseess"><div><span class="timer actives"></span><span class="texts active">{{=it.items[i].replayList[j].replyTimeStr}}</span></div><div style="margin-top: 8px"><span class="tipsss active"></span><span class="texts active">{{=it.languageText.T0132}}</span></div><div class="contents-sl active" ><div style="margin-left: 15px">{{if(it.items[i].replayList[j].startType===0){}}<div class="resful">{{=it.languageText.T0149}}</div>{{}else if(it.items[i].replayList[j].startType===1){}}<div class="resful">{{=it.languageText.T0150}}</div>{{}}}<div class="resfuls">{{=(it.items[i].replayList[j].replyContent||it.languageText.T0139)}}</div></div></div></div>{{}else{}}<div class="proseess"><div><span class="timer"></span><span class="texts">{{=it.items[i].replayList[j].replyTimeStr}}</span></div><div style="margin-top: 8px"><span class="tipsss"></span><span class="texts">{{=it.languageText.T0132}}</span></div><div class="contents-sl" ><div style="margin-left: 15px">{{if(it.items[i].replayList[j].startType===0){}}<div class="resful">{{=it.languageText.T0149}}</div>{{}else if(it.items[i].replayList[j].startType===1){}}<div class="resful">{{=it.languageText.T0150}}</div>{{}}}<div class="resfuls">{{=(it.items[i].replayList[j].replyContent||it.languageText.T0139)}}</div></div></div></div>{{}}}{{}}}{{}}}{{if(it.items[i].flag===1){}}{{if(it.items.length===1){}}<div class="proseess"><div><span class="timer actives"></span><span class="texts active">{{=it.items[i].timeStr}}</span></div><div style="margin-top: 8px"><span class="tipsss active"></span><span class="texts active">{{=it.languageText.T0133}}</span></div></div>{{}else{}}<div class="proseess"><div><span class="timer"></span><span class="texts">{{=it.items[i].timeStr}}</span></div><div style="margin-top: 8px"><span class="tipsss"></span><span class="texts">{{=it.languageText.T0133}}</span></div></div>{{}}}{{}}}{{}}}</div>',$="<span>{{=it.items[it.items.length-1].content}}</span>";
a.evaluationDialog=s,a.groupTemplate=n,a.captureDialogTemplate=w,a.sobotEvaluateOne_selfHtml=c,a.sobotEvaluateTwo_selfHtml=d,a.humanOne_selfHtml=u,a.humanTwo_selfHtml=p,a.evaluateFooter_selfHtml=f,a.leaveMessageBtn=m,a.leaveMessageEndBtn=g,a.evamsgHtml=h,a.evamsgHtml2=y,a.waitingUploadImg=v,a.tranfiletype=o,a.fileImage=r,a.uploading=l,a.AlertTemplate=T,a.leaveMsgFileStyle=j,a.IframeleaveMsgFileStyle=I,a.classifyOrderList=b,a.respInfoList=x,a.switchRobotTemplete=k,a.switchLeaveMsgTemplate=F,a.procressLeaveMsg=C,a.showOrHide=$,i.exports=a},{}],58:[function(e,i,t){function a(i,t,a,s){var n=e("../../../common/util/listener.js"),o=e("../../../common/util/msgReminder.js"),r={},l=e("../util/modal/alert.js"),c=e("./fileType.json"),d=e("../util/showTip.js"),u=s.language.text,p=e("./fileTypeIcon.json"),f=e("./template.js"),m=function(){$node=$(i),$uploadBtn=$(".js-upload")},g=s.userInfo.color?s.userInfo.color:s.apiConfig.color;o.clear();var v=function(e,i){T(e,i)},h=function(e){for(var i=e.substring(e.indexOf(":")+1,e.indexOf(";")),t=e.substring(e.indexOf(",")+1),a=atob(t),s=new Array(a.length),n=0;n<a.length;n++)s[n]=a.charCodeAt(n);var o=new Uint8Array(s),r=new Blob([o],{type:i});return r},y=function(e,i,t){var a=e.getAsFile();if(a&&"image/png"==a.type){var n=new FormData,o=new FileReader;o.onload=function(e){var a=!1,o=e.target.result,r=h(o);n.append("file",r),n.append("type","paste"),n.append("pid",s.apiInit.pid),n.append("countTag",1),n.append("source",0);var c="image",d="智齿科技",p=".png",f=new l({title:u.T0167,text:'<img src="'+e.target.result+'">',okText:u.T0165,cancelText:u.T0166,OK:function(){a||(a=!0,j(i,t,p,d,c,r))}});f.show(),$(".js-ok-btn").css({background:g,color:"#fff"})},o.readAsDataURL(a)}},T=function(e,i){if(a.FormData){var t=$uploadBtn[0],s=$uploadBtn.val(),n=s.substr(s.lastIndexOf(".")),o=s.substring(s.lastIndexOf("\\")+1,s.lastIndexOf(".")),r=c[n],l=p[r];if(I(n,o)){var d=w(n,o),u=t.files[0];j(e,i,n,o,r,u,l,d)}$uploadBtn.val("")}else b(e,i)},j=function(e,i,t,a,o,r,l,c){var p=+new Date,f=e+p,m=new XMLHttpRequest,g=new FormData,v=!1;if("image"===o){m.open("post","/chat/webchat/fileuploadBase64.action");var h=new FileReader;h.readAsDataURL(r),h.onload=function(i){var t=i.target.result;g.append("sysNum",s.sysnum),g.append("uid",e),g.append("base64",t),n.trigger("sendArea.createUploadImg",{result:t,date:p,token:f}),m.send(g)},n.on("leftMsg.closeUploadImg",function(){v=!0,m.abort()}),m.onreadystatechange=function(s){if(4==s.target.readyState)if(200==s.target.status){var r=JSON.parse(s.target.response).url,p=JSON.parse(s.target.response).filesize;if(0==p)return void d.show(u.T0082);try{n.trigger("sendArea.uploadImgUrl",{uid:e,cid:i,url:r,filetype:o,filename:a,extension:t,fileIcon:l,date:c,dateuid:f})}catch(m){}}else{var g={result:"ImgSendFail",msgId:f};n.trigger("sendArea.msgresult",g)}}}else{var y=r.size,T=!1;if(y>52428800)return void d.show(u.T0082);y<1024?y+="B":y=y<1048576?(y/1024).toFixed(2)+"KB":(y/1048576).toFixed(2)+"M",g.append("file",r),g.append("type","msg"),g.append("pid",s.apiInit.pid),g.append("countTag",1),g.append("source",0),g.append("uid",e),m.open("post","/chat/webchat/fileupload.action");var h=new FileReader;h.readAsDataURL(r),h.onload=function(e){n.trigger("sendArea.createUploadFile",{filename:a,extension:t,filetype:o,filesize:y,date:p,token:f}),m.send(g)},n.on("listMsg.closeUploadFile",function(){T=!0,m.abort()}),m.onreadystatechange=function(s){if(4==s.target.readyState)if(200==s.target.status){var r=JSON.parse(s.target.response).url,d=JSON.parse(s.target.response).filesize;if(0==d)return;try{n.trigger("sendArea.uploadImgUrl",{uid:e,cid:i,url:r,filetype:o,filename:a,filesize:y,extension:t,fileIcon:l,date:c,dateuid:f})}catch(u){}}else T||n.trigger("sendArea.uploadFileFail",{dateuid:f})},m.upload.addEventListener("progress",function(e){if(e.lengthComputable){var i=Math.round(100*e.loaded/e.total),t=i.toString(),s={percentage:t,token:f,filename:a};n.trigger("sendArea.uploadFileProcess",s)}},!1)}},I=function(e,i){var t="",a=s.apiConfig.legalFileTypeList;t=/^(.eml|.otd|.msb|.ssu|.SSU|.bmp|.swj|.jpg|.JPG|.jpeg|.JPEG|.png|.PNG|.gif|.GIF|.txt|.TXT|.DOC|.doc|.docx|.DOCX|.pdf|.PDF|.ppt|.PPT|.pptx|.PPTX|.xls|.XLS|.xlsx|.XLSX|.RAR|.rar|.zip|.ZIP|.mp3|.MP3|.mp4|.MP4|.wma|.WMA|.wmv|.WMV|.rmvb|.RMVB|.mov|.MOV|.psd|.PSD)$/;var o=e.split(".")[1];if(a.indexOf(o)<0)return!0;var r={type:"system",status:"uploadFileError",data:{content:u.T0161+e+u.T0162}};return n.trigger("sendArea.sendAreaSystemMsg",r),!1},b=function(e,i){var t=$node.find(".js-fileinfo");t.find('input[name="pid"]').val(s.apiInit.pid);var a=$uploadBtn.val(),o=a.substr(a.lastIndexOf(".")),r=a.substring(a.lastIndexOf("\\")+1,a.lastIndexOf(".")),l=c[o],d=p[l],u=+new Date,f=e+u;if(I(o,r)){var m=w(o,r),g="iframe"+m;"image"===l?n.trigger("sendArea.createUploadImg",{result:"上传中...",date:u,token:f,browserVersion:"ie-"}):n.trigger("sendArea.createUploadFile",{filename:r,extension:o,filetype:l,date:u,token:f,browserVersion:"ie-"}),t.attr("target",g),t.attr("uid",e),t.attr("pid",s.apiInit.pid),t.attr("action","/chat/webchat/fileupload.action");var v=$('<iframe id="'+g+'" style="display:none;height:1000px;width:500px;" name="'+g+'" src="about:blank;"></iframe>');v.on("load",function(){var t=v[0],a=t.contentWindow.document.getElementsByTagName("body")[0].innerHTML;if(a){var s=JSON.parse(a);s.filesize===!1?(alert("文件太大，上传失败"),n.trigger("sendArea.uploadFileFail",{uid:e,cid:i,dateuid:f,browserVersion:"ie-"})):n.trigger("sendArea.uploadImgUrl",{uid:e,cid:i,url:s.url,filetype:l,filename:r||"",filesize:s.filesize,extension:o||"",fileIcon:d||"",date:m,dateuid:f,browserVersion:"ie-"})}}),$(document.body).append(v),t.submit()}$uploadBtn.val("")},w=function(e,i){var t=+new Date,a={filename:i,extension:e,date:t},s=doT.template(f.uploading)(a);return $node.find(".scrollBox").append(s),t},x=function(){},k=function(){m(),x(),d=d(s)};return k(),r.onFormDataPasteHandler=y,r.onChangeHandler=v,r}i.exports=a},{"../../../common/util/listener.js":33,"../../../common/util/msgReminder.js":36,"../util/modal/alert.js":66,"../util/showTip.js":71,"./fileType.json":51,"./fileTypeIcon.json":52,"./template.js":57}],59:[function(e,i,t){var a={},s=function(e){return e>=10?e+"":"0"+e},n=function(e){if(Object.prototype.toString.call(e).indexOf("Date")<0)throw"param error";var i=e.getHours(),t=e.getMinutes(),a=e.getSeconds(),n=[s(i),s(t),s(a)];return n.join(":")},o=function(e,i){var t,a=new Date,s=Math.abs(a-new Date(e.substr(0,e.indexOf(" "))))/1e3/60/60/24;e=e.replace(/-/g,"/");var n=s<=1?0:s>1&&s<=2?1:2,o=e.substring(0,e.lastIndexOf(":")),r=e.substring(e.indexOf(" "),e.lastIndexOf(":"));switch(n){case 0:t=i.T0011+r;break;case 1:t=i.T0013+r;break;case 2:t=o}return t};a.getTime=n,a.formatTime=o,i.exports=a},{}],60:[function(e,i,t){var a={};a.emojiTip=["u1F603","u1F604","u1F601","u1F606","u1F605","u1F923","u1F602","u1F642","u1F609","u1F60A","u1F607","u1F60D","u1F929","u1F618","u1F61A","u1F619","u1F60B","u1F61C","u1F61D","u1F917","u1F92D","u1F914","u1F910","u1F611","u1F60F","u1F612","u1F60C","u1F614","u1F637","u1F912","u1F635","u1F920","u1F60E","u1F913","u1F633","u1F628","u1F630","u1F625","u1F622","u1F62D","u1F631","u1F616","u1F623","u1F613","u1F620","u1F44B","u1F44C","u270C","u1F91F","u1F44D","u1F44F","u1F91D","u1F64F","u1F4AA","u1F647","u1F42E","u1F339","u1F940","u1F48B","u2764","u1F494","u2B50","u1F389","u1F37A","u1F381"],a.emojiSymbolTip=["😃","😄","😁","😆","😅","🤣","😂","🙂","😉","😊","😇","😍","🤩","😘","😚","😙","😋","😜","😝","🤗","🤭","🤔","🤐","😑","😏","😒","😌","😔","😷","🤒","😵","🤠","😎","🤓","😳","😨","😰","😥","😢","😭","😱","😖","😣","😓","😠","👋","👌","✌","🤟","👍","👏","🤝","🙏","💪","🙇","🐮","🌹","🥀","💋","❤","💔","⭐","🎉","🍺","🎁"],a.emojiReg=/(😃|😄|😁|😆|😅|🤣|😂|🙂|😉|😊|😇|😍|🤩|😘|😚|😙|😋|😜|😝|🤗|🤭|🤔|🤐|😑|😏|😒|😌|😔|😷|🤒|😵|🤠|😎|🤓|😳|😨|😰|😥|😢|😭|😱|😖|😣|😓|😠|👋|👌|✌|🤟|👍|👏|🤝|🙏|💪|🙇|🐮|🌹|🥀|💋|❤|💔|⭐|🎉|🍺|🎁)/g,a.emojiReg2=/(😃|😄|😁|😆|😅|🤣|😂|🙂|😉|😊|😇|😍|🤩|😘|😚|😙|😋|😜|😝|🤗|🤭|🤔|🤐|😑|😏|😒|😌|😔|😷|🤒|😵|🤠|😎|🤓|😳|😨|😰|😥|😢|😭|😱|😖|😣|😓|😠|👋|👌|✌|🤟|👍|👏|🤝|🙏|💪|🙇|🐮|🌹|🥀|💋|❤|💔|⭐|🎉|🍺|🎁)/,a.qqfaceReg=/\/::\)|\/::~|\/::B|\/::\||\/:8-\)|\/::<|\/::\$|\/::X|\/::Z|\/::'\(|\/::-\||\/::@|\/::P|\/::D|\/::O|\/::\(|\/::\+|\/:–b|\/::Q|\/::T|\/:,@P|\/:,@-D|\/::d|\/:,@o|\/::g|\/:\|-\)|\/::!|\/::L|\/::>|\/::,@|\/:,@f|\/::-S|\/:\?|\/:,@x|\/:,@@|\/::8|\/:,@!|\/:!!!|\/:xx|\/:bye|\/:wipe|\/:dig|\/:handclap|\/:&-\(|\/:B-\)|\/:<@|\/:@>|\/::-O|\/:>-\||\/:P-\(|\/::'\||\/:X-\)|\/::\*|\/:@x|\/:8\*|\/:pd|\/:<W>|\/:beer|\/:basketb|\/:oo|\/:coffee|\/:eat|\/:pig|\/:rose|\/:fade|\/:showlove|\/:heart|\/:break|\/:cake|\/:li|\/:bome|\/:kn|\/:footb|\/:ladybug|\/:shit|\/:moon|\/:sun|\/:gift|\/:hug|\/:strong|\/:weak|\/:share|\/:v|\/:@\)|\/:jj|\/:@@|\/:bad|\/:lvu|\/:no|\/:ok|\/:love|\/:<L>|\/:jump|\/:shake|\/:<O>|\/:circle|\/:kotow|\/:turn|\/:skip|\/:oY|\/:#-0|\/:hiphot|\/:kiss|\/:<&|\/:&>|\/微笑|\/撇嘴|\/色|\/发呆|\/得意|\/流泪|\/害羞|\/闭嘴|\/睡|\/大哭|\/尴尬|\/发怒|\/调皮|\/呲牙|\/惊讶|\/难过|\/酷|\/冷汗|\/衰|\/骷髅|\/敲打|\/再见|\/擦汗|\/抠鼻|\/鼓掌|\/糗大了|\/坏笑|\/左哼哼|\/右哼哼|\/哈欠|\/鄙视|\/委屈|\/快哭了|\/阴险|\/亲亲|\/吓|\/可怜|\/抓狂|\/吐|\/偷笑|\/愉快|\/白眼|\/傲慢|\/饥饿|\/困|\/惊恐|\/流汗|\/憨笑|\/悠闲|\/奋斗|\/咒骂|\/疑问|\/嘘|\/晕|\/疯了|\/篮球|\/乒乓|\/咖啡|\/饭|\/猪头|\/玫瑰|\/调谢|\/嘴唇|\/爱心|\/心碎|\/蛋糕|\/闪电|\/炸弹|\/刀|\/足球|\/瓢虫|\/便便|\/月亮|\/太阳|\/礼物|\/拥抱|\/菜刀|\/西瓜|\/啤酒|\/弱|\/握手|\/胜利|\/抱拳|\/勾引|\/拳头|\/差劲|\/爱你|\/NO|\/OK|\/爱情|\/飞吻|\/跳跳|\/强|\/发抖|\/怄火|\/转圈|\/磕头|\/回头|\/跳绳|\/投降|\/激动|\/乱舞|\/献吻|\/左太极|\/右太极|\[微笑\]|\[撇嘴\]|\[色\]|\[发呆\]|\[得意\]|\[流泪\]|\[害羞\]|\[闭嘴\]|\[睡\]|\[大哭\]|\[尴尬\]|\[发怒\]|\[调皮\]|\[呲牙\]|\[惊讶\]|\[难过\]|\[酷\]|\[冷汗\]|\[衰\]|\[骷髅\]|\[敲打\]|\[再见\]|\[擦汗\]|\[抠鼻\]|\[鼓掌\]|\[糗大了\]|\[坏笑\]|\[左哼哼\]|\[右哼哼\]|\[哈欠\]|\[鄙视\]|\[委屈\]|\[快哭了\]|\[阴险\]|\[亲亲\]|\[吓\]|\[可怜\]|\[抓狂\]|\[吐\]|\[偷笑\]|\[愉快\]|\[白眼\]|\[傲慢\]|\[饥饿\]|\[困\]|\[惊恐\]|\[流汗\]|\[憨笑\]|\[悠闲\]|\[奋斗\]|\[咒骂\]|\[疑问\]|\[嘘\]|\[晕\]|\[疯了\]|\[篮球\]|\[乒乓\]|\[咖啡\]|\[饭\]|\[猪头\]|\[玫瑰\]|\[调谢\]|\[嘴唇\]|\[爱心\]|\[心碎\]|\[蛋糕\]|\[闪电\]|\[炸弹\]|\[刀\]|\[足球\]|\[瓢虫\]|\[便便\]|\[月亮\]|\[太阳\]|\[礼物\]|\[拥抱\]|\[菜刀\]|\[西瓜\]|\[啤酒\]|\[弱\]|\[握手\]|\[胜利\]|\[抱拳\]|\[勾引\]|\[拳头\]|\[差劲\]|\[爱你\]|\[NO\]|\[OK\]|\[爱情\]|\[飞吻\]|\[跳跳\]|\[强\]|\[发抖\]|\[怄火\]|\[转圈\]|\[磕头\]|\[回头\]|\[跳绳\]|\[投降\]|\[激动\]|\[乱舞\]|\[献吻\]|\[左太极\]|\[右太极\]/g,a.qqfaceReg2=/\/::\)|\/::~|\/::B|\/::\||\/:8-\)|\/::<|\/::\$|\/::X|\/::Z|\/::'\(|\/::-\||\/::@|\/::P|\/::D|\/::O|\/::\(|\/::\+|\/:–b|\/::Q|\/::T|\/:,@P|\/:,@-D|\/::d|\/:,@o|\/::g|\/:\|-\)|\/::!|\/::L|\/::>|\/::,@|\/:,@f|\/::-S|\/:\?|\/:,@x|\/:,@@|\/::8|\/:,@!|\/:!!!|\/:xx|\/:bye|\/:wipe|\/:dig|\/:handclap|\/:&-\(|\/:B-\)|\/:<@|\/:@>|\/::-O|\/:>-\||\/:P-\(|\/::'\||\/:X-\)|\/::\*|\/:@x|\/:8\*|\/:pd|\/:<W>|\/:beer|\/:basketb|\/:oo|\/:coffee|\/:eat|\/:pig|\/:rose|\/:fade|\/:showlove|\/:heart|\/:break|\/:cake|\/:li|\/:bome|\/:kn|\/:footb|\/:ladybug|\/:shit|\/:moon|\/:sun|\/:gift|\/:hug|\/:strong|\/:weak|\/:share|\/:v|\/:@\)|\/:jj|\/:@@|\/:bad|\/:lvu|\/:no|\/:ok|\/:love|\/:<L>|\/:jump|\/:shake|\/:<O>|\/:circle|\/:kotow|\/:turn|\/:skip|\/:oY|\/:#-0|\/:hiphot|\/:kiss|\/:<&|\/:&>|\/微笑|\/撇嘴|\/色|\/发呆|\/得意|\/流泪|\/害羞|\/闭嘴|\/睡|\/大哭|\/尴尬|\/发怒|\/调皮|\/呲牙|\/惊讶|\/难过|\/酷|\/冷汗|\/衰|\/骷髅|\/敲打|\/再见|\/擦汗|\/抠鼻|\/鼓掌|\/糗大了|\/坏笑|\/左哼哼|\/右哼哼|\/哈欠|\/鄙视|\/委屈|\/快哭了|\/阴险|\/亲亲|\/吓|\/可怜|\/抓狂|\/吐|\/偷笑|\/愉快|\/白眼|\/傲慢|\/饥饿|\/困|\/惊恐|\/流汗|\/憨笑|\/悠闲|\/奋斗|\/咒骂|\/疑问|\/嘘|\/晕|\/疯了|\/篮球|\/乒乓|\/咖啡|\/饭|\/猪头|\/玫瑰|\/调谢|\/嘴唇|\/爱心|\/心碎|\/蛋糕|\/闪电|\/炸弹|\/刀|\/足球|\/瓢虫|\/便便|\/月亮|\/太阳|\/礼物|\/拥抱|\/菜刀|\/西瓜|\/啤酒|\/弱|\/握手|\/胜利|\/抱拳|\/勾引|\/拳头|\/差劲|\/爱你|\/NO|\/OK|\/爱情|\/飞吻|\/跳跳|\/强|\/发抖|\/怄火|\/转圈|\/磕头|\/回头|\/跳绳|\/投降|\/激动|\/乱舞|\/献吻|\/左太极|\/右太极|\[微笑\]|\[撇嘴\]|\[色\]|\[发呆\]|\[得意\]|\[流泪\]|\[害羞\]|\[闭嘴\]|\[睡\]|\[大哭\]|\[尴尬\]|\[发怒\]|\[调皮\]|\[呲牙\]|\[惊讶\]|\[难过\]|\[酷\]|\[冷汗\]|\[衰\]|\[骷髅\]|\[敲打\]|\[再见\]|\[擦汗\]|\[抠鼻\]|\[鼓掌\]|\[糗大了\]|\[坏笑\]|\[左哼哼\]|\[右哼哼\]|\[哈欠\]|\[鄙视\]|\[委屈\]|\[快哭了\]|\[阴险\]|\[亲亲\]|\[吓\]|\[可怜\]|\[抓狂\]|\[吐\]|\[偷笑\]|\[愉快\]|\[白眼\]|\[傲慢\]|\[饥饿\]|\[困\]|\[惊恐\]|\[流汗\]|\[憨笑\]|\[悠闲\]|\[奋斗\]|\[咒骂\]|\[疑问\]|\[嘘\]|\[晕\]|\[疯了\]|\[篮球\]|\[乒乓\]|\[咖啡\]|\[饭\]|\[猪头\]|\[玫瑰\]|\[调谢\]|\[嘴唇\]|\[爱心\]|\[心碎\]|\[蛋糕\]|\[闪电\]|\[炸弹\]|\[刀\]|\[足球\]|\[瓢虫\]|\[便便\]|\[月亮\]|\[太阳\]|\[礼物\]|\[拥抱\]|\[菜刀\]|\[西瓜\]|\[啤酒\]|\[弱\]|\[握手\]|\[胜利\]|\[抱拳\]|\[勾引\]|\[拳头\]|\[差劲\]|\[爱你\]|\[NO\]|\[OK\]|\[爱情\]|\[飞吻\]|\[跳跳\]|\[强\]|\[发抖\]|\[怄火\]|\[转圈\]|\[磕头\]|\[回头\]|\[跳绳\]|\[投降\]|\[激动\]|\[乱舞\]|\[献吻\]|\[左太极\]|\[右太极\]/,i.exports=a},{}],61:[function(e,i,t){i.exports={"😃":"u1F603.png","😄":"u1F604.png","😁":"u1F601.png","😆":"u1F606.png","😅":"u1F605.png","🤣":"u1F923.png","😂":"u1F602.png","🙂":"u1F642.png","😉":"u1F609.png","😊":"u1F60A.png","😇":"u1F607.png","😍":"u1F60D.png","🤩":"u1F929.png","😘":"u1F618.png","😚":"u1F61A.png","😙":"u1F619.png","😋":"u1F60B.png","😜":"u1F61C.png","😝":"u1F61D.png","🤗":"u1F917.png","🤭":"u1F92D.png","🤔":"u1F914.png","🤐":"u1F910.png","😑":"u1F611.png","😏":"u1F60F.png","😒":"u1F612.png","😌":"u1F60C.png","😔":"u1F614.png","😷":"u1F637.png","🤒":"u1F912.png","😵":"u1F635.png","🤠":"u1F920.png","😎":"u1F60E.png","🤓":"u1F913.png","😳":"u1F633.png","😨":"u1F628.png","😰":"u1F630.png","😥":"u1F625.png","😢":"u1F622.png","😭":"u1F62D.png","😱":"u1F631.png","😖":"u1F616.png","😣":"u1F623.png","😓":"u1F613.png","😠":"u1F620.png","👋":"u1F44B.png","👌":"u1F44C.png","✌":"u270C.png","🤟":"u1F91F.png","👍":"u1F44D.png","👏":"u1F44F.png","🤝":"u1F91D.png","🙏":"u1F64F.png","💪":"u1F4AA.png","🙇":"u1F647.png","🐮":"u1F42E.png","🌹":"u1F339.png","🥀":"u1F940.png","💋":"u1F48B.png","❤":"u2764.png","💔":"u1F494.png","⭐":"u2B50.png","🎉":"u1F389.png","🍺":"u1F37A.png","🎁":"u1F381.png"}},{}],62:[function(e,i,t){i.exports={"[微笑]":"weixiao","[撇嘴]":"piezui","[色]":"se","[发呆]":"fadai","[得意]":"deyi","[流泪]":"liulei","[害羞]":"haixiu","[闭嘴]":"bizui","[睡]":"shui","[大哭]":"daku","[尴尬]":"ganga","[发怒]":"fanu","[调皮]":"tiaopi","[呲牙]":"ciya","[惊讶]":"jingya","[难过]":"nanguo","[酷]":"ku","[冷汗]":"lenghan","[抓狂]":"zhuakuang","[吐]":"tu","[偷笑]":"touxiao","[愉快]":"yukuai","[白眼]":"baiyan","[傲慢]":"aoman","[饥饿]":"jie","[困]":"kun","[惊恐]":"jingkong"}},{}],63:[function(e,i,t){i.exports={"/::)":"weixiao","/::~":"piezui","/::B":"se","/::|":"fadai","/:8-)":"deyi","/::<":"liulei","/::$":"haixiu","/::X":"bizui","/::Z":"shui","/::'(":"daku","/::-|":"ganga","/::@":"fanu","/::P":"tiaopi","/::D":"ciya","/::O":"jingya","/::(":"nanguo","/::+":"ku","/:–b":"lenghan","/:,@!":"shuai","/:!!!":"kulou","/::Q":"zhuakuang","/::T":"tu","/:,@P":"touxiao","/:,@-D":"yukuai","/::d":"baiyan","/:,@o":"aoman","/::g":"jie","/:|-)":"kun","/::!":"jingkong","/::L":"liuhan","/::>":"hanxiao","/::,@":"youxian","/:,@f":"fendou","/::-S":"zhouma","/:?":"yiwen","/:,@x":"xu","/:,@@":"yun","/::8":"fengl","/:xx":"qiaoda","/:bye":"zaijian","/:wipe":"cahan","/:dig":"koubi","/:handclap":"guzhang","/:&-(":"qiudal","/:B-)":"huaixiao","/:<@":"zuohengheng","/:@>":"youhengheng","/::-O":"haqian","/:>-|":"bishi","/:P-(":"weiqu","/:X-)":"yinxian","/::'|":"kuaikul","/::*":"qinqin","/:@x":"xia","/:8*":"kelian","/:pd":"caidao","/:<W>":"xigua","/:beer":"pijiu","/:basketb":"lanqiu","/:oo":"pingpang","/:coffee":"kafei","/:eat":"fan","/:pig":"zhutou","/:rose":"meigui","/:fade":"diaoxie","/:showlove":"zuichun","/:heart":"aixin","/:break":"xinsui","/:cake":"dangao","/:li":"shandian","/:bome":"zhadan","/:kn":"dao","/:footb":"zuqiu","/:ladybug":"piaochong","/:shit":"bianbian","/:moon":"yueliang","/:sun":"taiyang","/:gift":"liwu","/:hug":"yongbao","/:strong":"qiang","/:weak":"ruo","/:share":"woshou","/:v":"shengli","/:@)":"baoquan","/:jj":"gouyin","/:@@":"quantou","/:bad":"chajin","/:lvu":"aini","/:no":"no_1","/:ok":"ok_1","/:love":"aiqing","/:<L>":"feiwen","/:jump":"tiaotiao","/:shake":"fadou","/:<O>":"ouhuo","/:circle":"zhuanquan","/:kotow":"ketou","/:turn":"huitou","/:skip":"tiaosheng","/:oY":"touxiang","/:#-0":"jidong","/:hiphot":"luanwu","/:kiss":"xianwen","/:<&":"zuotaiji","/:&>":"youtaiji","/微笑":"weixiao","/撇嘴":"piezui","/色":"se","/发呆":"fadai","/得意":"deyi","/流泪":"liulei","/害羞":"haixiu","/闭嘴":"bizui","/睡":"shui","/大哭":"daku","/尴尬":"ganga","/发怒":"fanu","/调皮":"tiaopi","/呲牙":"ciya","/惊讶":"jingya","/难过":"nanguo","/酷":"ku","/冷汗":"lenghan","/衰":"shuai","/骷髅":"kulou","/敲打":"qiaoda","/再见":"zaijian","/擦汗":"cahan","/抠鼻":"koubi","/鼓掌":"guzhang","/糗大了":"qiudal","/坏笑":"huaixiao","/左哼哼":"zuohengheng","/右哼哼":"youhengheng","/哈欠":"haqian","/鄙视":"bishi","/委屈":"weiqu","/快哭了":"kuaikul","/阴险":"yinxian","/亲亲":"qinqin","/吓":"xia","/可怜":"kelian","/抓狂":"zhuakuang","/吐":"tu","/偷笑":"touxiao","/愉快":"yukuai","/白眼":"baiyan","/傲慢":"aoman","/饥饿":"jie","/困":"kun","/惊恐":"jingkong","/流汗":"liuhan","/憨笑":"hanxiao","/悠闲":"youxian","/奋斗":"fendou","/咒骂":"zhouma","/疑问":"yiwen","/嘘":"xu","/晕":"yun","/疯了":"fengl","/篮球":"lanqiu","/乒乓":"pingpang","/咖啡":"kafei","/饭":"fan","/猪头":"zhutou","/玫瑰":"meigui","/调谢":"diaoxie","/嘴唇":"zuichun","/爱心":"aixin","/心碎":"xinsui","/蛋糕":"dangao","/闪电":"shandian","/炸弹":"zhadan","/刀":"dao","/足球":"zuqiu","/瓢虫":"piaochong","/便便":"bianbian","/月亮":"yueliang","/太阳":"taiyang","/礼物":"liwu","/拥抱":"yongbao","/菜刀":"caidao","/西瓜":"xigua","/啤酒":"pijiu","/弱":"ruo","/握手":"woshou","/胜利":"shengli","/抱拳":"baoquan","/勾引":"gouyin","/拳头":"quantou","/差劲":"chajin","/爱你":"aini","/NO":"no_1","/OK":"ok_1","/爱情":"aiqing","/飞吻":"feiwen","/跳跳":"tiaotiao","/强":"qiang","/发抖":"fadou","/怄火":"ouhuo","/转圈":"zhuanquan","/磕头":"ketou","/回头":"huitou","/跳绳":"tiaosheng","/投降":"touxiang","/激动":"jidong","/乱舞":"luanwu","/献吻":"xianwen","/左太极":"zuotaiji","/右太极":"youtaiji","[微笑]":"weixiao","[撇嘴]":"piezui","[色]":"se","[发呆]":"fadai","[得意]":"deyi","[流泪]":"liulei","[害羞]":"haixiu","[闭嘴]":"bizui","[睡]":"shui","[大哭]":"daku","[尴尬]":"ganga","[发怒]":"fanu","[调皮]":"tiaopi","[呲牙]":"ciya","[惊讶]":"jingya","[难过]":"nanguo","[酷]":"ku","[冷汗]":"lenghan","[衰]":"shuai","[骷髅]":"kulou","[敲打]":"qiaoda","[再见]":"zaijian","[擦汗]":"cahan","[抠鼻]":"koubi","[鼓掌]":"guzhang","[糗大了]":"qiudal","[坏笑]":"huaixiao","[左哼哼]":"zuohengheng","[右哼哼]":"youhengheng","[哈欠]":"haqian","[鄙视]":"bishi","[委屈]":"weiqu","[快哭了]":"kuaikul","[阴险]":"yinxian","[亲亲]":"qinqin","[吓]":"xia","[可怜]":"kelian","[抓狂]":"zhuakuang","[吐]":"tu","[偷笑]":"touxiao","[愉快]":"yukuai","[白眼]":"baiyan","[傲慢]":"aoman","[饥饿]":"jie","[困]":"kun","[惊恐]":"jingkong","[流汗]":"liuhan","[憨笑]":"hanxiao","[悠闲]":"youxian","[奋斗]":"fendou","[咒骂]":"zhouma","[疑问]":"yiwen","[嘘]":"xu","[晕]":"yun","[疯了]":"fengl","[篮球]":"lanqiu","[乒乓]":"pingpang","[咖啡]":"kafei","[饭]":"fan","[猪头]":"zhutou","[玫瑰]":"meigui","[调谢]":"diaoxie","[嘴唇]":"zuichun","[爱心]":"aixin","[心碎]":"xinsui","[蛋糕]":"dangao","[闪电]":"shandian","[炸弹]":"zhadan","[刀]":"dao","[足球]":"zuqiu","[瓢虫]":"piaochong","[便便]":"bianbian","[月亮]":"yueliang","[太阳]":"taiyang","[礼物]":"liwu","[拥抱]":"yongbao","[菜刀]":"caidao","[西瓜]":"xigua","[啤酒]":"pijiu","[弱]":"ruo","[握手]":"woshou","[胜利]":"shengli","[抱拳]":"baoquan","[勾引]":"gouyin","[拳头]":"quantou","[差劲]":"chajin","[爱你]":"aini","[NO]":"no_1","[OK]":"ok_1","[爱情]":"aiqing","[飞吻]":"feiwen","[跳跳]":"tiaotiao","[强]":"qiang","[发抖]":"fadou","[怄火]":"ouhuo","[转圈]":"zhuanquan","[磕头]":"ketou","[回头]":"huitou","[跳绳]":"tiaosheng","[投降]":"touxiang","[激动]":"jidong","[乱舞]":"luanwu","[献吻]":"xianwen","[左太极]":"zuotaiji","[右太极]":"youtaiji"}},{}],64:[function(require,module,exports){!function(){var that={},parse=function(str){var obj;try{obj=eval("("+str+")")}catch(e){}return obj};that.parse=parse,window.JSON||(window.JSON=that)}()},{}],65:[function(e,i,t){var a=e("./promise.js"),s={},n={},o=function(e,i){var i=i||new a;return setTimeout(function(){return n[e]?a.when(function(){var t=n[e];setTimeout(function(){i.resolve(t)},0)}):void $.ajax({url:e,async:!0,dataType:"text",type:"get"}).success(function(t){i.resolve(t),n[e]=t}).fail(function(e){i.reject(e)})},0),i};s.load=o;var r=function(){return s};i.exports=r},{"./promise.js":69}],66:[function(e,i,t){function a(i){var t=e("./dialog"),a=this,s=$.extend({text:"TEXT",info:"",OK:function(e){}},i);t.call(this,s);var n=function(){var i=e("./template.js"),t=doT.template(i.zcAlertTemplate)(s);a.setInner(t)};n()}i.exports=a},{"./dialog":67,"./template.js":68}],67:[function(e,i,t){function a(i){var t,a,s=e("./template.js"),n=this,o=$.extend({okText:"确定",title:"提示",inner:!1,footer:!0,OK:function(){}},i),r=!0,l=function(){t=$(s.zcShadowLayer);var e=doT.template(s.zcModalOuter)(o);a=$(e),setTimeout(function(){a.find("input").focus()},1)},c=function(e){a.find(".modal-body").append($(e))},d=function(){t.find(".fade.in").animate({opacity:0},300,function(){setTimeout(function(){t.remove()},100)})},u=function(){t.on("click",d),a.on("click",function(e){e.stopPropagation()}),a.delegate(".bootbox-close-button","click",d),a.delegate(".js-cancel-btn","click",function(e){o.cancel&&o.cancel(n),d()}),a.delegate(".js-ok-btn","click",function(e){d(),o.OK&&o.OK(n)}),a.on("keydown",function(e){r&&(r=!1,13==e.keyCode&&(d(),o.OK&&o.OK(n)),setTimeout(function(){r=!0},3e3))}),$(window).resize(function(){m()})},p=function(){return a[0]},f=function(){u(),t.append(a),$(".js-mainBox").append(t),m(),t.find(".fade.in").animate({opacity:1},300)},m=function(){var e=($(".js-mainBox").width()-360)/2,i=($(".js-mainBox").height()-416)/2;$(".modal-dialog").css({"margin-left":e,"margin-top":i})},g=function(){l()};g(),this.getOuter=p,this.setInner=c,this.show=f,this.hide=d}i.exports=a},{"./template.js":68}],68:[function(e,i,t){var a={},s='<div class="zc-shadow-layer"></div>',n='<div class="bootbox  fade in" tabindex="-1" role="dialog" aria-hidden="false" style="display: block;outline:none;">{{if(it.source=="capture"){}}<div class="modal-dialog capture-dialog" style="width:{{=it.width}}px;">{{}else{}}<div class="modal-dialog" style="width:{{=it.width}}px; height:{{=it.height}}px;">{{}}}<div class="modal-content"><div class="modal-header"><span type="button" class="bootbox-close-button close" data-dismiss="modal" aria-hidden="true"></span><h4 class="modal-title">{{=it.title || "提示"}}</h4></div><input style="position:absolute;left:0;top:0;z-index:-1;outline:none"/><div class="modal-body"></div>{{ if((it.footer !== false) ) { }}<div class="modal-footer"><button class="btn btn-success js-ok-btn">{{=it.okText || "确定"}}</button><button class="btn btn-danger js-cancel-btn">{{=it.cancelText || "取消"}}</button></div>{{ } }}</div></div></div>',o='<div class="modal-alert-content"><p class="large">{{=it.text}}</p><p>{{=it.info}}</p></div>';a.zcAlertTemplate=o,a.zcModalOuter=n,a.zcShadowLayer=s,i.exports=a},{}],69:[function(e,i,t){function a(){var e=[];this.resolve=function(i){var t=e.shift();t&&t.success&&"function"==typeof t.success&&t.success(i,this)},this.reject=function(i){var t=e.shift();t&&t.fail&&"function"==typeof t.fail&&t.fail(i,this)},this.then=function(i,t){return e.push({success:i,fail:t}),this}}a.when=function(e){return e()},i.exports=a},{}],70:[function(e,i,t){function a(i,t){var a,s,n,o,r,l,c,d,u,p=e("../../../common/util/listener.js"),f=e("./load.js")(),m=e("./face/weixin.json"),g=e("./face/weixinsymbol.json"),v=(e("./unicode.js"),e("./face/Reg.js")),h=e("./face/emojiImagePath.json"),y=e("../config/config.json"),T={},j="",I="",b="",w="",x="",k="",F="",C="",S="img/qqarclist/",L=y.imgPath+"/emoji/",M=function(){"block"===a.css("display")?P():($("#emojiBox").length<=0&&f.load(y.basePath+"/views/sendArea/emoji.html").then(function(e){var i=doT.template(e)({emojiTip:b,emojiSymbolTip:w,emojiPath:L});n.append(i)}),A())},A=function(){a.css("display","block"),o.css("background-position","-46px 0px")},P=function(){a.css("display","none"),o.css("background-position","")},D=function(){var e=$(this).find(".js-faceIco").attr("data-src");p.trigger("sendArea.gotoxy",e)},_=function(e){var i="";if(""!==e&&!e)return null;if(i=e.match(x))for(var t=0;t<i.length;t++){var a=k.exec(e),s=I[a[0]];e=e.replace(k,'<img class="zc-face js-zcFace" src="'+S+s+'.png" />')}var n=e.match(F);if(n)for(var t=0,o=n.length;t<o;t++){var a=C.exec(e),s=h[a[0]];e=e.replace(a[0],'<img class="zc-face zc-emoji" src="'+L+s+'" />')}return e},N=function(){var e=$(this).attr("data-tab");d.hide(),$(e).show(),$(this).addClass("active").siblings().removeClass("active")},R=function(){j=m,I=g,b=v.emojiTip,w=v.emojiSymbolTip,x=v.qqfaceReg,k=v.qqfaceReg2,F=v.emojiReg,C=v.emojiReg2;for(var e in j){var i=new Image;i.src=S+j[e]+".png"}},O=function(){a=$(".js-group"),s=$(".js-faceGroup"),n=$(".js-emojiGroup"),o=$(".js-emotion"),r=$(".js-inputMsg"),l=$(".js-faceIco"),c=$(".js-icoLi"),d=$(".js-groupChildren"),u=$(".js-faceIcoLi")},B=function(){o.on("click",M),c.on("click",N),$(document.body).delegate(".js-faceIcoLi","click",D),$(document.body).on("click",function(e){var i=!1,t=0;e.target.classList?t=e.target.classList.length:i=!0;for(var a=0;a<t;a++)"js-emotion"===e.target.classList[a]&&(i=!0);i||P()})},z=function(){O(),R(),B()};return z(),T.show=A,T.hide=P,T.analysis=_,T}var s,n=function(e,i){return s||(s=a(e,i)),s};i.exports=n},{"../../../common/util/listener.js":33,"../config/config.json":38,"./face/Reg.js":60,"./face/emojiImagePath.json":61,"./face/weixin.json":62,"./face/weixinsymbol.json":63,"./load.js":65,"./unicode.js":73}],71:[function(e,i,t){function a(i){var t=e("./template.js"),a={},s=function(e){var i={};i={text:e};var a=doT.template(t.showTip)(i);$(".js-mainBox").append(a),r(),o(),n()},n=function(){setTimeout(function(){$showTip.remove()},3e3)},o=function(){var e=($(".js-mainBox").height()-$(".js-showTip").height())/2,i=($(".js-mainBox").width()-$(".js-showTip").width())/2;$showTip.css({top:e,left:i-10})},r=function(){$showTip=$(".js-showTip")},l=function(){},c=function(){l()};return c(),a.show=s,a}i.exports=a},{"./template.js":72}],72:[function(e,i,t){var a={},s='<span unselectable="on" class="faceIco js-faceIco faceIco{{=it.flag}}" data-src="{{=it.a}}" /></span><span class="backDelete"></span>',n='<span unselectable="on" class="faceIco js-faceIco faceIco{{=it.flag}}" data-src="{{=it.a}}" /></span>',o='<div class="js-showTip showTip"><p class="showTipText">{{=it.text}}</p></div>';a.faceIcoStr=s,a.faceIcoStr2=n,a.showTip=o,i.exports=a},{}],73:[function(e,i,t){var a={};a.parse=function(e){return e=e.replace(/\\/g,"%"),unescape(e)},a.stringify=function(e){for(var i=[],t=e.length,a=0;a<t;++a)i[a]=("00"+e.charCodeAt(a).toString(16)).slice(-4);return e?"\\u"+i.join("\\u"):""},i.exports=a},{}]},{},[40]);